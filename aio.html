<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to R: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><abbr class="icon" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="text-decoration: unset">
           
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #383838">Pre-Alpha
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="color: #FF4955; border-radius: 5px"></i>
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container ">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introduction to R and Rstudio</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="reading-in-data-readr-and-readxl.html">2. Reading in data: readr and readxl</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="tidying-data.html">3. Tidy data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="manipulating-data.html">4. Data wrangling</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="visualizing-data.html">5. Data visualization</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="intro-bioconductor.html">6. <code>Bioconductor</code> and other bioinformatics packages</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="intro-rmarkdown.html">7. Using <code>R markdown</code> for notebooks and documents</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="git.html">8. Version control with <code>git</code></a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-introduction"><p>Content from <a href="introduction.html">Introduction to R and Rstudio</a></p>
<hr>
<p> Last updated on 2022-11-26 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/introduction.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I use the RStudio IDE?</li>
<li>What are the basics of R?</li>
<li>What are the best practices for writing R code?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to interact with the RStudio IDE</li>
<li>Demonstrate some R basics: operators, comments, functions, assignment, vectors and types</li>
<li>Be aware of some good habits for writing R code</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="why-r"><h2 class="section-heading">Why R?<a class="anchor" aria-label="anchor" href="#why-r"></a>
</h2>
<hr class="half-width">
<p>The <code>R</code> language is one of the most commonly used languages in bioinformatics, and data science more generally. It’s a great choice for you because:</p>
<ul>
<li>Reproducibility: Scripting your analysis makes it easier for someone else to repeat and for you to re-use and extend</li>
<li>Power: <code>R</code> can be used to work with datasets larger than you can in Prism or Excel</li>
<li>
<a href="https://en.wikipedia.org/wiki/Open_source" class="external-link">Open source</a>: So it’s free!</li>
<li>Community: <code>R</code> is a popular choice for data science, so there are many resources available for <a href="https://swcarpentry.github.io/r-novice-gapminder/" class="external-link">learning</a> and <a href="https://stackoverflow.com/questions/tagged/r" class="external-link">debugging</a>
</li>
<li>Packages: Since the community is large, many people have written helpful packages that can help you do tasks more easily than if you’d had to start from scratch</li>
</ul>
<p>The other language most commonly used for data science is <code>python</code>. Some people might even consider it a better choice than <code>R</code>, because it doesn’t have some of the strange quirks that <code>R</code> does, and also has a large community of users (and all of the benefits that come with it).</p>
<p>I use both <code>R</code> and <code>python</code>, and most (but not all) people who do a lot of data science know how to use both. But today we’re learning <code>R</code> because I think it usually what I turn to when someone in the lab asks me for help analysing their data, and I think everyone can learn to use it for those same tasks too.</p>
<p>I made all of the material for this course (including the website and slides) in <code>Rstudio</code> using <code>R</code>. A little bit can take you a long way!</p>
<div class="section level3">
<h3 id="theres-more-than-one-way-to-skin-a-cat">There’s more than one way to skin a cat<a class="anchor" aria-label="anchor" href="#theres-more-than-one-way-to-skin-a-cat"></a>
</h3>
<p>This course will teach a particular ‘dialect’ of <code>R</code> called the tidyverse. This is a collection of packages mostly written by Hadley Wickham, that focus on the concept of ‘tidy’ data.</p>
<p>You’ll soon discover that when coding, there are many ways of getting to the same output. Some of them are more efficient than others, and some of them are just easier to code than others. The tidyverse packages are hugely popular in the R community, and when I started I found them easy to work with.</p>
<p>However, if you stick with <code>R</code> long enough, you’ll probably end up needing to learn some additional base R (particularly if you use packages from outside the tidyverse). If you want to get a head start, I’ll include some links to resources at the end of this lesson.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-i-need-to-do-this-lesson" class="callout-inner">
<h3 class="callout-title">Do I need to do this lesson?<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>This lesson teaches the very basics. If you can predict what will happen after every section of the following script (and you known what a comment is), you can skip this lesson.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 1</span></span>
<span><span class="fl">100</span> <span class="op">**</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># section 2</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span></span>
<span></span>
<span><span class="co"># section 3</span></span>
<span><span class="fu">round</span><span class="op">(</span><span class="fl">3.1415</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># section 4</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># section 5</span></span>
<span><span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_length</span><span class="op">(</span><span class="st">"what is the output?"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># section 6</span></span>
<span><span class="fu">as.integer</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1.96</span>,<span class="fl">2.09</span>,<span class="fl">3.12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># section 7</span></span>
<span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 1</span></span>
<span><span class="fl">100</span> <span class="op">**</span> <span class="fl">1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 100</code></pre>
</div>
<p>100 to the power of 1 is 100</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 2</span></span>
<span></span>
<span><span class="co"># assign the value 4 to variable a</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="co"># assign the value 3 to variable b</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="co"># add the values of a and b</span></span>
<span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7</code></pre>
</div>
<p>4 + 3 is 7</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 3</span></span>
<span><span class="fu">round</span><span class="op">(</span><span class="va">pi</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>Using the <code>round()</code> function to round <span class="math inline">\(\pi\)</span> to two decimal places gives the result 3.14</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 4</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span></code></pre>
</div>
<p>No output, just loading the <code>stats</code> library.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 5</span></span>
<span><span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_length</span><span class="op">(</span><span class="st">"what is the output?"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 19</code></pre>
</div>
<p>You might need the help function for this one - there are 19 characters in the string.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 6</span></span>
<span><span class="fu">as.integer</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1.96</span>,<span class="fl">2.09</span>,<span class="fl">3.12</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3</code></pre>
</div>
<p>Coercing a vector of type double to integers truncates numbers to give integers.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 7</span></span>
<span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA NA NA</code></pre>
</div>
<p>This one is tricky! Trying to coerce a string that isn’t only digits just results in NA values.</p>
</div>
</div>
</div>
</div>
</div>
</section><section id="introduction-to-rstudio"><h2 class="section-heading">Introduction to RStudio<a class="anchor" aria-label="anchor" href="#introduction-to-rstudio"></a>
</h2>
<hr class="half-width">
<p><code>RStudio</code> is an <a href="https://en.wikipedia.org/wiki/Integrated_development_environment" class="external-link">integrated development environment</a> that makes it much easier to work with the <code>R</code> language. It’s free, cross-platform and provides many benefits such as project management and version control integration.</p>
<p>When you open it, you’ll see something like this:</p>
<figure><img src="fig/rstudio1.png" alt="Four panes of RStudio, showing the editor, console, environment and plots panel" class="figure mx-auto d-block"></figure><p>The four main panes are:</p>
<ul>
<li>Top left: editor. For editing scripts and other source code</li>
<li>Bottom left: console. For running code</li>
<li>Top right: environment. Information about objects you create will appear here</li>
<li>Bottom right: plots (among other things). Some output (like plots) from the console appears here. Also helpful for browsing files and getting help</li>
</ul>
<div class="section level3">
<h3 id="using-the-editor">Using the editor<a class="anchor" aria-label="anchor" href="#using-the-editor"></a>
</h3>
<p>Use the editor to write scripts and <code>Rmarkdown</code> documents. Although you can also type commands directly into the console, keeping your commands together in a script helps organise your analysis.</p>
<p>The editor also helps you identify issues with your code by placing a cross where it doesn’t understand something.</p>
<figure><img src="fig/rstudio2.png" alt="A cross in the margins where a line of code is syntatically incorrect" class="figure mx-auto d-block"></figure><p>Hover over the cross to get more information</p>
<figure><img src="fig/rstudio3.png" alt='Mousing over the cross reveals the message "expected , after expression" and "unmatched opening bracket (' class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="using-the-console">Using the console<a class="anchor" aria-label="anchor" href="#using-the-console"></a>
</h3>
<p>The console is where you can type in <code>R</code> commands and see their output. You can type R commands directly in here, or press <kbd>Ctrl</kbd>/<kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> to ‘send’ them from the editor to the console.</p>
<div class="section level4">
<h4 id="as-a-calculator">As a calculator<a class="anchor" aria-label="anchor" href="#as-a-calculator"></a>
</h4>
<p>The most basic way we can use R is as a calculator:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<p>If you type an incomplete command, you’ll see a <code>+</code>:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>+</code></pre>
</div>
<p>Finish typing the command to get back to the prompt (<code>&gt;</code>).</p>
<p>The order of operations is as you would expect:</p>
<ul>
<li>Parentheses <code>(</code>, <code>)</code>
</li>
<li>Exponents <code>^</code> or <code>**</code>
</li>
<li>Multiply <code>*</code>
</li>
<li>Divide <code>/</code>
</li>
<li>Add <code>+</code>
</li>
<li>Subtract <code>-</code>
</li>
</ul>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-operators" class="callout-inner">
<h3 class="callout-title">Challenge 1: Operators<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>How would you use R to compute <span class="math inline">\(\frac{9}{3 + 6}\)</span>?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span> <span class="op">/</span> <span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">6</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.3333333</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="writing-r-code"><h2 class="section-heading">Writing R code<a class="anchor" aria-label="anchor" href="#writing-r-code"></a>
</h2>
<hr class="half-width">
<p>Next, we’ll look at some of the building blocks of <code>R</code> code. You can use these to write scripts, or type them directly into the console.</p>
<p>When performing data analysis, it’s best to record the steps you took by writing a script, which can be re-run if you need to reproduce or update your work.</p>
<div class="section level3">
<h3 id="comments">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h3>
<p>The first building block is actually lines that are ignored by <code>R</code>: comments. Anything that comes after a <code>#</code> character won’t be executed. Use this to annotate your code.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this is a comment</span></span>
<span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="co"># this is also a comment</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the line below won't be executed</span></span>
<span><span class="co"># 1 + 1</span></span></code></pre>
</div>
<p>Comments is very important!!! A key part of reproducibility is knowing what code does. Make it easier for others and your future self by adding lots of comments to your code.</p>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="debugging-by-comment" class="callout-inner">
<h3 class="callout-title">Debugging by comment<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>You can also use comments when testing and debugging your code, by preventing <code>R</code> from running particular lines of your script. RStudio provides a shortcut for commenting/uncommenting lines: <kbd>Ctrl</kbd>/<kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>c</kbd>.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h3>
<p>If you want <code>R</code> to remember something, you can assign it to a variable:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_var</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">+</span><span class="fl">1</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">my_var</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<div id="callout2" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="hello-operator" class="callout-inner">
<h3 class="callout-title">Hello, operator?<a class="anchor" aria-label="anchor" href="#callout2"></a>
</h3>
<div class="callout-content">
<p>There are actually two assignment operators in <code>R</code>: <code>&lt;-</code> and <code>=</code>. They differ a little in their behaviour (you don’t need to know all of the details of how they differ); in general you should use <code>&lt;-</code> for assignment.</p>
</div>
</div>
</div>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-assignment" class="callout-inner">
<h3 class="callout-title">Challenge 2: Assignment<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>What would be the output of the following code? Try to think about what the answer would be without using <code>R</code>.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">b</span><span class="op">)</span> <span class="op">/</span> <span class="va">b</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">b</span><span class="op">)</span> <span class="op">/</span> <span class="va">b</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h3>
<p>A function is just something that takes zero or more inputs, does something with it, and gives you back zero or more outputs.</p>
<figure><img src="fig/functions.png" alt="A function takes as input (x,y), does some stuff, and outputs z" style="width:50.0%" class="figure mx-auto d-block"><figcaption>A black box function</figcaption></figure><p><code>R</code> comes with many useful functions that you can use in your code. A function is always called with parentheses <code>()</code>.</p>
<p>For example, the <code>getwd()</code> function takes no inputs, and returns the current working directory.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a function that takes no inputs</span></span>
<span><span class="fu">getwd</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Base <code>R</code> also has many mathematical and statistical functions:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># natural logarithm</span></span>
<span><span class="fu">log</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># rounding</span></span>
<span><span class="fu">round</span><span class="op">(</span><span class="fl">0.555555</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.556</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># statistical analysis</span></span>
<span><span class="fu">t.test</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.5</span>, <span class="fl">8</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1001</span>, <span class="fl">3000</span>, <span class="fl">5000</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Welch Two Sample t-test

data:  c(1, 2.5, 8, 1) and c(1000, 1001, 3000, 5000)
t = -2.6085, df = 3, p-value = 0.07979
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -5543.6641   549.4141
sample estimates:
mean of x mean of y 
    3.125  2500.250 </code></pre>
</div>
<p>You don’t need to memorize all these functions: Google is your friend.</p>
<p>RStudio can also help you with function usage. If you know what the name of a function is but can’t remember how to use it, you can type <code>?</code> before the function name in the console to get help on that function.</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">sin</span></span></code></pre>
</div>
<p>If you don’t know what the name of a function is, you can type <code>??</code> before a key word to search the documentation for that key word.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="op">?</span><span class="va">trig</span></span></code></pre>
</div>
<div id="callout3" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="named-arguments" class="callout-inner">
<h3 class="callout-title">Named arguments<a class="anchor" aria-label="anchor" href="#callout3"></a>
</h3>
<div class="callout-content">
<p>Function arguments can be named <em>implicitly</em> or <em>explicitly</em>. When calling a function, explicitly named arguments are matched first, then any other arguments are matched in order.</p>
<p>For example, the documentation for the <code>round</code> function gives its signature: <code>round(x, digits = 0)</code>.</p>
<p>The following function calls are all equivalent:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">round</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">round</span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">round</span><span class="op">(</span>digits<span class="op">=</span><span class="fl">3</span>, x<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p>However, the last is not best practice: reversing the order of the arguments will likely be confusing for someone else reading your code.</p>
<p>In general, try to match the documentation when you call a function.</p>
<p>Which of the calls above matches the documentation for <code>round()</code>?</p>

</div>
</div>
</div>
<p>You can also write your own functions:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># function to add two numbers</span></span>
<span><span class="va">my_add</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num1</span>, <span class="va">num2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">num1</span> <span class="op">+</span> <span class="va">num2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_add</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-functions" class="callout-inner">
<h3 class="callout-title">Challenge 3: Functions<a class="anchor" aria-label="anchor" href="#challenge4"></a>
</h3>
<div class="callout-content">
<p>Use the R console to get help on the <code>rnorm()</code> function</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">rnorm</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-functions" class="callout-inner">
<h3 class="callout-title">Challenge 3: Functions<em> (continued)</em><a class="anchor" aria-label="anchor" href="#challenge5"></a>
</h3>
<div class="callout-content">
<p>Use the <code>rnorm</code> function to generate 5 numbers from a normal distribution with a mean of 1 and a standard deviation of 2.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">5</span>, mean<span class="op">=</span><span class="fl">1</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  2.142826 -0.558392 -3.736824  1.582071  1.981797</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="using-libraries">Using libraries<a class="anchor" aria-label="anchor" href="#using-libraries"></a>
</h3>
<p>One of the great things about <code>R</code> is that a lot of other people use it, so often somebody has worked out an efficient way of doing things that you can use. This way, you don’t have to build your code from the ground up; instead you can use functions that other people have written.</p>
<p>When you use other peoples’ functions, they will be packaged in to <em>libraries</em> (also called <em>packages</em>) that you can import. In order to use library, it first must be installed. R provides the function <code>install.packages()</code> which you can use to install libraries from <code>CRAN</code> (an online repository of libraries).</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"library_name"</span><span class="op">)</span></span></code></pre>
</div>
<p>Note the use of quotation marks around the library name - this tells <code>R</code> that this is a string, rather than a variable (more on strings in the next section).</p>
<div id="challenge6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4-installing-a-library" class="callout-inner">
<h3 class="callout-title">Challenge 4: Installing a library<a class="anchor" aria-label="anchor" href="#challenge6"></a>
</h3>
<div class="callout-content">
<p>What code would you use to install the <code>tidyverse</code> library? Try it out!</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="callout4" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="package-ception" class="callout-inner">
<h3 class="callout-title">Package-ception<a class="anchor" aria-label="anchor" href="#callout4"></a>
</h3>
<div class="callout-content">
<p>Most of the packages that you’ll use will come from <code>CRAN</code>, but you might come across other sources of packages that are also useful. These are usually installed by packages that you can get from <code>CRAN</code>.</p>
<p>For example, the <a href="https://www.bioconductor.org/" class="external-link"><code>Bioconductor</code></a> suite consists of packages that are useful for bioinformatics. To install any <code>Bioconductor</code> libraries, you’ll first need to install the <code>BiocManager</code> package from <code>CRAN</code>, and then use functions from this library to install <code>Bioconductor</code> packages.</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install BiocManager package</span></span>
<span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the install function from BiocManager to install the GenomicFeatures and karyoploteR libraries</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"GenomicFeatures"</span>, <span class="st">"karyoploteR"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Another place you might install packages from is <a href="https://github.com/" class="external-link"><code>github</code></a>. Many developers host their code for their package on <code>github</code>, and then release it to <code>CRAN</code> when they think it’s ready.</p>
<p>If you want to use the development version of a package (for example if you want to use a feature that hasn’t been released yet), you can get it directly from <code>github</code> using the <code>devtools</code> package. Be careful when you do this - you’ll get all the shiny newest features, but you might also run into new bugs that haven’t been fixed yet!</p>
<p>For example, if you want to install the <a href="https://github.com/tidyverse/readr" class="external-link">development version of <code>readr</code> from <code>github</code></a>:</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install the devtools package</span></span>
<span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the install function from devtools to install readr</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tidyverse/readr"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>By default, the only functions that when you start up <code>R</code> are the <em>base R</em> functions. If you want to use any functions from libraries that you’ve installed, you’ll need to tell <code>R</code> which library they come from.</p>
<p>One way to do this is is to use the <code>::</code> syntax: <code>packagename::functionname()</code>. For example, we can use the <code>str_length()</code> function from the <code>stringr</code> package as follows</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_length</span><span class="op">(</span><span class="st">"testing"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7</code></pre>
</div>
<div id="challenge7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5-using-a-library" class="callout-inner">
<h3 class="callout-title">Challenge 5: Using a library<a class="anchor" aria-label="anchor" href="#challenge7"></a>
</h3>
<div class="callout-content">
<p>What do you think will happen if we omit the <code>packagename::</code> part?</p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_length</span><span class="op">(</span><span class="st">"testing"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in str_length("testing"): could not find function "str_length"</code></pre>
</div>
<p>We get an error because <code>R</code> doesn’t know what the <code>str_length()</code> function is by default.</p>
</div>
</div>
</div>
</div>
<p>The other way to use functions from a library is to import all the functions in the library using the <code>library()</code> function. It’s best practice to put all the <code>library()</code> calls together at the top of your code, rather than sprinkling them throughout.</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import whole library</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">stringr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the str_length function without ::</span></span>
<span><span class="fu">str_length</span><span class="op">(</span><span class="st">"testing"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7</code></pre>
</div>
<p>You can still use the <code>packagename::functionname()</code> syntax even if you’ve loaded the library. This makes it clear which library the function comes from, and some style guides recommend that you do this for every function you use.</p>
<div id="callout5" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="function-conflicts" class="callout-inner">
<h3 class="callout-title">Function conflicts<a class="anchor" aria-label="anchor" href="#callout5"></a>
</h3>
<div class="callout-content">
<p>The order you load your packages is important. If two functions from two different packages you’ve loaded have the same name, the one you loaded last will be used. Sometimes packages will warn you about this - for example, when you load the <code>tidyverse</code> package (which is actually a collection of packages), you’ll see something like this.</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ forcats 0.5.2 
✔ readr   2.1.3      
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<p>This tells us that the <code>filter()</code> function from <code>dplyr</code> has overwritten (or ‘masked’) the <code>filter()</code> function from the <code>stats</code> package, and there is a similar conflict for <code>lag()</code>.</p>
<p>You can still use <code>stats::filter()</code> in your code, but you must explicitly specify that you want to use the<code>stats</code> package by prefixing it with <code>stats::</code>. If you just use <code>filter()</code>, you’ll get the version from <code>dplyr</code>.</p>
<p>Not all packages warn you about conflicts, so be careful you’re using the function that you think you’re using! This can be a source of strange errors, so try adding <code>packagename::</code> in front of your function calls if you this this might be happening.</p>
</div>
</div>
</div>
<div id="challenge8" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6-best-practices" class="callout-inner">
<h3 class="callout-title">Challenge 6: Best practices<a class="anchor" aria-label="anchor" href="#challenge8"></a>
</h3>
<div class="callout-content">
<p>In which situations do you think it’s best to use the <code>packagename::functionname()</code> syntax, and when should you use <code>library()</code>?</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<p>There’s no wrong or right answers here, but you might come across people that have (strong) opinions in this area.</p>
<p>Usually, if I’m only using one or two functions from a library, I won’t import the whole library, but just use the <code>packagename::functionname()</code> syntax. If I’m going to be using a lot of functions from a library, I’ll use <code>library()</code>.</p>
<p>Some people consider it best practice to always use <code>packagename::functionname()</code>, since then it’s clear which packages are being used and where. This also helps avoid conflicts between functions with the same name in different packages.</p>
<p>However, this style is quite verbose (and a little distracting), and some people might say that this makes code written this way less readable. In practice, I haven’t come across much code that always uses explicit package names.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="vectors">Vectors<a class="anchor" aria-label="anchor" href="#vectors"></a>
</h3>
<p>One of the most common data structures <code>R</code> is the <em>vector</em>. These are collections of elements (technically called ‘atomic vectors’) like numbers, which are arranged in a particular order.</p>
<p>Vectors are often created with the concatenation function <code>c()</code>:</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a vector of three numbers</span></span>
<span><span class="va">a_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># order matters!</span></span>
<span><span class="va">a_different_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p>In <code>R</code>, vectors contain data of only one type. Some of the types you might see are:</p>
<ul>
<li>Double: real numbers which can take on any value (like 1.13, 6, -1004.29)</li>
<li>Integer: whole real numbers (like 1, 2, -1)</li>
<li>Character: strings of characters, enclosed in either single or double quotes</li>
<li>Logical: booleans, either <code>TRUE</code> or <code>FALSE</code>
</li>
</ul>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we can use the seq function to create vectors with numbers in them</span></span>
<span><span class="va">double_vec</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add 'L' to the end of a number to tell R that it's an integer</span></span>
<span><span class="va">integer_vec</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">10L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># strings can be enclosed in single or double quotes</span></span>
<span><span class="va">character_vec</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"this"</span>, <span class="st">'is'</span>, <span class="st">"a"</span>, <span class="st">'vector'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># logicals are either TRUE or FALSE</span></span>
<span><span class="va">logical_vec</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>You can get at the individual elements of a vector using brackets (<code>[</code>):</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first element of double_vec</span></span>
<span><span class="va">double_vec</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># third to fifth elements of integer_vec</span></span>
<span><span class="va">integer_vec</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#first and fourth elements of character_vec</span></span>
<span><span class="va">character_vec</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div id="callout6" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="declaring-types" class="callout-inner">
<h3 class="callout-title">Declaring types<a class="anchor" aria-label="anchor" href="#callout6"></a>
</h3>
<div class="callout-content">
<p>In some programming languages, like <code>C</code> and <code>java</code>, the programmer must declare the type of a variable when it’s created. In these <a href="https://developer.mozilla.org/en-US/docs/Glossary/Static_typing#:~:text=A%20statically%2Dtyped%20language%20is,not%20indicate%20their%20variable%20types." class="external-link">statically typed</a> languages, a variable declared as an integer can’t store any other types of data. As a dynamically typed language, <code>R</code> takes a looser approach to variable types.</p>
</div>
</div>
</div>
<p>If you try to create a vector that contains more than one type of element, all the elements will be transformed into the ‘lowest common denominator’ type. For example, concatenating an integer and double will result in a double vector.</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># concatenating a double and an integer</span></span>
<span><span class="va">numeric_vec</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5.8</span>, <span class="fl">10L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the typeof function tells you the type of a variable</span></span>
<span><span class="fu">typeof</span><span class="op">(</span><span class="va">numeric_vec</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "double"</code></pre>
</div>
<p>One way to think about this is that elements are always coerced into the type that results in the least amount of information loss. The integers are a subset of all real numbers, so we can easily represent an integer <code>10L</code> as the numeric <code>10</code>. But if we tried to convert the real number <code>5.8</code> to an integer, how do we deal with the <code>.8</code> part?</p>
<div id="challenge9" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-7-types" class="callout-inner">
<h3 class="callout-title">Challenge 7: Types<a class="anchor" aria-label="anchor" href="#challenge9"></a>
</h3>
<div class="callout-content">
<p>What do you think will be the type of the following vector?</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unknown_type</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1</span>, <span class="st">"one"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" aria-labelledby="headingSolution9" data-bs-parent="#accordionSolution9">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unknown_type</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1</span>, <span class="st">"one"</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">unknown_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "1"   "1"   "one"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="fu">typeof</span><span class="op">(</span><span class="va">unknown_type</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<p>It’s a character vector.</p>
<p>Character vectors can be used to represent numbers, but numbers can’t easily be used to represent characters.</p>
</div>
</div>
</div>
</div>
<p><code>R</code> also has a way of representing missing data: there’s a special value in every type called <code>NA</code> (not available).</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre>
</div>
<p>Having <code>NA</code> values can change the way that functions interact with your data. For example, how would you take the mean of three values: 1, 2, and NA?</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<p><code>R</code> doesn’t know how to do this, so it just returns <code>NA</code>.</p>
<div id="challenge10" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-8-removing-na" class="callout-inner">
<h3 class="callout-title">Challenge 8: Removing NA<a class="anchor" aria-label="anchor" href="#challenge10"></a>
</h3>
<div class="callout-content">
<p>Check the documentation of the <code>mean</code> function to find out how to ignore <code>NA</code> values when computing the mean of a vector.</p>
</div>
</div>
</div>
<div id="accordionSolution10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution10" aria-expanded="false" aria-controls="collapseSolution10">
  <h4 class="accordion-header" id="headingSolution10">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution10" class="accordion-collapse collapse" aria-labelledby="headingSolution10" data-bs-parent="#accordionSolution10">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">C</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>, <span class="cn">NA</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in C(1, 2, NA): object not interpretable as a factor</code></pre>
</div>
<p>Use the additional named argument <code>na.rm=TRUE</code></p>
</div>
</div>
</div>
</div>
</div>
</section><section id="best-practices"><h2 class="section-heading">Best practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<hr class="half-width">
<p>Now you know the basics of <code>R</code>, there are a few best practices that you should follow on your journey. These aren’t hard and fast rules, but principles that you should aim to follow to make your code better and more reproducible.</p>
<div class="section level3">
<h3 id="formatting-and-readability-matters">Formatting and readability matters<a class="anchor" aria-label="anchor" href="#formatting-and-readability-matters"></a>
</h3>
<p>You should always be able to come back to your code after a long break (months, years) and easily understand what it does.</p>
<p>One thing that helps with this is to follow a style guide like <a href="https://style.tidyverse.org/" class="external-link">this one for the tidyverse</a></p>
<p>This covers things like:</p>
<ul>
<li>Commenting: do this a lot! It’s better to have more comments than fewer</li>
<li>Each script should start with a description of what it does or what it’s for</li>
<li>When you have to name something, use a name that makes sense. You’re more likely to understand what is contained in variable <code>my_peptide</code> than you are if it was called <code>p</code> or <code>x</code> or <code>owobljldfibllkmb</code>
</li>
<li>Syntax and spacing: use spaces and newlines to make your code more readable, not less</li>
<li>Line length: try to make horizontal scrolling unnecessary, which usually means lines are less than 80 characters</li>
</ul>
</div>
<div class="section level3">
<h3 id="dont-copypaste-code">Don’t copy/paste code<a class="anchor" aria-label="anchor" href="#dont-copypaste-code"></a>
</h3>
<p>Try to avoid copy-pasting blocks of code. If you find you need to make a change to that code, you’ll need to edit all the copies. If you do this, it’s easy to miss somewhere that you copied it, or make a mistake when you change it. If you find yourself needing to do the same task many times, it’s usually better to write a function instead.</p>
</div>
<div class="section level3">
<h3 id="test-your-expectations">Test your expectations<a class="anchor" aria-label="anchor" href="#test-your-expectations"></a>
</h3>
<p>Try to frequently test your code to see that it does what you expect it to do. Getting into this habit helps guard against bugs.</p>
<p>There are lots of different ways to do this, from just trying out the code with a few different inputs to automated <a href="https://en.wikipedia.org/wiki/Unit_testing" class="external-link">unit testing</a></p>
<p>Don’t forget also to test that your code doesn’t do things that you don’t expect it to do as well!</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define a function</span></span>
<span><span class="va">plus_three</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">return</span><span class="op">(</span> <span class="va">num</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># should return 11</span></span>
<span><span class="fu">plus_three</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># should return 2</span></span>
<span><span class="fu">plus_three</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># should raise an error</span></span>
<span><span class="fu">plus_three</span><span class="op">(</span><span class="st">"ten"</span><span class="op">)</span></span></code></pre>
</div>
<p>You can use the <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/stopifnot" class="external-link">function <code>stopifnot</code></a> to help you check things automatically.</p>
</div>
<div class="section level3">
<h3 id="project-management">Project management<a class="anchor" aria-label="anchor" href="#project-management"></a>
</h3>
<p>Aim to keep your data, scripts and output organized. <code>RStudio</code> helps you with this with Projects, which can be used to store all of the files related to a particular piece of analysis. People write <a href="https://github.com/swcarpentry/good-enough-practices-in-scientific-computing/blob/gh-pages/good-enough-practices-for-scientific-computing.pdf" class="external-link">whole papers</a> about this, but here are a few suggestions:</p>
<ul>
<li>Treat raw data and metadata as read-only. Put it in a folder called <code>data</code> and don’t write anything to that folder except for more raw data</li>
<li>Put source code in a folder called <code>src</code>
</li>
<li>Put files generated during analysis in a folder called <code>out</code> or <code>results</code>. It shouldn’t matter if this folder gets deleted, since you should be able to re-create its contents using your data and scripts</li>
<li>A <code>README</code> file can be useful for a broad overview of the project, and for explaining how to run the analysis</li>
<li>Keep track of the packages required for your analysis using <a href="https://rstudio.github.io/renv/articles/renv.html" class="external-link"><code>renv</code></a> (for <code>R</code> projects only), or <code>conda</code> (more general but has a few gotchas for <code>R</code> packages)</li>
</ul>
<p>That is, an organized project might look something like this:</p>
<pre><code>my_great_project
├── README.md
├── data
│   ├── dataset_1
│   │   ├── dataset_1.R1.fq.gz
│   │   └── dataset_1.R2.fq.gz
│   ├── dataset_2
│   │   ├── dataset_2_1.R1.fq.gz
│   │   ├── dataset_2_1.R2.fq.gz
│   │   ├── dataset_2_2.R1.fq.gz
│   │   └── dataset_2_2.R2.fq.gz
│   └── metadata
│       ├── metadata_1.tsv
│       └── metadata_2.tsv
├── renv
│   └── activate.R
├── results
│   ├── analyse
│   │   └── fold_change.tsv
│   ├── plot
│   │   ├── phylogeny.pdf
│   │   └── taxa.pdf
│   └── preprocess
│       ├── intermediate_result.tsv
│       ├── mapped.bam
│       └── mapped.bam.bai
└── scripts
    ├── 01_preprocess.R
    ├── 02_analyse.R
    └── 03_plot.R</code></pre>
</div>
</section><section id="links-and-acknowledgements"><h2 class="section-heading">Links and acknowledgements<a class="anchor" aria-label="anchor" href="#links-and-acknowledgements"></a>
</h2>
<hr class="half-width">
<p>As you begin your journey with <code>R</code>, you might find it helpful to refer to one-page summaries (or ‘cheat sheets’) that other people have compiled. For example, there are cheat sheets for:</p>
<ul>
<li><a href="https://drive.google.com/file/d/1bo8vMXeeiRy8l89eIjOALezO3V5oaewY/view" class="external-link">Commonly used functions</a></li>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/rstudio-ide.pdf" class="external-link">RStudio IDE</a></li>
</ul>
<p>Here are some other useful links</p>
<ul>
<li><a href="https://r4ds.had.co.nz/index.html" class="external-link">R for data science</a></li>
<li><a href="https://github.com/matloff/fasteR" class="external-link">fasteR, a course teaching (mainly) base R</a></li>
<li><a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003285" class="external-link">Ten Simple Rules for Reproducible Computational Research</a></li>
<li><a href="https://www.datacamp.com/tutorial/r-packages-guide" class="external-link">More information about installing R packages</a></li>
</ul>
<p>This lesson is inspired by and draws on some material from <a href="https://swcarpentry.github.io/r-novice-gapminder/01-rstudio-intro/index.html" class="external-link">Software Carpentries introduction to R</a>, <a href="https://datacarpentry.org/genomics-r-intro/00-introduction/index.html" class="external-link">Intro to R and Rstudio for Genomics</a>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use RStudio for writing and executing <code>R</code> code</li>
<li>Add comments to your code by starting a line with <code>#</code>
</li>
<li>Assign values to variables using the assignment operator <code>&lt;-</code>
</li>
<li>Functions covert inputs to outputs</li>
<li>Vectors are a collection of values of the same type</li>
<li>Following best practices will help the with the correctness and readability of your <code>R</code> code</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-reading-in-data-readr-and-readxl"><p>Content from <a href="reading-in-data-readr-and-readxl.html">Reading in data: readr and readxl</a></p>
<hr>
<p> Last updated on 2022-11-26 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/reading-in-data-readr-and-readxl.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we get data into <code>R</code>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the advantages of tidy data</li>
<li>Use <code>readxl</code> to import data from Microsoft Excel</li>
<li>Use <code>readr</code> to import data from text files</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="reading-in-data"><h2 class="section-heading">Reading in data<a class="anchor" aria-label="anchor" href="#reading-in-data"></a>
</h2>
<hr class="half-width">
<p>So you want to make some awesome plots using <code>R</code>. The first step you’ll need to take is to import your data.</p>
<p>When I first learnt <code>R</code> in a first-year statistics course, the way we did this was:</p>
<ol style="list-style-type: decimal">
<li>Open an Excel spreadsheet with the data</li>
<li>Select the data to be imported</li>
<li>Copy to the clipboard (<kbd>Cmd</kbd> + <kbd>c</kbd>)</li>
<li>Open an R terminal</li>
<li>Enter the command <code>read.table(pipe("pbpaste"), header = TRUE)</code>
</li>
</ol>
<p>This is a pretty convoluted way to do things! This weird process was part of the reason that, after I finished the course, I didn’t touch <code>R</code> again for almost ten years.</p>
<p>Luckily, in the meantime people worked out better ways of doing things. This lesson will cover two awesome packages which can help you import your data: <code>readxl</code> for Excel files, and <code>readr</code> for text files.</p>
</section><section id="reading-in-data-from-excel-readxl"><h2 class="section-heading">Reading in data from Excel: readxl<a class="anchor" aria-label="anchor" href="#reading-in-data-from-excel-readxl"></a>
</h2>
<hr class="half-width">
<p>If you’ve entered data into a digital format, chances are that you’ve used spreadsheet software like Microsoft Excel. Excel makes data entry easy because it takes care of all of the formatting for you. But at some point, you’ll probably want to get your data out of Excel and into <code>R</code>. That’s where the <code>readxl</code> package comes in!</p>
<p>The workhorse of this package is the <code>read_xlsx()</code> function (or <code>read_xls</code> for older excel files). It takes as input a path to the file you want to read.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define path to excel file to read - this will probably be different for you</span></span>
<span><span class="va">my_excel_sheet</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"readxl_example_1.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read in data </span></span>
<span><span class="va">my_excel_data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_xlsx</span><span class="op">(</span><span class="va">my_excel_sheet</span><span class="op">)</span></span>
<span><span class="va">my_excel_data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 3
  word           count number
  &lt;chr&gt;          &lt;chr&gt;  &lt;dbl&gt;
1 prematurely    one        4
2 airconditioned two        5
3 supermarket    three      6</code></pre>
</div>
<div class="section level3">
<h3 id="file-paths-with-herehere">File paths with <code>here::here()</code>
<a class="anchor" aria-label="anchor" href="#file-paths-with-herehere"></a>
</h3>
<p>Note that I use a function called <code>here</code> to create the file path to the excel file. You can read more about this function <a href="https://cran.r-project.org/web/packages/here/vignettes/here.html" class="external-link">here</a>.</p>
<p>Using this function helps with cross-platform compatibility (so it works on Windows as well as MacOSX and Linux). This is because directories on Windows are usually separated with a backslash <code>\</code>, whereas on Unix-based distributions (like MacOS and Linux) directories are separated by a slash <code>/</code>.</p>
<p>You can check what the file path looks like on your platform by printing out the variable we defined with the file path:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_excel_sheet</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "/home/runner/work/cmri_R_workshop/cmri_R_workshop/episodes/data/readxl_example_1.xlsx"</code></pre>
</div>
<p>Using <code>here::here()</code> always generates paths relative to the project root (the file created by RStudio when you make a new project, which has the file extension <code>.Rproj</code>). If you move the project around on your filesystem (or send it to someone else), the import will still work. This wouldn’t be the case if you manually specified the absolute path to the file.</p>
<p>Note that this example file path is a little convoluted, because of the way the lessons are created. Yours should be more straightforward and look more like this:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_excel_sheet</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"readxl_example_1.xlsx"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="tibbles">Tibbles<a class="anchor" aria-label="anchor" href="#tibbles"></a>
</h3>
<p>Coming back to the output of the call to <code>readxl::read_xlsx()</code> - calls to this function return a <code>tibble</code> object with the data contained in the excel spreadsheet.</p>
<p>The <code>tibble</code> object is a convenient way of storing rectangular data, where column has a type, (which is shown when you print the table). Ideally, in a tibble each column should contain data from one variable, and each row consists of observations of each variables - this is known as ‘tidy data’ (more on this in the next lesson).</p>
<p>If you don’t specify the types (like character, integer, double) of each column, <code>readxl</code> will try to <a href="https://readxl.tidyverse.org/articles/cell-and-column-types.html" class="external-link">guess them based on the types in the excel spreadhsheet</a>. This can lead to unexpected behaviour, especially if you mix numbers and strings in the same column.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-column-types" class="callout-inner">
<h3 class="callout-title">Challenge 1: Column types<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>Open the file <code>readxl_example_2.xlsx</code> in Excel. What do you think the types will be when you import this file?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in data </span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_xlsx</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"readxl_example_2.xlsx"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 5
  replicate `drug concentration` `assay 1` `assay 2` `assay 3`
      &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;     &lt;chr&gt;     &lt;lgl&gt;    
1         1 10 uM                ++        1         TRUE     
2         2 20 uM                +++       medium    FALSE    
3         2 20 uM                +         high      FALSE    </code></pre>
</div>
<p>Note that:</p>
<ul>
<li>The ‘replicate’ column has a type of <code>dbl</code> even though it contains only integers.</li>
<li>The ‘drug concentration’ column is of type <code>chr</code> because R doesn’t know that ‘uM’ is a unit.</li>
<li>Mixing numbers and characters in the ‘assay 2’ column results in a column of characters (why do you think this is?)</li>
</ul>
</div>
</div>
</div>
</div>
<p>The type of the columns is important to be aware of because some functions in R expect that you feed them columns of a particular type. For example, we can extract the ‘drug concentration’ column from the second file we imported using the <code>$</code> operator.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conc</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">`drug concentration`</span></span>
<span><span class="va">conc</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "10 uM" "20 uM" "20 uM"</code></pre>
</div>
<p>We can then extract the first two characters of each string in this column using <code>stringr::str_sub()</code>:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nums</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_sub</span><span class="op">(</span><span class="va">conc</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<p>But we can’t add one to this column:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conc</span> <span class="op">+</span> <span class="fl">1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in conc + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="specifying-column-types">Specifying column types<a class="anchor" aria-label="anchor" href="#specifying-column-types"></a>
</h3>
<p>Since the guessing of types can result in unexpected behaviour, it’s best to always specify the types of data when you import it. You can do this in a verbose way:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_xlsx</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"readxl_example_2.xlsx"</span><span class="op">)</span>,</span>
<span>                           col_types <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Coercing boolean to numeric in E2 / R2C5</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Coercing boolean to numeric in E3 / R3C5</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Coercing boolean to numeric in E4 / R4C5</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 5
  replicate `drug concentration` `assay 1` `assay 2` `assay 3`
      &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;
1         1 10 uM                ++        1                 1
2         2 20 uM                +++       medium            0
3         2 20 uM                +         high              0</code></pre>
</div>
<p>Note that the last column (‘assay 3’) contains Boolean (TRUE/FALSE) values, but we coerced it to a numeric type when we imported it. <code>R</code> prints a warning to let us know.</p>
</div>
<div class="section level3">
<h3 id="other-options">Other options<a class="anchor" aria-label="anchor" href="#other-options"></a>
</h3>
<p><code>readxl::read_xlsx()</code> also has lots of other options to deal with other aspects of data imports - for example, you can:</p>
<ul>
<li>Use the <code>sheet</code> and <code>range</code> named arguments to specify which parts of the sheet to import</li>
<li>Skip a number of header rows using the <code>skip</code> option,</li>
<li>Provide a vector of your own column names using the <code>col_names</code> argument</li>
<li>Pass <code>col_names=FALSE</code> to avoid using the first line of the file as your column names if your data doesn’t have column names</li>
</ul>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-readxl" class="callout-inner">
<h3 class="callout-title">Challenge 2: readxl<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>Open the file <code>human_codon_table.xlsx</code> in Excel. The columns of this table contain codons, frequencies of observations of each codon, and counts of each codon.</p>
<p>How do you think it should be imported?</p>
<p>Import this data, including the <code>col_names</code>, <code>skip</code>, <code>col_types</code>, <code>sheet</code> and <code>range</code> named arguments.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_xlsx</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"human_codon_table.xlsx"</span><span class="op">)</span>,</span>
<span>                  col_names <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"codon"</span>, <span class="st">"frequency"</span>, <span class="st">"count"</span><span class="op">)</span>,</span>
<span>                  skip<span class="op">=</span><span class="fl">0</span>,</span>
<span>                  col_types <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'text'</span>, <span class="st">'numeric'</span>, <span class="st">'numeric'</span><span class="op">)</span>,</span>
<span>                  sheet <span class="op">=</span> <span class="st">'human_codon_table'</span>,</span>
<span>                  range <span class="op">=</span> <span class="st">'A2:C65'</span> <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 64 × 3
   codon frequency  count
   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
 1 UCU        15.2 618711
 2 UAU        12.2 495699
 3 UGU        10.6 430311
 4 UUC        20.3 824692
 5 UCC        17.7 718892
 6 UAC        15.3 622407
 7 UGC        12.6 513028
 8 UUA         7.7 311881
 9 UCA        12.2 496448
10 UAA         1    40285
# … with 54 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="reading-in-data-from-text-files-readr"><h2 class="section-heading">Reading in data from text files: readr<a class="anchor" aria-label="anchor" href="#reading-in-data-from-text-files-readr"></a>
</h2>
<hr class="half-width">
<p>Alternatively, you might have tabular data in a text file. In these kinds of files, each row of the file is a row of the table, and usually either tabs or commas separate the values in each column.</p>
<p>If you have comma-separated data (like a <code>.csv</code> file) the <code>readr::read_csv()</code> function will be most convenient, and if your data is tab-separated (like a <code>.tsv</code> file), you’ll want <code>readr::read_tsv()</code>. If you have a different delimiter, you can use <code>readr::read_delim(file, delim=delimiter)</code>, where <code>delimiter</code> is a string containing your delimiter.</p>
<p>The syntax is very similar to <code>read_xlsx()</code>, and you should specify the column types here as well. Here I use the short form of the column specification - ‘<code>c</code>’ for character and ‘<code>i</code>’ for integer.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"readr_example_1.csv"</span><span class="op">)</span>,</span>
<span>                           col_types <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"cci"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 3
  word           count number
  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;
1 prematurely    one        4
2 airconditioned two        5
3 supermarket    three      6</code></pre>
</div>
<p>You can read more about the column specification for <code>readr</code> functions <a href="https://r4ds.had.co.nz/data-import.html" class="external-link">here</a>.</p>
<p>The other options for <code>read_csv()</code> are also similar to those for <code>read_xslx</code>, including <code>col_names</code> and <code>skip</code>.</p>
<div class="section level3">
<h3 id="reading-multiple-files">Reading multiple files<a class="anchor" aria-label="anchor" href="#reading-multiple-files"></a>
</h3>
<p>If you have multiple files with the same columns and column types, you can pass a vector of file paths rather than an atomic vector. To add an extra column with the file name (so you know which rows came from which files), use the <code>id</code> parameter.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"sim_0_counts.txt"</span><span class="op">)</span>,</span>
<span>           <span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"sim_1_counts.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_tsv</span><span class="op">(</span><span class="va">files</span>, col_types <span class="op">=</span> <span class="st">'cci'</span>, id<span class="op">=</span><span class="st">"file"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 4
  file                                                         test0 test1 count
  &lt;chr&gt;                                                        &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
1 /home/runner/work/cmri_R_workshop/cmri_R_workshop/episodes/… test… PRR       2
2 /home/runner/work/cmri_R_workshop/cmri_R_workshop/episodes/… test… AVSM      1
3 /home/runner/work/cmri_R_workshop/cmri_R_workshop/episodes/… test… IGLF      1
4 /home/runner/work/cmri_R_workshop/cmri_R_workshop/episodes/… test… no_i…  1039
5 /home/runner/work/cmri_R_workshop/cmri_R_workshop/episodes/… test… R        82
6 /home/runner/work/cmri_R_workshop/cmri_R_workshop/episodes/… test… DI        3</code></pre>
</div>
</div>
</section><section id="resources"><h2 class="section-heading">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf" class="external-link">Data import cheat sheet</a></li>
<li><a href="https://r4ds.had.co.nz/data-import.html" class="external-link">Data import section from R for data science</a></li>
<li><a href="https://readxl.tidyverse.org/" class="external-link">readxl documentation</a></li>
<li><a href="https://readr.tidyverse.org/" class="external-link">readr documentation</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>readxl::read_xlsx()</code> to import data from excel</li>
<li>Use <code>readr::read_tsv()</code>, <code>readr::read_csv()</code>, <code>readr::read_delim()</code> to import data from delimited text files</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-tidying-data"><p>Content from <a href="tidying-data.html">Tidy data</a></p>
<hr>
<p> Last updated on 2022-11-26 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/tidying-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is tidy data?</li>
<li>How can we pivot data frames to make them tidy?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the principles of tidy data</li>
<li>Use <code>pivot_longer()</code> and <code>pivot_wider()</code> to create longer or wider data frames</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="tidy-data"><h2 class="section-heading">Tidy data<a class="anchor" aria-label="anchor" href="#tidy-data"></a>
</h2>
<hr class="half-width">
<p>When recording observations, we don’t often give that much thought to how we record the data. Usually we enter data into an excel spreadsheet and care most about entering the data in the easiest way. However, this often results in ‘messy’ data that requires a little bit of massaging before analysis.</p>
<p>There are many possible ways to structure a dataset. For example, if we conducted an experiment where we made two sequencing libraries, in which we have counted the instances of six different barcodes, we could structure the data like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 7
  library    b1    b2    b3    b4    b5    b6
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1 lib1      404    97   114   798   388   795
2 lib2      110   788   812   393   409    85</code></pre>
</div>
<p>In this table, the counts for each barcode are stored in a separate column. The ‘library’ column tells us which library the counts on each row are from.</p>
<p>Conversely, we could keep the counts for each library in a separate column, and the rows can tell us which barcode is being counted:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 3
  barcode  lib1  lib2
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
1 b1        404   110
2 b2         97   788
3 b3        114   812
4 b4        798   393
5 b5        388   409
6 b6        795    85</code></pre>
</div>
<p>We could even structure the table like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 13
  library `404` `97`  `114` `798` `388` `795` `110` `788` `812` `393` `409`
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 lib1    b1    b2    b3    b4    b5    b6    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
2 lib2    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  b1    b2    b3    b4    b5   
# … with 1 more variable: `85` &lt;chr&gt;</code></pre>
</div>
<p>This is one of the least intuitive ways to structure the data - the columns are the counts (except for the library column), and the rows tell us which barcode had which count.</p>
<p>These are all examples of messy ways to structure the data. There are usually very many ways to make the data messy, but only one <a href="https://vita.had.co.nz/papers/tidy-data.pdf" class="external-link">‘Tidy’ format</a>. Being tidy means a dataset has:</p>
<ol style="list-style-type: decimal">
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table.</li>
</ol>
<p>Here, variables record all the values that measure the same attribute (for example library, sample, count), and an observation contains all the measurements on a single unit (like a sequencing run, or a single experiment). Each observational unit (like independent experiments with different variables) should get its own table. This just means that if we ran another experiment with different variables, it should go in a different table.</p>
<p>In our this case, the tidy version looks like this:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 12 × 3
   library barcode count
   &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;
 1 lib1    b1        404
 2 lib1    b2         97
 3 lib1    b3        114
 4 lib1    b4        798
 5 lib1    b5        388
 6 lib1    b6        795
 7 lib2    b1        110
 8 lib2    b2        788
 9 lib2    b3        812
10 lib2    b4        393
11 lib2    b5        409
12 lib2    b6         85</code></pre>
</div>
<p>This is tidy because each column represents a variable (library, barcode and count), each row is an observation (count for a given library and barcode), and we have all the data from this experiment in the one table.</p>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion1"></a>
</h3>
<div class="callout-content">
<p>Open the excel file <code>readr/untidy_data.xlsx</code>. Do you think this dataset is in a tidy format? Why/why not?</p>
<p>List ways that it could be improved.</p>

</div>
</div>
</div>
</section><section id="tidyr-for-tidying-data"><h2 class="section-heading">
<code>tidyr</code> for tidying data<a class="anchor" aria-label="anchor" href="#tidyr-for-tidying-data"></a>
</h2>
<hr class="half-width">
<p>So if tidy data is the goal, how do we get there? One way is to go back and edit the original file manually. But this is problematic for several reasons:</p>
<ul>
<li>You should treat your original data as read-only, and never change it</li>
<li>Manual edits are not reproducible</li>
<li>Manual edits can be time-consuming</li>
</ul>
<p>Instead, we can use tools from the <code>tidyr</code> and <code>dplyr</code> packages for tidying and manipulating tables of data.</p>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="data-pipelines-with-pipes" class="callout-inner">
<h3 class="callout-title">Data pipelines with pipes (<code>%&gt;%</code>)<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>Before we get to <code>tidyr</code> functions, I will first do a brief detour into what is now common practice in the R community: using pipes to build data pipelines.</p>
<p>Let’s consider an example. Say that we have a vector called <code>counts</code> that represents the counts for several vectors in a selection experiment, and we wanted to identify the unique counts, take their log, and then take the mean.</p>
<p>One way to do this is to call each function sequentially, assigning each to an intermediate variable:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate binomial data to play with</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">50</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unique_counts</span> <span class="op">&lt;-</span> <span class="fu">unique</span><span class="op">(</span><span class="va">counts</span><span class="op">)</span></span>
<span><span class="va">log_counts</span> <span class="op">&lt;-</span> <span class="fu">log</span><span class="op">(</span><span class="va">unique_counts</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">mean_log_counts</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">log_counts</span><span class="op">)</span></span></code></pre>
</div>
<p>This is a bit inefficient because we’ve had to type out the same variable name twice. I often find that when I do things this way, when I change one of the steps but forget to change both the variable names, and end up with weird bugs.</p>
<p>An alternative is to nest all the function calls inside each other:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_log_counts</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">log</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">counts</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Hopefully you can see why this isn’t a good idea - nested function calls can get very messy, very quickly, especially if the functions have multiple arguments (like <code>log()</code>).</p>
<p>A third way is using the pipe <code>%&gt;%</code> operator, which feeds the output of each function into the next:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_log_counts</span> <span class="op">&lt;-</span> <span class="va">counts</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">log</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mean</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>This version of the code is cleaner, and the top-to-bottom flow makes the order the functions are applied in more obvious. This way of doing things is very popular, and you’ll see it a lot (for example, in code sample on stack overflow).</p>
<p>There are a few complications to using the pipe which you can read more about <a href="https://r4ds.had.co.nz/pipes.html" class="external-link">here</a>. One that’s worth being aware of is that using lots of pipes can result in long pipelines, and if something goes wrong somewhere in the middle it can be hard to track down exactly where the issue is. In this case, you can use a few intermediate variables to try to figure out which step is going wrong.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="pivoting">Pivoting<a class="anchor" aria-label="anchor" href="#pivoting"></a>
</h3>
<p>The variants on the tables that we saw above are all generated by pivoting the tidy (or ‘long’) version to untidy (in this case, ‘wide’) versions. For example, looking at <code>table1b</code>:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table1b</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 3
  barcode  lib1  lib2
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
1 b1        404   110
2 b2         97   788
3 b3        114   812
4 b4        798   393
5 b5        388   409
6 b6        795    85</code></pre>
</div>
<p>Another way to think about tidiness is if the names of the column can reflect the data contained in them. It’s a bit misleading to call the columns <code>lib1</code> and <code>lib2</code>, they actually store counts (and not some other property of the library, such as the barcodes it contains).</p>
<p>We can see that if we were to restructure the lib1 and lib2 columns into two different columns, one that tell us from which library the count came, and one that contains the count value, the dataset would be tidy.</p>
<div class="section level4">
<h4 id="consolidating-columns-with-pivot_longer">Consolidating columns with <code>pivot_longer()</code>
<a class="anchor" aria-label="anchor" href="#consolidating-columns-with-pivot_longer"></a>
</h4>
<p>Knowing this, we can tidy the dataset up using <code>pivot_longer()</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table1b</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">lib1</span><span class="op">:</span><span class="va">lib2</span>, names_to<span class="op">=</span><span class="st">"library"</span>, values_to<span class="op">=</span><span class="st">"count"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 12 × 3
   barcode library count
   &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;
 1 b1      lib1      404
 2 b1      lib2      110
 3 b2      lib1       97
 4 b2      lib2      788
 5 b3      lib1      114
 6 b3      lib2      812
 7 b4      lib1      798
 8 b4      lib2      393
 9 b5      lib1      388
10 b5      lib2      409
11 b6      lib1      795
12 b6      lib2       85</code></pre>
</div>
<p>We can tell that this data is tidy because the column names accurately reflect the data they contain: the count column stores counts, the library column tells us which library the counts came from, and the barcode column tells us which barcode we’re measuring.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/pivot_longer_R.png" alt="" class="figure mx-auto d-block"><figcaption>Pivoting longer</figcaption></figure>
</div>
<div class="section level4">
<h4 id="creating-more-columns-with-pivot_wider">Creating more columns with <code>pivot_wider()</code>
<a class="anchor" aria-label="anchor" href="#creating-more-columns-with-pivot_wider"></a>
</h4>
<p>We can also do the reverse operation using <code>pivot_wider()</code> (this was how I generated the untidy versions of the tables). But haven’t we just been saying that we should always aspire to keep our data tidy? So why would we ever want to do this?</p>
<p>When working with data in <code>R</code>, the long format does tend to be the most useful, because this is the format that most functions expect data to be in. However, if you want to display the data for a person (rather than for a function in code), the wide format can sometimes be useful for making comparisons. For example, we can easily compare the counts for each barcode in the two libraries in <code>table1b</code>, but the comparison is easy for a person to make when the table is in a long form.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 12 × 3
   library barcode count
   &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;
 1 lib1    b1        404
 2 lib1    b2         97
 3 lib1    b3        114
 4 lib1    b4        798
 5 lib1    b5        388
 6 lib1    b6        795
 7 lib2    b1        110
 8 lib2    b2        788
 9 lib2    b3        812
10 lib2    b4        393
11 lib2    b5        409
12 lib2    b6         85</code></pre>
</div>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/pivot_wider_R.png" alt="" class="figure mx-auto d-block"><figcaption>Pivoting wider</figcaption></figure><p>We can pivot our long table to a wide one using <code>pivot_longer()</code>.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table1</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"library"</span>, values_from <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 3
  barcode  lib1  lib2
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
1 b1        404   110
2 b2         97   788
3 b3        114   812
4 b4        798   393
5 b5        388   409
6 b6        795    85</code></pre>
</div>
</div>
</div>
</section><section id="other-tidyr-functions"><h2 class="section-heading">Other <code>tidyr</code> functions<a class="anchor" aria-label="anchor" href="#other-tidyr-functions"></a>
</h2>
<hr class="half-width">
<p>Tidyr also has a number of other useful functions for tidying up datasets, which include: - Combining columns where multiples pieces of information are spread out (<code>unite()</code>), or spreading out columns which contain data that should be in separate column (<code>separate()</code>) - Adding extra rows to create all possible combinations of the values in multiple columns (<code>expand()</code> and <code>complete</code>) - Handling missing values, for example replacing <code>NA</code> values with something else (<code>replace_na()</code>) or dropping rows that contain <code>NA</code> (<code>drop_na()</code>) - Nesting data within list-columns (<code>nest()</code>), and unnesting such columns (<code>unnest()</code>)</p>
<p>While useful, I tend to use these less frequently compared to the pivoting functions, so I leave these to you to explore on your own. You can get an overview of these functions on the <a href="https://github.com/rstudio/cheatsheets/blob/main/tidyr.pdf" class="external-link">tidyr cheatsheet</a>, and in the <a href="https://tidyr.tidyverse.org/" class="external-link">tidyr documentation</a>.</p>
</section><section id="resources-and-acknowledgments"><h2 class="section-heading">Resources and acknowledgments<a class="anchor" aria-label="anchor" href="#resources-and-acknowledgments"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://cloud.r-project.org/web/packages/tidyr/vignettes/tidy-data.html" class="external-link">Tidy data vignette</a></li>
<li><a href="https://vita.had.co.nz/papers/tidy-data.pdf" class="external-link">Tidy data paper</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/blob/main/tidyr.pdf" class="external-link">tidyr cheatsheet</a></li>
<li>I’ve borrowed figures (and inspiration) from the excellent <a href="https://ab604.github.io/docs/coding-together-2019/data-wrangle-1.html" class="external-link">coding togetheR course material</a>
</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Tidy data is often easier to work with</li>
<li>Pivot long to wide with <code>pivot_wider()</code>
</li>
<li>Pivot wide to long with <code>pivot_longer()</code>
</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-manipulating-data"><p>Content from <a href="manipulating-data.html">Data wrangling</a></p>
<hr>
<p> Last updated on 2022-11-26 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/manipulating-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the main <code>dplyr</code> verbs?</li>
<li>How can I analyse data within groups?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Know how to use the main <code>dplyr</code> verbs</li>
<li>Use <code>group_by()</code> to aggregate and manipulate within groups</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="manipulating-data-with-dplyr"><h2 class="section-heading">Manipulating data with <code>dplyr</code><a class="anchor" aria-label="anchor" href="#manipulating-data-with-dplyr"></a>
</h2>
<hr class="half-width">
<p>So once we have our data in a tidy format, what do we do with it? For analysis, I often turn to the <code>dplyr</code> package, which contains several useful functions for manipulating tables of data.</p>
<p>To illustrate the functions of this package, we’ll use a dataset of weather observations in Brisbane and Sydney from <a href="http://www.bom.gov.au/climate/data/" class="external-link">the Bureau of Meterology</a>.</p>
<p>These files are called <code>weather_brisbane.csv</code> and <code>weather_sydney.csv</code>.</p>
<p>First, we load both files using <code>readr</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load tidyverse</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.4.1 
✔ readr   2.1.3      ✔ forcats 0.5.2 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data files</span></span>
<span><span class="co"># data files - readr can also read data from the internet</span></span>
<span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/szsctt/cmri_R_workshop/main/episodes/data/"</span></span>
<span><span class="va">data_files</span> <span class="op">&lt;-</span> <span class="fu">file.path</span><span class="op">(</span><span class="va">data_dir</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"weather_sydney.csv"</span>, <span class="st">"weather_brisbane.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># column types</span></span>
<span><span class="va">col_types</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="fu">col_date</span><span class="op">(</span>format<span class="op">=</span><span class="st">"%Y-%m-%d"</span><span class="op">)</span>,</span>
<span>  min_temp_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_temp_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rainfall_mm <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  evaporation_mm <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  sunshine_hours <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dir_max_wind_gust <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  speed_max_wind_gust_kph <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  time_max_wind_gust <span class="op">=</span> <span class="fu">col_time</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  temp_9am_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rel_humid_9am_pc <span class="op">=</span> <span class="fu">col_integer</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cloud_amount_9am_oktas <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_direction_9am <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_speed_9am_kph <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  MSL_pressure_9am_hPa <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  temp_3pm_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rel_humid_3pm_pc <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cloud_amount_3pm_oktas <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_direction_3pm <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_speed_3pm_kph <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  MSL_pressure_3pm_hPa <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read in data</span></span>
<span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_csv</span><span class="op">(</span><span class="va">data_files</span>, skip<span class="op">=</span><span class="fl">10</span>, </span>
<span>                           col_types<span class="op">=</span><span class="va">col_types</span>, col_names <span class="op">=</span> <span class="fu">names</span><span class="op">(</span><span class="va">col_types</span><span class="op">)</span>,</span>
<span>                           id<span class="op">=</span><span class="st">"file"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="creating-summaries-with-summarise">Creating summaries with <code>summarise()</code>
<a class="anchor" aria-label="anchor" href="#creating-summaries-with-summarise"></a>
</h3>
<p>First, we would like to know what the mean minimum and maximum temperatures were overall. For this, we can use <code>summarise()</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_min_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span>,</span>
<span>            mean_max_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">max_temp_c</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 2
  mean_min_temp mean_max_temp
          &lt;dbl&gt;         &lt;dbl&gt;
1          15.5            NA</code></pre>
</div>
<p>Notice that the mean_max_temp is <code>NA</code>, because we had some <code>NA</code> values in this column. In <code>R</code> we use <code>NA</code> for missing values. So how does one take the mean of some numbers, some of which are missing? We can’t so the answer is also a missing value. We can, however, tell the <code>mean()</code> function to ignore the missing values using <code>na.rm=TRUE</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_min_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span>,</span>
<span>            mean_max_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">max_temp_c</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 2
  mean_min_temp mean_max_temp
          &lt;dbl&gt;         &lt;dbl&gt;
1          15.5          25.7</code></pre>
</div>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-medians" class="callout-inner">
<h3 class="callout-title">Challenge 1: medians<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>What is the median minimum and maximum temperature in the weather observations?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median_min_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span>,</span>
<span>            median_max_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">max_temp_c</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 2
  median_min_temp median_max_temp
            &lt;dbl&gt;           &lt;dbl&gt;
1            15.5            24.9</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><code>dplyr</code> also has some special functions that are designed to be used inside of other functions. For example, if we want to know how many observations there were of the minimum and maximum temperatures, we could use <code>n()</code>. Or if we wanted to know how many different directions the maximum wind gust had, we can use <code>n_distinct()</code>.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n_days_observed <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>            n_wind_dir <span class="op">=</span> <span class="fu">n_distinct</span><span class="op">(</span><span class="va">dir_max_wind_gust</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 2
  n_days_observed n_wind_dir
            &lt;int&gt;      &lt;int&gt;
1              43         14</code></pre>
</div>
<div class="section level4">
<h4 id="grouped-summaries-with-group_by">Grouped summaries with <code>group_by()</code>
<a class="anchor" aria-label="anchor" href="#grouped-summaries-with-group_by"></a>
</h4>
<p>However, all of these summaries have combined the observations for Sydney and Brisbane. It probably makes sense to group the observations by city, and then compute the summary statistics. For this, we can use <code>group_by()</code>.</p>
<p>If you use <code>group_by()</code> on a tibble, it doesn’t actually look like it changes that much.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 22
# Groups:   file [2]
   file       date       min_t…¹ max_t…² rainf…³ evapo…⁴ sunsh…⁵ dir_m…⁶ speed…⁷
   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 https://r… 2022-11-01    18.2    24       0.2     4.6     9.5 WNW          69
 2 https://r… 2022-11-02    11.1    20.5     0.6    13      12.8 W            67
 3 https://r… 2022-11-03    11.1    22       0       7.8     8.9 W            56
 4 https://r… 2022-11-04    13.4    23.1     1       6       5.7 SSE          26
 5 https://r… 2022-11-05    13.4    23.6     0.2     4.4    11.8 ENE          37
 6 https://r… 2022-11-06    13.3    24       0       4      12.1 ENE          39
 7 https://r… 2022-11-07    15.4    24.2     0       9.8    12.3 NE           41
 8 https://r… 2022-11-08    16      24.2     1.2     8      11   ENE          35
 9 https://r… 2022-11-09    14.9    24.2     0.2     8      10.3 E            33
10 https://r… 2022-11-10    14.9    24.4     0       7.8     9.3 ENE          43
# … with 33 more rows, 13 more variables: time_max_wind_gust &lt;time&gt;,
#   temp_9am_c &lt;dbl&gt;, rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, and abbreviated
#   variable names ¹​min_temp_c, ²​max_temp_c, ³​rainfall_mm, ⁴​evaporation_mm, …</code></pre>
</div>
<p>The only difference is that when you print it out, it tells you that it’s grouped by file. However, a grouped data frame interacts differently with other <code>dplyr</code> verbs, such as <code>summary</code>.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">file</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median_min_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span>,</span>
<span>            median_max_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">max_temp_c</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 3
  file                                                           media…¹ media…²
  &lt;chr&gt;                                                            &lt;dbl&gt;   &lt;dbl&gt;
1 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/main…    15.6    26.0
2 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/main…    14.9    24.2
# … with abbreviated variable names ¹​median_min_temp, ²​median_max_temp</code></pre>
</div>
<p>Now we get the median temperature for both Sydney and Brisbane.</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-medians" class="callout-inner">
<h3 class="callout-title">Challenge 2: medians<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>What is the maximum wind speed (<code>speed_max_wind_gust_kph</code>) in each direction (<code>dir_max_wind_gust</code>) for each city?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">file</span>, <span class="va">dir_max_wind_gust</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>max_max_wind_gust <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">speed_max_wind_gust_kph</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'file'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 21 × 3
# Groups:   file [2]
   file                                                          dir_m…¹ max_m…²
   &lt;chr&gt;                                                         &lt;chr&gt;     &lt;dbl&gt;
 1 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/mai… E            35
 2 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/mai… ENE          37
 3 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/mai… ESE          35
 4 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/mai… NE           26
 5 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/mai… NNE          35
 6 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/mai… NW           48
 7 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/mai… W            44
 8 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/mai… WNW          33
 9 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/mai… WSW          43
10 https://raw.githubusercontent.com/szsctt/cmri_R_workshop/mai… &lt;NA&gt;         NA
# … with 11 more rows, and abbreviated variable names ¹​dir_max_wind_gust,
#   ²​max_max_wind_gust</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-medians" class="callout-inner">
<h3 class="callout-title">Challenge 2: medians<em> (continued)</em><a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>Can you pivot the table wider to make it easier to compare between directions and cities?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">file</span>, <span class="va">dir_max_wind_gust</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>max_max_wind_gust <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">speed_max_wind_gust_kph</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>id_cols<span class="op">=</span><span class="va">file</span>, names_from <span class="op">=</span> <span class="st">"dir_max_wind_gust"</span>, values_from <span class="op">=</span> <span class="st">"max_max_wind_gust"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'file'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 15
  file       E   ENE   ESE    NE   NNE    NW     W   WNW   WSW  `NA`   NNW     S
  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 https…    35    37    35    26    35    48    44    33    43    NA    NA    NA
2 https…    33    50    26    41    NA    NA    83    69    NA    NA    46    54
# … with 2 more variables: SSE &lt;dbl&gt;, SW &lt;dbl&gt;</code></pre>
</div>
<p>Do you prefer the long or wide form of the table?</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="creating-new-columns-with-mutate">Creating new columns with <code>mutate()</code>
<a class="anchor" aria-label="anchor" href="#creating-new-columns-with-mutate"></a>
</h3>
<p>It’s kind of annoying that we have the whole file names, rather than just the names of the cities. To fix this, we can create (or overwrite) columns with <code>mutate()</code>.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/dplyr-mutate-16-10-2019.png" alt="" class="figure mx-auto d-block"><figcaption><code>dplyr::mutate()</code> <a href="https://ab604.github.io/docs/coding-together-2019" class="external-link">image credit</a></figcaption></figure><p>For example, the <code>stringr::str_extract()</code> function extracts a matching pattern from a string:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_extract</span><span class="op">(</span><span class="va">data_files</span>, <span class="st">"sydney|brisbane"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "sydney"   "brisbane"</code></pre>
</div>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>The second argument to <code>str_extract()</code> is a regular expression, or <em>regex</em>. Using regular expressions is a hugely flexible way to specify a pattern to match in a string, but it’s a somewhat complicated topic that I won’t go into here. If you’re interested in learning more, you can look at the <a href="https://stringr.tidyverse.org/articles/regular-expressions.html" class="external-link">stringr documentation on regular expressions</a>.</p>
</div>
</div>
</div>
<p>We can use <code>mutate()</code> to apply the <code>str_extract()</code> function to the <code>file</code> column</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>city <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_extract</span><span class="op">(</span><span class="va">file</span>, <span class="st">"sydney|brisbane"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">weather</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 23
   file       date       min_t…¹ max_t…² rainf…³ evapo…⁴ sunsh…⁵ dir_m…⁶ speed…⁷
   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 https://r… 2022-11-01    18.2    24       0.2     4.6     9.5 WNW          69
 2 https://r… 2022-11-02    11.1    20.5     0.6    13      12.8 W            67
 3 https://r… 2022-11-03    11.1    22       0       7.8     8.9 W            56
 4 https://r… 2022-11-04    13.4    23.1     1       6       5.7 SSE          26
 5 https://r… 2022-11-05    13.4    23.6     0.2     4.4    11.8 ENE          37
 6 https://r… 2022-11-06    13.3    24       0       4      12.1 ENE          39
 7 https://r… 2022-11-07    15.4    24.2     0       9.8    12.3 NE           41
 8 https://r… 2022-11-08    16      24.2     1.2     8      11   ENE          35
 9 https://r… 2022-11-09    14.9    24.2     0.2     8      10.3 E            33
10 https://r… 2022-11-10    14.9    24.4     0       7.8     9.3 ENE          43
# … with 33 more rows, 14 more variables: time_max_wind_gust &lt;time&gt;,
#   temp_9am_c &lt;dbl&gt;, rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, city &lt;chr&gt;, and
#   abbreviated variable names ¹​min_temp_c, ²​max_temp_c, ³​rainfall_mm, …</code></pre>
</div>
<p>Now if we repeat the same summary as before, we get an output that’s a bit easier to read.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median_min_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span>,</span>
<span>            median_max_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">max_temp_c</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 3
  city     median_min_temp median_max_temp
  &lt;chr&gt;              &lt;dbl&gt;           &lt;dbl&gt;
1 brisbane            15.6            26.0
2 sydney              14.9            24.2</code></pre>
</div>
<div class="section level4">
<h4 id="mutating-multiple-columns-with-across">Mutating multiple columns with <code>across()</code>
<a class="anchor" aria-label="anchor" href="#mutating-multiple-columns-with-across"></a>
</h4>
<p>Let’s imagine that the calibration was wrong for both temperature sensors, and all the temperature measurements are out by 1°C. We’d like to add 1 to each of the temperature measurements. There are multiple columns that contain temperatures, so we could do this:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>min_temp_c <span class="op">=</span> <span class="va">min_temp_c</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>         max_temp_c <span class="op">=</span> <span class="va">max_temp_c</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>         temp_9am_c <span class="op">=</span> <span class="va">temp_9am_c</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>         temp_3pm_c <span class="op">=</span> <span class="va">temp_3pm_c</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 23
   file       date       min_t…¹ max_t…² rainf…³ evapo…⁴ sunsh…⁵ dir_m…⁶ speed…⁷
   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 https://r… 2022-11-01    19.2    25       0.2     4.6     9.5 WNW          69
 2 https://r… 2022-11-02    12.1    21.5     0.6    13      12.8 W            67
 3 https://r… 2022-11-03    12.1    23       0       7.8     8.9 W            56
 4 https://r… 2022-11-04    14.4    24.1     1       6       5.7 SSE          26
 5 https://r… 2022-11-05    14.4    24.6     0.2     4.4    11.8 ENE          37
 6 https://r… 2022-11-06    14.3    25       0       4      12.1 ENE          39
 7 https://r… 2022-11-07    16.4    25.2     0       9.8    12.3 NE           41
 8 https://r… 2022-11-08    17      25.2     1.2     8      11   ENE          35
 9 https://r… 2022-11-09    15.9    25.2     0.2     8      10.3 E            33
10 https://r… 2022-11-10    15.9    25.4     0       7.8     9.3 ENE          43
# … with 33 more rows, 14 more variables: time_max_wind_gust &lt;time&gt;,
#   temp_9am_c &lt;dbl&gt;, rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, city &lt;chr&gt;, and
#   abbreviated variable names ¹​min_temp_c, ²​max_temp_c, ³​rainfall_mm, …</code></pre>
</div>
<p>But it’s a bit annoying to type out each column. Instead, we can use <code>across()</code> inside <code>mutate()</code> to apply the same transformation to all columns whose name contains the string “temp”. The syntax is a little complicated, so don’t worry if you don’t get it straight away. We use the <code>contains()</code> function to get the columns we want (by matching the regex “temp”), and then to each of these columns we add one - the <code>.</code> will be replaced by the name of each column when the expression is evaluated.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, <span class="op">~</span><span class="va">.</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 23
   file       date       min_t…¹ max_t…² rainf…³ evapo…⁴ sunsh…⁵ dir_m…⁶ speed…⁷
   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 https://r… 2022-11-01    19.2    25       0.2     4.6     9.5 WNW          69
 2 https://r… 2022-11-02    12.1    21.5     0.6    13      12.8 W            67
 3 https://r… 2022-11-03    12.1    23       0       7.8     8.9 W            56
 4 https://r… 2022-11-04    14.4    24.1     1       6       5.7 SSE          26
 5 https://r… 2022-11-05    14.4    24.6     0.2     4.4    11.8 ENE          37
 6 https://r… 2022-11-06    14.3    25       0       4      12.1 ENE          39
 7 https://r… 2022-11-07    16.4    25.2     0       9.8    12.3 NE           41
 8 https://r… 2022-11-08    17      25.2     1.2     8      11   ENE          35
 9 https://r… 2022-11-09    15.9    25.2     0.2     8      10.3 E            33
10 https://r… 2022-11-10    15.9    25.4     0       7.8     9.3 ENE          43
# … with 33 more rows, 14 more variables: time_max_wind_gust &lt;time&gt;,
#   temp_9am_c &lt;dbl&gt;, rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, city &lt;chr&gt;, and
#   abbreviated variable names ¹​min_temp_c, ²​max_temp_c, ³​rainfall_mm, …</code></pre>
</div>
<p>Equivalently, we could also use a function to make the transformation.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">return</span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 23
   file       date       min_t…¹ max_t…² rainf…³ evapo…⁴ sunsh…⁵ dir_m…⁶ speed…⁷
   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 https://r… 2022-11-01    19.2    25       0.2     4.6     9.5 WNW          69
 2 https://r… 2022-11-02    12.1    21.5     0.6    13      12.8 W            67
 3 https://r… 2022-11-03    12.1    23       0       7.8     8.9 W            56
 4 https://r… 2022-11-04    14.4    24.1     1       6       5.7 SSE          26
 5 https://r… 2022-11-05    14.4    24.6     0.2     4.4    11.8 ENE          37
 6 https://r… 2022-11-06    14.3    25       0       4      12.1 ENE          39
 7 https://r… 2022-11-07    16.4    25.2     0       9.8    12.3 NE           41
 8 https://r… 2022-11-08    17      25.2     1.2     8      11   ENE          35
 9 https://r… 2022-11-09    15.9    25.2     0.2     8      10.3 E            33
10 https://r… 2022-11-10    15.9    25.4     0       7.8     9.3 ENE          43
# … with 33 more rows, 14 more variables: time_max_wind_gust &lt;time&gt;,
#   temp_9am_c &lt;dbl&gt;, rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, city &lt;chr&gt;, and
#   abbreviated variable names ¹​min_temp_c, ²​max_temp_c, ³​rainfall_mm, …</code></pre>
</div>
</div>
</div>
<div class="section level3">
<h3 id="filtering-rows-with-filter">Filtering rows with <code>filter()</code>
<a class="anchor" aria-label="anchor" href="#filtering-rows-with-filter"></a>
</h3>
<p>Let’s say that now we want information about days that were cloudy - for example, those where there were fewer than 10 sunshine hours. We can use <code>filter()</code> to get only those rows.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/dplyr_filter.png" alt="" class="figure mx-auto d-block"><figcaption><code>dplyr::filter()</code> <a href="https://ab604.github.io/docs/coding-together-2019" class="external-link">image credit</a></figcaption></figure><div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sunshine_hours</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 12 × 23
   file       date       min_t…¹ max_t…² rainf…³ evapo…⁴ sunsh…⁵ dir_m…⁶ speed…⁷
   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 https://r… 2022-11-01    18.2    24       0.2     4.6     9.5 WNW          69
 2 https://r… 2022-11-03    11.1    22       0       7.8     8.9 W            56
 3 https://r… 2022-11-04    13.4    23.1     1       6       5.7 SSE          26
 4 https://r… 2022-11-10    14.9    24.4     0       7.8     9.3 ENE          43
 5 https://r… 2022-11-11    14.9    24.9     0       7.8     9.1 ENE          39
 6 https://r… 2022-11-12    16      27.9     0       7.8     9.5 ESE          26
 7 https://r… 2022-11-13    18.9    25.6     0       6.4     1.7 NNW          46
 8 https://r… 2022-11-15    16.2    24.9     0.2     9.6     9.2 SW           33
 9 https://r… 2022-11-16    13      21.6     0.8     8       9.1 S            54
10 https://r… 2022-11-08    14.7    25.2     0      10       9.9 ESE          33
11 https://r… 2022-11-14    20.6    28.8     0       9.8     8.4 ENE          26
12 https://r… 2022-11-20    20.8    34.5     0       8.8     5.7 NW           48
# … with 14 more variables: time_max_wind_gust &lt;time&gt;, temp_9am_c &lt;dbl&gt;,
#   rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, city &lt;chr&gt;, and
#   abbreviated variable names ¹​min_temp_c, ²​max_temp_c, ³​rainfall_mm, …</code></pre>
</div>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-is-it-better-to-live-in-sydney-or-brisbane" class="callout-inner">
<h3 class="callout-title">Challenge 3: Is it better to live in Sydney or Brisbane?<a class="anchor" aria-label="anchor" href="#challenge4"></a>
</h3>
<div class="callout-content">
<p>Combine <code>filter()</code> with <code>group_by()</code>,<code>summarise()</code> and <code>n()</code> to count the number of days when there were more than 10 hours of sunshine in each city.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sunshine_hours</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n_days <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 2
  city     n_days
  &lt;chr&gt;     &lt;int&gt;
1 brisbane     17
2 sydney       12</code></pre>
</div>
<p>There were more days with more than 10 hours of sunlight in Brisbane than in Sydney. I’ll let you draw your own conclusions.</p>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="complex-filters-with-case_when">Complex filters with <code>case_when()</code>
<a class="anchor" aria-label="anchor" href="#complex-filters-with-case_when"></a>
</h4>
<p>Let’s say we wanted to keep only the rows from sunny, warm days and cloudy, cold days. We could do this just with one logical expression.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">(</span><span class="va">sunshine_hours</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&gt;</span> <span class="fl">25</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">sunshine_hours</span> <span class="op">&lt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&lt;</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 15 × 23
   file       date       min_t…¹ max_t…² rainf…³ evapo…⁴ sunsh…⁵ dir_m…⁶ speed…⁷
   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 https://r… 2022-11-14    18.1    27.9    37.6     4.2    10.8 W            67
 2 https://r… 2022-11-20    18      27.4     0.8     7.8    13.3 W            70
 3 https://r… 2022-11-05    15.5    25.1     0       8.6    12.2 E            30
 4 https://r… 2022-11-06    15.6    25.6     0       8.2    12.7 E            31
 5 https://r… 2022-11-07    15.5    25.7     0       7.4    12.6 ENE          37
 6 https://r… 2022-11-09    14.7    25.3     0       8.4    12.4 ESE          30
 7 https://r… 2022-11-10    15.9    25.7     0       8.6    12.5 E            35
 8 https://r… 2022-11-11    14.4    26.2     0       9.4    12.1 E            22
 9 https://r… 2022-11-12    15.8    28.4     0       7.4    10.5 NE           26
10 https://r… 2022-11-13    17.6    27.7     0       7.2    12.4 NNE          33
11 https://r… 2022-11-15    20      33.3     0       5.6    12.9 WNW          30
12 https://r… 2022-11-16    16.6    30.1     0       8.2    12.5 WSW          43
13 https://r… 2022-11-18    13.7    27       0       7.4    12.7 ENE          24
14 https://r… 2022-11-19    15.1    28.3     0       8      12.5 NNE          35
15 https://r… 2022-11-21    21.2    34.3     6.6    10.4    10.9 WNW          33
# … with 14 more variables: time_max_wind_gust &lt;time&gt;, temp_9am_c &lt;dbl&gt;,
#   rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, city &lt;chr&gt;, and
#   abbreviated variable names ¹​min_temp_c, ²​max_temp_c, ³​rainfall_mm, …</code></pre>
</div>
<p>But you can imagine that with more conditions, this can get a bit messy. I prefer to use <code>case_when()</code> in such situations:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&gt;</span> <span class="fl">25</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&lt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&lt;</span> <span class="fl">15</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 15 × 23
   file       date       min_t…¹ max_t…² rainf…³ evapo…⁴ sunsh…⁵ dir_m…⁶ speed…⁷
   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 https://r… 2022-11-14    18.1    27.9    37.6     4.2    10.8 W            67
 2 https://r… 2022-11-20    18      27.4     0.8     7.8    13.3 W            70
 3 https://r… 2022-11-05    15.5    25.1     0       8.6    12.2 E            30
 4 https://r… 2022-11-06    15.6    25.6     0       8.2    12.7 E            31
 5 https://r… 2022-11-07    15.5    25.7     0       7.4    12.6 ENE          37
 6 https://r… 2022-11-09    14.7    25.3     0       8.4    12.4 ESE          30
 7 https://r… 2022-11-10    15.9    25.7     0       8.6    12.5 E            35
 8 https://r… 2022-11-11    14.4    26.2     0       9.4    12.1 E            22
 9 https://r… 2022-11-12    15.8    28.4     0       7.4    10.5 NE           26
10 https://r… 2022-11-13    17.6    27.7     0       7.2    12.4 NNE          33
11 https://r… 2022-11-15    20      33.3     0       5.6    12.9 WNW          30
12 https://r… 2022-11-16    16.6    30.1     0       8.2    12.5 WSW          43
13 https://r… 2022-11-18    13.7    27       0       7.4    12.7 ENE          24
14 https://r… 2022-11-19    15.1    28.3     0       8      12.5 NNE          35
15 https://r… 2022-11-21    21.2    34.3     6.6    10.4    10.9 WNW          33
# … with 14 more variables: time_max_wind_gust &lt;time&gt;, temp_9am_c &lt;dbl&gt;,
#   rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, city &lt;chr&gt;, and
#   abbreviated variable names ¹​min_temp_c, ²​max_temp_c, ³​rainfall_mm, …</code></pre>
</div>
<p>Essentially, <code>case_when()</code> looks at each condition in turn, and if the left part of the expression (before the <code>~</code>) evaluates to <code>TRUE</code>, then it returns whatever is on the right of the <code>~</code>.</p>
<ul>
<li>We first ask if this row has more than ten sunshine hours and a maximum temperature of more than 25 - if this is the case, we return <code>TRUE</code> (and <code>filter()</code> retains this row).<br>
</li>
<li>Next, we ask if the row has less than ten sunshine hours and a maximum temperature of less than 15, in which case we also return <code>TRUE</code>.<br>
</li>
<li>If both these statements are <code>FALSE</code>, then the <code>TRUE</code> on the next line ensures that we don’t keep those rows by always returning <code>FALSE</code>.</li>
</ul>
<div id="challenge5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4-using-case_when-with-mutate" class="callout-inner">
<h3 class="callout-title">Challenge 4: Using <code>case_when()</code> with <code>mutate()</code><a class="anchor" aria-label="anchor" href="#challenge5"></a>
</h3>
<div class="callout-content">
<p><code>case_when()</code> is also quite useful in combination with <code>mutate()</code>.</p>
<p>For example, let’s suppose you want to compare the mean relative humidity on about cloudy cold days and sunny hot days.</p>
<p>You can first use <code>mutate()</code> and <code>case_when()</code> to create a column that tells which of these categories the day belongs to (<code>hot_sunny</code>, <code>cold_cloudy</code>, or <code>neither</code>), and then use <code>group_by()</code> and <code>summarise()</code> to get the mean relative humidity at 9am and 3pm.</p>
<p>Write the code to compute this.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>day_type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&gt;</span> <span class="fl">25</span> <span class="op">~</span> <span class="st">"hot_sunny"</span>,</span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&lt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&lt;</span> <span class="fl">15</span> <span class="op">~</span> <span class="st">"cold_cloudy"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"neither"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">day_type</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_rel_humid_9am <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">rel_humid_9am_pc</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            mean_rel_humid_3pm <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">rel_humid_3pm_pc</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 3
  day_type  mean_rel_humid_9am mean_rel_humid_3pm
  &lt;chr&gt;                  &lt;dbl&gt;              &lt;dbl&gt;
1 hot_sunny               49.3               40.9
2 neither                 57.0               47.1</code></pre>
</div>
<p>Notice that we didn’t actually have any cold cloudy days, but hot sunny days seem to be less humid.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="filter-within-groups-with-slice_xxx">Filter within groups with <code>slice_xxx()</code>
<a class="anchor" aria-label="anchor" href="#filter-within-groups-with-slice_xxx"></a>
</h4>
<p>If you want to filter within groups, you could use <code>filter()</code> and <code>group_by()</code> together - for example if we wanted to know what the hottest day in each city was, you might try this:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">max_temp_c</span> <span class="op">==</span> <span class="fu">max</span><span class="op">(</span><span class="va">max_temp_c</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co"># A tibble: 0 × 23</span></span>
<span><span class="co"># Groups:   city [0]</span></span>
<span><span class="co"># … with 23 variables: file &lt;chr&gt;, date &lt;date&gt;, min_temp_c &lt;dbl&gt;,</span></span>
<span><span class="co">#   max_temp_c &lt;dbl&gt;, rainfall_mm &lt;dbl&gt;, evaporation_mm &lt;dbl&gt;,</span></span>
<span><span class="co">#   sunshine_hours &lt;dbl&gt;, dir_max_wind_gust &lt;chr&gt;,</span></span>
<span><span class="co">#   speed_max_wind_gust_kph &lt;dbl&gt;, time_max_wind_gust &lt;time&gt;, temp_9am_c &lt;dbl&gt;,</span></span>
<span><span class="co">#   rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,</span></span>
<span><span class="co">#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,</span></span>
<span><span class="co">#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;, …</span></span></code></pre>
</div>
<p>But it doesn’t work! The reasons why are somewhat technical, so here I’ll sidestep them and just give you the solution instead: use <code>slice_max()</code></p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice_max</span><span class="op">(</span>order_by<span class="op">=</span><span class="va">max_temp_c</span>, n<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 23
# Groups:   city [2]
  file        date       min_t…¹ max_t…² rainf…³ evapo…⁴ sunsh…⁵ dir_m…⁶ speed…⁷
  &lt;chr&gt;       &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
1 https://ra… 2022-11-20    20.8    34.5     0       8.8     5.7 NW           48
2 https://ra… 2022-11-12    16      27.9     0       7.8     9.5 ESE          26
3 https://ra… 2022-11-14    18.1    27.9    37.6     4.2    10.8 W            67
# … with 14 more variables: time_max_wind_gust &lt;time&gt;, temp_9am_c &lt;dbl&gt;,
#   rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, city &lt;chr&gt;, and
#   abbreviated variable names ¹​min_temp_c, ²​max_temp_c, ³​rainfall_mm, …</code></pre>
</div>
<p>If you want the minimum values instead, use <code>slice_min()</code> and if you want a random sample, use <code>slice_sample()</code>.</p>
<div id="challenge6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5-hottest-days" class="callout-inner">
<h3 class="callout-title">Challenge 5: Hottest days<a class="anchor" aria-label="anchor" href="#challenge6"></a>
</h3>
<div class="callout-content">
<p>What is the mean maximum temperature on the 5 hottest days in each city?</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># use with_ties to ensure we only get five rows</span></span>
<span>  <span class="fu">slice_max</span><span class="op">(</span>order_by<span class="op">=</span><span class="va">max_temp_c</span>, n<span class="op">=</span><span class="fl">5</span>, with_ties <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">max_temp_c</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 2
  city     mean_temp
  &lt;chr&gt;        &lt;dbl&gt;
1 brisbane      32.2
2 sydney        26.7</code></pre>
</div>
<p>Ooof, Brisbane was hot! Maybe this changes your conclusion about which city is better.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="selecting-columns-with-select">Selecting columns with <code>select()</code>
<a class="anchor" aria-label="anchor" href="#selecting-columns-with-select"></a>
</h3>
<p>If you want to drop or only retain columns from your table, use <code>select()</code>.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/dplyr_select.png" alt="" class="figure mx-auto d-block"><figcaption><code>dplyr::select()</code> <a href="https://ab604.github.io/docs/coding-together-2019" class="external-link">image credit</a></figcaption></figure><p>For example, we added a <code>city</code> column to our table, so we can drop the <code>file</code> column that also contains this information.</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">file</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 22
   date       min_temp_c max_t…¹ rainf…² evapo…³ sunsh…⁴ dir_m…⁵ speed…⁶ time_…⁷
   &lt;date&gt;          &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;time&gt; 
 1 2022-11-01       18.2    24       0.2     4.6     9.5 WNW          69 06:50  
 2 2022-11-02       11.1    20.5     0.6    13      12.8 W            67 12:54  
 3 2022-11-03       11.1    22       0       7.8     8.9 W            56 07:41  
 4 2022-11-04       13.4    23.1     1       6       5.7 SSE          26 23:24  
 5 2022-11-05       13.4    23.6     0.2     4.4    11.8 ENE          37 15:20  
 6 2022-11-06       13.3    24       0       4      12.1 ENE          39 16:12  
 7 2022-11-07       15.4    24.2     0       9.8    12.3 NE           41 11:44  
 8 2022-11-08       16      24.2     1.2     8      11   ENE          35 15:55  
 9 2022-11-09       14.9    24.2     0.2     8      10.3 E            33 12:37  
10 2022-11-10       14.9    24.4     0       7.8     9.3 ENE          43 17:10  
# … with 33 more rows, 13 more variables: temp_9am_c &lt;dbl&gt;,
#   rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, city &lt;chr&gt;, and
#   abbreviated variable names ¹​max_temp_c, ²​rainfall_mm, ³​evaporation_mm, …</code></pre>
</div>
<p>Alternatively, if we only wanted to keep the date, city and the 3pm observations, we can do this as well.</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">date</span>, <span class="va">city</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"3pm"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 8
   date       city   temp_3pm_c rel_humid_3pm_pc cloud…¹ wind_…² wind_…³ MSL_p…⁴
   &lt;date&gt;     &lt;chr&gt;       &lt;dbl&gt;            &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 2022-11-01 sydney       23.1               30       2 WNW          31    992 
 2 2022-11-02 sydney       19.7               29       1 SW           22   1006.
 3 2022-11-03 sydney       20                 42       7 SE           20   1017.
 4 2022-11-04 sydney       22.8               55       5 ENE          17   1027.
 5 2022-11-05 sydney       22.2               60       2 ENE          24   1027.
 6 2022-11-06 sydney       23.1               59       1 E            26   1023.
 7 2022-11-07 sydney       23.4               58       2 ENE          24   1021.
 8 2022-11-08 sydney       24                 59       2 ENE          24   1020.
 9 2022-11-09 sydney       23.6               46       1 ENE          26   1022.
10 2022-11-10 sydney       24.1               55       1 ENE          24   1019.
# … with 33 more rows, and abbreviated variable names ¹​cloud_amount_3pm_oktas,
#   ²​wind_direction_3pm, ³​wind_speed_3pm_kph, ⁴​MSL_pressure_3pm_hPa</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="sorting-rows-with-arrange">Sorting rows with <code>arrange()</code>
<a class="anchor" aria-label="anchor" href="#sorting-rows-with-arrange"></a>
</h3>
<p>You can re-order the rows in a table by the values in one or more columns using <code>arrange()</code>.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/dplyr_arrange.png" alt="dplyr::arrange() image credit" class="figure mx-auto d-block"> Here I sort for the hottest days, using <code>desc()</code> to get the maximum temperatures in descending order.</figure><div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">max_temp_c</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 23
   file       date       min_t…¹ max_t…² rainf…³ evapo…⁴ sunsh…⁵ dir_m…⁶ speed…⁷
   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 https://r… 2022-11-20    20.8    34.5     0       8.8     5.7 NW           48
 2 https://r… 2022-11-21    21.2    34.3     6.6    10.4    10.9 WNW          33
 3 https://r… 2022-11-15    20      33.3     0       5.6    12.9 WNW          30
 4 https://r… 2022-11-16    16.6    30.1     0       8.2    12.5 WSW          43
 5 https://r… 2022-11-14    20.6    28.8     0       9.8     8.4 ENE          26
 6 https://r… 2022-11-12    15.8    28.4     0       7.4    10.5 NE           26
 7 https://r… 2022-11-19    15.1    28.3     0       8      12.5 NNE          35
 8 https://r… 2022-11-12    16      27.9     0       7.8     9.5 ESE          26
 9 https://r… 2022-11-14    18.1    27.9    37.6     4.2    10.8 W            67
10 https://r… 2022-11-13    17.6    27.7     0       7.2    12.4 NNE          33
# … with 33 more rows, 14 more variables: time_max_wind_gust &lt;time&gt;,
#   temp_9am_c &lt;dbl&gt;, rel_humid_9am_pc &lt;int&gt;, cloud_amount_9am_oktas &lt;dbl&gt;,
#   wind_direction_9am &lt;chr&gt;, wind_speed_9am_kph &lt;dbl&gt;,
#   MSL_pressure_9am_hPa &lt;dbl&gt;, temp_3pm_c &lt;dbl&gt;, rel_humid_3pm_pc &lt;dbl&gt;,
#   cloud_amount_3pm_oktas &lt;dbl&gt;, wind_direction_3pm &lt;chr&gt;,
#   wind_speed_3pm_kph &lt;dbl&gt;, MSL_pressure_3pm_hPa &lt;dbl&gt;, city &lt;chr&gt;, and
#   abbreviated variable names ¹​min_temp_c, ²​max_temp_c, ³​rainfall_mm, …</code></pre>
</div>
<div id="challenge7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6-using-arrange-with-mutate" class="callout-inner">
<h3 class="callout-title">Challenge 6: Using <code>arrange()</code> with <code>mutate()</code><a class="anchor" aria-label="anchor" href="#challenge7"></a>
</h3>
<div class="callout-content">
<p>Sometimes I use <code>arrange()</code> with <code>mutate()</code> and <code>row_number()</code> to add ranks to a table.</p>
<p>Add a column ranking the days by minimum temperature for each city, where the coldest day for each is rank 1, the next coldest is rank 2, etc.</p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>rank <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># select only the relevant columns to verify that it worked</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">min_temp_c</span>, <span class="va">rank</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 4
# Groups:   city [2]
   city     date       min_temp_c  rank
   &lt;chr&gt;    &lt;date&gt;          &lt;dbl&gt; &lt;int&gt;
 1 sydney   2022-11-17       10       1
 2 sydney   2022-11-02       11.1     2
 3 sydney   2022-11-03       11.1     3
 4 sydney   2022-11-22       11.7     4
 5 sydney   2022-11-18       12.4     5
 6 brisbane 2022-11-03       12.8     1
 7 sydney   2022-11-19       12.9     6
 8 sydney   2022-11-16       13       7
 9 sydney   2022-11-06       13.3     8
10 sydney   2022-11-04       13.4     9
# … with 33 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="joining-data-frames">Joining data frames<a class="anchor" aria-label="anchor" href="#joining-data-frames"></a>
</h3>
<p>So far, we’ve only dealt with methods that work on one data frame. Sometimes it’s useful to combine information from two tables together to get a more complete picture of the data.</p>
<p>There are several joining functions, which fall into two categories:</p>
<ul>
<li>
<a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">mutating joins</a>, which add extra columns to tables based on matching values</li>
<li>
<a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">filtering joins</a>, which don’t add extra columns but change the number of rows</li>
</ul>
<p>Here, I’ll only cover the join I use the most, <code>left_join()</code>, but there are several joins of each type, which I will leave to you to explore more using the links above.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/left_join.png" alt="" class="figure mx-auto d-block"><figcaption>left join</figcaption></figure><p>Let’s say we have a second table which contains the forecast for each day. Here I generate this randomly, but you could equally use <code>readr</code> or <code>readxl</code> to load this data in if you have it in a file.</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecast</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">date</span>, <span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>forecast <span class="op">=</span> <span class="fu">sample</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"cloudy"</span>, <span class="st">"sunny"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 3
   date       city   forecast
   &lt;date&gt;     &lt;chr&gt;  &lt;chr&gt;   
 1 2022-11-01 sydney cloudy  
 2 2022-11-02 sydney cloudy  
 3 2022-11-03 sydney cloudy  
 4 2022-11-04 sydney sunny   
 5 2022-11-05 sydney sunny   
 6 2022-11-06 sydney sunny   
 7 2022-11-07 sydney sunny   
 8 2022-11-08 sydney cloudy  
 9 2022-11-09 sydney sunny   
10 2022-11-10 sydney cloudy  
# … with 33 more rows</code></pre>
</div>
<p>Now we would like to join this to our data frame of observations, so we can compare the forecast to what actually happened.</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">forecast</span>, by<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"city"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">sunshine_hours</span>, <span class="va">forecast</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 43 × 4
   city   date       sunshine_hours forecast
   &lt;chr&gt;  &lt;date&gt;              &lt;dbl&gt; &lt;chr&gt;   
 1 sydney 2022-11-01            9.5 cloudy  
 2 sydney 2022-11-02           12.8 cloudy  
 3 sydney 2022-11-03            8.9 cloudy  
 4 sydney 2022-11-04            5.7 sunny   
 5 sydney 2022-11-05           11.8 sunny   
 6 sydney 2022-11-06           12.1 sunny   
 7 sydney 2022-11-07           12.3 sunny   
 8 sydney 2022-11-08           11   cloudy  
 9 sydney 2022-11-09           10.3 sunny   
10 sydney 2022-11-10            9.3 cloudy  
# … with 33 more rows</code></pre>
</div>
<div id="challenge8" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-7-blame-it-on-the-weatherman" class="callout-inner">
<h3 class="callout-title">Challenge 7: <a href="https://www.youtube.com/watch?v=t2UFV2R3EZM" class="external-link">Blame it on the weatherman</a><a class="anchor" aria-label="anchor" href="#challenge8"></a>
</h3>
<div class="callout-content">
<p>If a cloudy day is one where there are 10 or fewer hours of sunshine, on how many days was the forecast accurate?</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># join forecast information</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">forecast</span>, by<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"city"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># was forecast accurate</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>forecast_accurate <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">forecast</span> <span class="op">==</span> <span class="st">"sunny"</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&lt;=</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">forecast</span> <span class="op">==</span> <span class="st">"cloudy"</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># count accurate and inaccurate forecasts</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">forecast_accurate</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 2
  forecast_accurate count
  &lt;lgl&gt;             &lt;int&gt;
1 FALSE                23
2 TRUE                 20</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="resources-and-acknowlegements"><h2 class="section-heading">Resources and acknowlegements<a class="anchor" aria-label="anchor" href="#resources-and-acknowlegements"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-transformation.pdf" class="external-link">dplyr cheatsheet</a></li>
<li><a href="https://dplyr.tidyverse.org/" class="external-link">dplyr documentation</a></li>
<li><a href="https://r4ds.had.co.nz/transform.html" class="external-link">Data transformation in R for data science</a></li>
<li>I’ve borrowed figures (and inspiration) from the excellent <a href="https://ab604.github.io/docs/coding-together-2019/data-wrangle-1.html" class="external-link">coding togetheR course material</a>
</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>summarise()</code> to summarise your data</li>
<li>Use <code>mutate()</code> to add new columns</li>
<li>Use <code>filter()</code> to filter rows by a condition</li>
<li>Use <code>select()</code> to remove or only retain certain rows</li>
<li>Use <code>arrange()</code> to re-order rows</li>
<li>Use <code>group_by()</code> to group data by the values in particular columns</li>
<li>Use joins to combine two data frames</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-visualizing-data"><p>Content from <a href="visualizing-data.html">Data visualization</a></p>
<hr>
<p> Last updated on 2022-11-26 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/visualizing-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you visualize data using <code>ggplot2</code>?</li>
<li>How can you combine individual plots?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to use aesthetics to create plots</li>
<li>Use geoms to create visualizations</li>
<li>Know how to facet to split by grouping variables</li>
<li>Modify visual elements using themes</li>
<li>Combine plots using <code>patchwork</code>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>After all of that data manipulation perhaps you, like me, are a bit sick of looking at tables. Using visualizations is essential for communicating your results, because <a href="https://ab604.github.io/docs/coding-together-2019/viz.html" class="external-link">summary statistics can be misleading</a>, and because large datasets don’t display well in tables.</p>
<p>I won’t go into too much theory here about the best way of visually representing different kinds of datasets, but I’d recommend everyone take a look at <a href="https://clauswilke.com/dataviz/" class="external-link">Claus Wilke’s excellent book ‘Fundamentals of data visualization’</a>.</p>
<p>One popular framework for generating plots is the <a href="http://vita.had.co.nz/papers/layered-grammar.pdf" class="external-link">‘grammar of graphics’ approach</a>. The idea here is to build up a graphic from multiple layers of components, including:</p>
<ul>
<li>data and aesthetic mappings</li>
<li>geometric objects</li>
<li>scales</li>
<li>facets</li>
</ul>
<p>In this lesson we explore how to use these elements to make informative and visually appealing graphs.</p>
<p>We’ll again use the weather data for Brisbane and Sydney, so let’s load this dataset.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load tidyverse</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.4.1 
✔ readr   2.1.3      ✔ forcats 0.5.2 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data files - readr can also read data from the internet</span></span>
<span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/szsctt/cmri_R_workshop/main/episodes/data/"</span></span>
<span><span class="va">data_files</span> <span class="op">&lt;-</span> <span class="fu">file.path</span><span class="op">(</span><span class="va">data_dir</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"weather_sydney.csv"</span>, <span class="st">"weather_brisbane.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># column types</span></span>
<span><span class="va">col_types</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="fu">col_date</span><span class="op">(</span>format<span class="op">=</span><span class="st">"%Y-%m-%d"</span><span class="op">)</span>,</span>
<span>  min_temp_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_temp_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rainfall_mm <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  evaporation_mm <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  sunshine_hours <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dir_max_wind_gust <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  speed_max_wind_gust_kph <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  time_max_wind_gust <span class="op">=</span> <span class="fu">col_time</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  temp_9am_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rel_humid_9am_pc <span class="op">=</span> <span class="fu">col_integer</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cloud_amount_9am_oktas <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_direction_9am <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_speed_9am_kph <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  MSL_pressure_9am_hPa <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  temp_3pm_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rel_humid_3pm_pc <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cloud_amount_3pm_oktas <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_direction_3pm <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_speed_3pm_kph <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  MSL_pressure_3pm_hPa <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read in data</span></span>
<span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_csv</span><span class="op">(</span><span class="va">data_files</span>, skip<span class="op">=</span><span class="fl">10</span>, </span>
<span>                           col_types<span class="op">=</span><span class="va">col_types</span>, col_names <span class="op">=</span> <span class="fu">names</span><span class="op">(</span><span class="va">col_types</span><span class="op">)</span>,</span>
<span>                           id<span class="op">=</span><span class="st">"file"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>city <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_extract</span><span class="op">(</span><span class="va">file</span>, <span class="st">"brisbane|sydney"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">weather</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 43
Columns: 22
$ date                    &lt;date&gt; 2022-11-01, 2022-11-02, 2022-11-03, 2022-11-0…
$ min_temp_c              &lt;dbl&gt; 18.2, 11.1, 11.1, 13.4, 13.4, 13.3, 15.4, 16.0…
$ max_temp_c              &lt;dbl&gt; 24.0, 20.5, 22.0, 23.1, 23.6, 24.0, 24.2, 24.2…
$ rainfall_mm             &lt;dbl&gt; 0.2, 0.6, 0.0, 1.0, 0.2, 0.0, 0.0, 1.2, 0.2, 0…
$ evaporation_mm          &lt;dbl&gt; 4.6, 13.0, 7.8, 6.0, 4.4, 4.0, 9.8, 8.0, 8.0, …
$ sunshine_hours          &lt;dbl&gt; 9.5, 12.8, 8.9, 5.7, 11.8, 12.1, 12.3, 11.0, 1…
$ dir_max_wind_gust       &lt;chr&gt; "WNW", "W", "W", "SSE", "ENE", "ENE", "NE", "E…
$ speed_max_wind_gust_kph &lt;dbl&gt; 69, 67, 56, 26, 37, 39, 41, 35, 33, 43, 39, 26…
$ time_max_wind_gust      &lt;time&gt; 06:50:00, 12:54:00, 07:41:00, 23:24:00, 15:20…
$ temp_9am_c              &lt;dbl&gt; 19.2, 14.0, 15.9, 15.8, 17.7, 19.0, 20.4, 21.1…
$ rel_humid_9am_pc        &lt;int&gt; 45, 44, 50, 82, 76, 75, 80, 67, 77, 76, 60, 77…
$ cloud_amount_9am_oktas  &lt;dbl&gt; 2, 1, 1, 6, 3, 1, 5, 4, 7, 7, 4, 1, 8, 1, 2, 2…
$ wind_direction_9am      &lt;chr&gt; "WNW", "W", "WSW", "E", "WSW", "ESE", "E", "EN…
$ wind_speed_9am_kph      &lt;dbl&gt; 35, 31, 31, 6, 4, 6, 15, 15, 6, 7, 7, 4, 2, 11…
$ MSL_pressure_9am_hPa    &lt;dbl&gt; 992.9, 1003.2, 1014.7, 1026.9, 1029.7, 1026.6,…
$ temp_3pm_c              &lt;dbl&gt; 23.1, 19.7, 20.0, 22.8, 22.2, 23.1, 23.4, 24.0…
$ rel_humid_3pm_pc        &lt;dbl&gt; 30, 29, 42, 55, 60, 59, 58, 59, 46, 55, 56, 51…
$ cloud_amount_3pm_oktas  &lt;dbl&gt; 2, 1, 7, 5, 2, 1, 2, 2, 1, 1, 7, 3, 7, 2, 7, 7…
$ wind_direction_3pm      &lt;chr&gt; "WNW", "SW", "SE", "ENE", "ENE", "E", "ENE", "…
$ wind_speed_3pm_kph      &lt;dbl&gt; 31, 22, 20, 17, 24, 26, 24, 24, 26, 24, 17, 19…
$ MSL_pressure_3pm_hPa    &lt;dbl&gt; 992.0, 1005.9, 1016.6, 1026.8, 1026.9, 1023.3,…
$ city                    &lt;chr&gt; "sydney", "sydney", "sydney", "sydney", "sydne…</code></pre>
</div>
<section id="data-and-aesthetic-mappings"><h2 class="section-heading">Data and aesthetic mappings<a class="anchor" aria-label="anchor" href="#data-and-aesthetic-mappings"></a>
</h2>
<hr class="half-width">
<p>Any graph has to start with a dataset - and in the case of <code>ggplot</code>, this has to be a data frame (or tibble). We also start by specifying the aesthetic using <code>aes()</code>, which tells ggplot which columns should go on the x and y axes.</p>
<p>Let’s say that we want to plot the daily maximum temperature over the month for both cities. You can pipe the data into <code>ggplot()</code>.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">max_temp_c</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>But we just get a blank graph! We have to tell ggplot how we want the data to be plotted (lines, points, violins, density, etc).</p>
</section><section id="geoms"><h2 class="section-heading">geoms<a class="anchor" aria-label="anchor" href="#geoms"></a>
</h2>
<hr class="half-width">
<p>We use <code>geoms</code> to tell ggplot how we want to plot the data. In this case, we can use points:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">max_temp_c</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing missing values (`geom_point()`).</code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that we use a <code>+</code> to add layers to a ggplot, not the pipe (<code>%&gt;%</code>). The <code>ggplot2</code> package was developed before the <code>magrittr</code> package that contains <code>%&gt;%</code>, so it uses the addition operator instead.</p>
<p><code>ggplot</code> doesn’t know how to plot missing values, so it removes those rows and warns you that it’s doing so. Those warnings about missing values are going to get annoying, so I use a <code>tidyr</code> function to remove rows with <code>NA</code> in any column.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># everything() means do this on all columns</span></span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>There are a large number of <code>geoms</code> for displaying data in different ways - we will explore some here, but you can find more in the <a href="https://ggplot2.tidyverse.org/" class="external-link"><code>ggplot</code> documentation</a>.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-wind-speed" class="callout-inner">
<h3 class="callout-title">Challenge 1: Wind speed<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>Using <code>geom_freqpoly()</code>, make frequency polynomials of the speed of the maximum wind gust on each day for each city, using 10 bins (you might need to check the documentation).</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">speed_max_wind_gust_kph</span>, color<span class="op">=</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_freqpoly</span><span class="op">(</span>bins<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="layering-geoms">Layering geoms<a class="anchor" aria-label="anchor" href="#layering-geoms"></a>
</h3>
<p>Our initial graph looks OK, but we might want to know which temperature belongs to which city. Let’s add some color to the aesthetic so we can compare the temperatures, as well as some lines to make it easier to see the change in temperature over time.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot temp over time with lines and points</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">max_temp_c</span>, color<span class="op">=</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>If we didn’t care about the time aspect and just wanted to compare the distribution of temperatures instead, we could plot city on the x axis, temperature on the y axis. To avoid points being on top of each other when the temperature is the same , I use <code>geom_jitter()</code> instead of <code>geom_point()</code>, which adds random jitter to each point before plotting.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show differences between temps in Brisbane and Sydney</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">city</span>, y<span class="op">=</span><span class="va">max_temp_c</span>, color<span class="op">=</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>height<span class="op">=</span><span class="fl">0</span>, width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Notice that the <code>geoms</code> can also take arguments - for example, I’ve used <code>geom_jitter(height=0, width=0.1</code> to control the amount of jitter added to each point (none in the y direction, a little bit in the x direction).</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-density-and-rug" class="callout-inner">
<h3 class="callout-title">Challenge 2: Density and rug<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>Use <code>geom_density()</code> and <code>geom_rug()</code> to show the difference in maximum temperatures between Brisbane and Sydney (with different colors for the two cities).</p>
<p>Do you prefer this representation to the violin plot above?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">max_temp_c</span>, color<span class="op">=</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_rug</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-8-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="summary-statistics">Summary statistics<a class="anchor" aria-label="anchor" href="#summary-statistics"></a>
</h3>
<p>Also notice that <code>ggplot</code> automatically calculates the density for us when it plots the violins. There are a number of other statistical transformations that <code>ggplot</code> can calculate for us. For example, we can plot the proportion of wind directions at 9am for each city:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># count number of observation of each direction in each city</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span>, <span class="va">wind_direction_9am</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># make plot</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">city</span>, y <span class="op">=</span> <span class="va">count</span>, fill<span class="op">=</span><span class="va">wind_direction_9am</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position<span class="op">=</span><span class="st">"fill"</span>, stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'city'. You can override using the
`.groups` argument.</code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Notice that although we summarized the <em>count</em> of observations of each direction (i.e. number of days), ggplot plots the <em>proportion</em> of observations.</p>
</div>
<div class="section level3">
<h3 id="using-multiple-datasets">Using multiple datasets<a class="anchor" aria-label="anchor" href="#using-multiple-datasets"></a>
</h3>
<p>You can also use independent data and aesthetics for different <code>geoms</code>. For example, returning to our plot of temperature over time, we could add a horizontal line for each city to show the mean temperature.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get mean temp for each city</span></span>
<span><span class="va">mean_temps</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">max_temp_c</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make plot</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">max_temp_c</span>, color<span class="op">=</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># data and aesthetics are inherited from ggplot call</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add horizontal line with different data and aesthetic</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_temps</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>yintercept<span class="op">=</span><span class="va">mean_temp</span>, color<span class="op">=</span><span class="va">city</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="non-gglot-geoms">Non-gglot geoms<a class="anchor" aria-label="anchor" href="#non-gglot-geoms"></a>
</h3>
<p>With the popularity of <code>ggplot2</code>, there are a number of other packages that provide <code>geoms</code> that you can use in your <code>ggplot</code>.</p>
<p>I won’t go into any detail about these, but a few that I’ve used include <code>ggforce::geom_sina()</code>, <code>ggbeeswarm::geom_beeswarm()</code> and <code>ggwordcloud::geom_wordcloud()</code>. If you want to make a particular kind of graph, somebody has probably made a <code>geom</code> for it.</p>
</div>
</section><section id="facets"><h2 class="section-heading">Facets<a class="anchor" aria-label="anchor" href="#facets"></a>
</h2>
<hr class="half-width">
<p>Let’ say we want to compare the minimum and maximum temperatures for the two cities over time. We could make a plot with time on the x axis and temperature on the y axis, where the shape of the point indicates the city and the color indicates whether the temperature was minimum or maximum.</p>
<p>However, currently our temperature data is spread out over two columns: <code>mean_temp_c</code> and <code>max_temp_c</code>, but in <code>ggplot</code> we need to assign the color using <code>color=temp_type</code>. So in order to make this plot, we need to rearrange the data a little using <code>dplyr</code> functions.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pivot longer to facilitate plotting</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">max_temp_c</span>, <span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"temp_type"</span>, values_to<span class="op">=</span><span class="st">"temp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># compare minimum and maximum temps in two cities</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">temp</span>, shape<span class="op">=</span><span class="va">city</span>, color<span class="op">=</span><span class="va">temp_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This works, but it’s a little difficult to tell the circles and the triangles apart. Instead, we can use facets to plot the data from each city side by side.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pivot longer</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">max_temp_c</span>, <span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"temp_type"</span>, values_to<span class="op">=</span><span class="st">"temp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># compare minimum and maximum temps in two cities</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">temp</span>, color<span class="op">=</span><span class="va">temp_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet on city</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">city</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>You can facet on multiple variables, for example:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pivot longer</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">max_temp_c</span>, <span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"temp_type"</span>, values_to<span class="op">=</span><span class="st">"temp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># compare minimum and maximum temps in two cities</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">temp</span>, color<span class="op">=</span><span class="va">temp_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet on city</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span>cols<span class="op">=</span><span class="fu">vars</span><span class="op">(</span><span class="va">city</span><span class="op">)</span>, rows<span class="op">=</span><span class="fu">vars</span><span class="op">(</span><span class="va">temp_type</span><span class="op">)</span>, scales<span class="op">=</span><span class="st">"free_y"</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-13-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <code>scales="free_y"</code> argument allows the y-axis scales on each row to be different.</p>
<p>In this case I think the comparison is clearer without the extra faceting variable. Don’t go too crazy with your faceting, but instead think about what story you are trying to tell.</p>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-facets" class="callout-inner">
<h3 class="callout-title">Challenge 3: Facets<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>Use facets to show the difference in wind speeds by direction in each city. Facet on city, and color the density for wind speed (<code>speed_max_wind_gust_kph</code>) by direction (<code>dir_max_wind_gust</code>). Show each city in a different row, with different y axes.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">speed_max_wind_gust_kph</span>, color<span class="op">=</span><span class="va">dir_max_wind_gust</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span>rows <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">city</span><span class="op">)</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Groups with fewer than two data points have been dropped.
Groups with fewer than two data points have been dropped.
Groups with fewer than two data points have been dropped.
Groups with fewer than two data points have been dropped.
Groups with fewer than two data points have been dropped.
Groups with fewer than two data points have been dropped.
Groups with fewer than two data points have been dropped.
Groups with fewer than two data points have been dropped.
Groups with fewer than two data points have been dropped.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf

Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf

Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf

Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf

Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf

Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf

Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf

Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf

Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf</code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-14-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This is not a particularly informative graphs because there are so few points for each direction.</p>
</div>
</div>
</div>
</div>
</section><section id="visual-customization-labels-themes-and-scales"><h2 class="section-heading">Visual customization: Labels, themes and scales<a class="anchor" aria-label="anchor" href="#visual-customization-labels-themes-and-scales"></a>
</h2>
<hr class="half-width">
<p>There are a number of other customization that you can use to display your data more clearly.</p>
<div class="section level3">
<h3 id="axes-labels">Axes labels<a class="anchor" aria-label="anchor" href="#axes-labels"></a>
</h3>
<p>It’s important to always label your x and y axes - <code>ggplot</code> does this for you using the column names, but usually the column names are short for ease of coding but you want your labels to be more informative/pretty.</p>
<p>Use the <code>labs()</code> function to add labels, and <code>scale_color_discrete()</code> to change the title and label for the legend.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pivot longer</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">max_temp_c</span>, <span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"temp_type"</span>, values_to<span class="op">=</span><span class="st">"temp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># compare minimum and maximum temps in two cities</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">temp</span>, color<span class="op">=</span><span class="va">temp_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet on city</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add label</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Temperature (°C)"</span>, title <span class="op">=</span> <span class="st">"November temperatures"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change legend</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Type"</span>, labels<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"min"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that when changing the legend, you have to match the function to the aesthetic. So <code>scale_color_disrete()</code> acts on a discrete color scale, <code>scale_color_continuous()</code> acts on a continuous color scale, <code>scale_fill_discrete()</code> acts on a discrete fill scale, etc.</p>
<p>If you’re trying to change a legend but it doesn’t seem to be working, check that you used the correct function for your data type and aesthetic!</p>
</div>
<div class="section level3">
<h3 id="scales">Scales<a class="anchor" aria-label="anchor" href="#scales"></a>
</h3>
<p>We used <code>scale_color_disrete()</code> to change the labels in the legend earlier, but there are a number of scale functions in <code>ggplot2</code> that can be used to change many other aspects of graphs.</p>
<div class="section level4">
<h4 id="color-scales">Color scales<a class="anchor" aria-label="anchor" href="#color-scales"></a>
</h4>
<p>If you are unhappy with the default color scale that <code>ggplot</code> provides, you can change it using an appropriate scaling function - for example, <code>scale_color_discrete()</code> for discrete color scales, <code>scale_fill_continuous</code> for continuous fill scales, etc.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pivot longer</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">max_temp_c</span>, <span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"temp_type"</span>, values_to<span class="op">=</span><span class="st">"temp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># compare minimum and maximum temps in two cities</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">temp</span>, color<span class="op">=</span><span class="va">temp_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet on city</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add label</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Temperature (°C)"</span>, title <span class="op">=</span> <span class="st">"November temperatures"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change color scale</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>type<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Type"</span>, labels<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"min"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>There are a number of different ways you can specify colors to use. One is to use color names, as above, although this requires you to know what the allowed color names are. I tend to use <a href="https://r-graph-gallery.com/42-colors-names.html" class="external-link">this list of color names for R</a>.</p>
<p>Another is to use a package to generate color names for you. For example, I tend to use <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html" class="external-link"><code>virids</code></a> for continuous scales because it’s colorblind-friendly. Another favourite is <a href="https://github.com/karthik/wesanderson" class="external-link"><code>wesanderson</code></a>, which makes palettes from Wes Anderson movies.</p>
<p>Let’s say we now have exponentially distributed data. None of our weather data really is, so let’s simulate some by drawing from two different exponential distributions with different rates.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_data</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  <span class="co"># two groups</span></span>
<span>  group <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="st">"a"</span>, <span class="fl">50</span><span class="op">)</span>, </span>
<span>            <span class="fu">rep</span><span class="op">(</span><span class="st">"b"</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co"># rexp samples from exponential distribution</span></span>
<span>  freq <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rexp</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, rate<span class="op">=</span><span class="fl">500</span><span class="op">)</span>, </span>
<span>            <span class="fu">rexp</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, rate<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compare freq between groups</span></span>
<span><span class="va">exp_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">group</span>, y<span class="op">=</span><span class="va">freq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0</span>, width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This plot isn’t so nice because the two groups are on different scales. Changing the scale on your plot to logarithmic is easy with <code>ggplot</code>. Just add <code>scale_x_log10()</code>, <code>scale_y_log10()</code>, etc:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compare freq between groups on log scale</span></span>
<span><span class="va">exp_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">group</span>, y<span class="op">=</span><span class="va">freq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0</span>, width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-18-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
<div class="section level3">
<h3 id="themes">Themes<a class="anchor" aria-label="anchor" href="#themes"></a>
</h3>
<p><code>ggplot</code> also allows you to customize the appearance of the plot in other ways. Getting back to our weather example, if you wanted to remove the x axis labels because you decided that it’s already clear what is on that axis, you can do that with <code>theme()</code>.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pivot longer</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">max_temp_c</span>, <span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"temp_type"</span>, values_to<span class="op">=</span><span class="st">"temp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># plot lines and points</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">temp</span>, color<span class="op">=</span><span class="va">temp_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet on city</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add label</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Temperature (°C)"</span>, title <span class="op">=</span> <span class="st">"November temperatures"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change color scale</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>type<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Type"</span>, labels<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"min"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># remove x axis label</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-19-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>There are many aspects of the plot you can customize this way: check the <a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link"><code>ggplot2</code> documentation</a> for more information.</p>
<p>You can also change many aspects of the plot at once with pre-configured themes, for example <code>theme_classic()</code>.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pivot longer</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">max_temp_c</span>, <span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"temp_type"</span>, values_to<span class="op">=</span><span class="st">"temp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># plot lines and points</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">temp</span>, color<span class="op">=</span><span class="va">temp_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet on city</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add label</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Temperature (°C)"</span>, title <span class="op">=</span> <span class="st">"November temperatures"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change color scale</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>type<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Type"</span>, labels<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"min"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change to theme classic</span></span>
<span>  <span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># remove x axis label</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-20-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that we have to do this <strong>before</strong> we remove the x axis label, because in <code>theme_light()</code>, the <code>axis.title.x</code> parameter is set to something other than <code>element_blank()</code>, so this would overwrite our call to <code>theme()</code>.</p>
<p>You can find out more about the other available themes <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html?q=complete%20themes" class="external-link">in the <code>ggplot2</code> documentation</a>.</p>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4-themes-and-colors" class="callout-inner">
<h3 class="callout-title">Challenge 4: Themes and colors<a class="anchor" aria-label="anchor" href="#challenge4"></a>
</h3>
<div class="callout-content">
<p>Make the same plot as above, but add a different theme from the <code>ggplot</code> documentation, and different colors for the minimum and maximum.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>This is open-ended, but one solution is:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pivot longer</span></span>
<span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">max_temp_c</span>, <span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"temp_type"</span>, values_to<span class="op">=</span><span class="st">"temp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># compare minimum and maximum temps in two cities</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">temp</span>, color<span class="op">=</span><span class="va">temp_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet on city</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add label</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Temperature (°C)"</span>, title <span class="op">=</span> <span class="st">"November temperatures"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change color scale</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>type<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"coral"</span>, <span class="st">"deepskyblue"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Type"</span>, labels<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"min"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># remove x axis label</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-21-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="axes-scales">Axes scales<a class="anchor" aria-label="anchor" href="#axes-scales"></a>
</h4>
</div>
</div>
</section><section id="saving-plots"><h2 class="section-heading">Saving plots<a class="anchor" aria-label="anchor" href="#saving-plots"></a>
</h2>
<hr class="half-width">
<p>Saving plots with <code>ggplot</code> is easy - just use <code>ggsave()</code>. This will either save the last plot you generated, or you can assign the plot to a variable and use that to tell the function while plot to save.</p>
<p>It works with a variety of formats - I usually use <code>.pdf</code> as a vector format (e.g. for publications) and <code>.png</code> as a raster format (e.g. for slides). The function will infer the format you want from the file name you provide. You can also specify the <code>width</code> and <code>height</code> of the output file (you’ll probably want <code>units="cm"</code>).</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assign the result to variable p</span></span>
<span> <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># pivot longer</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">max_temp_c</span>, <span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"temp_type"</span>, values_to<span class="op">=</span><span class="st">"temp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># plot lines and points</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">temp</span>, color<span class="op">=</span><span class="va">temp_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet on city</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add label</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Temperature (°C)"</span>, title <span class="op">=</span> <span class="st">"November temperatures"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change color scale</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>type<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Type"</span>, labels<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"min"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change to theme classic</span></span>
<span>  <span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># remove x axis label</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"my_great_plot.png"</span><span class="op">)</span>, plot<span class="op">=</span><span class="va">p</span>, height<span class="op">=</span><span class="fl">10</span>, width<span class="op">=</span><span class="fl">17</span>, units<span class="op">=</span><span class="st">"cm"</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="combining-plots-with-patchwork"><h2 class="section-heading">Combining plots with <code>patchwork</code><a class="anchor" aria-label="anchor" href="#combining-plots-with-patchwork"></a>
</h2>
<hr class="half-width">
<p>Making individual plots is well and good, but sometime it’s useful to combine them together to make a figure with multiple panels. Although it’s possible to do this with Illustrator, doing your whole figure generation process in R (or another language) will allow you to easily reproduce your figures (for example, when adding new data or for visual tweaks). To quote <a href="https://clauswilke.com/dataviz/preface.html" class="external-link">Claus Wilke</a></p>
<blockquote>
<p>I think figures should be autogenerated as part of the data analysis pipeline (which should also be automated), and they should come out of the pipeline ready to be sent to the printer, no manual post-processing needed. I see a lot of trainees autogenerate rough drafts of their figures, which they then import into Illustrator for sprucing up. There are several reasons why this is a bad idea. First, the moment you manually edit a figure, your final figure becomes irreproducible. A third party cannot generate the exact same figure you did. While this may not matter much if all you did was change the font of the axis labels, the lines are blurry, and it’s easy to cross over into territory where things are less clear cut. As an example, let’s say you want to manually replace cryptic labels with more readable ones. A third party may not be able to verify that the label replacement was appropriate. Second, if you add a lot of manual post-processing to your figure-preparation pipeline then you will be more reluctant to make any changes or redo your work. Thus, you may ignore reasonable requests for change made by collaborators or colleagues, or you may be tempted to re-use an old figure even though you actually regenerated all the data. These are not made-up examples. I’ve seen all of them play out with real people and real papers. Third, you may yourself forget what exactly you did to prepare a given figure, or you may not be able to generate a future figure on new data that exactly visually matches your earlier figure.</p>
</blockquote>
<p>To combine plots together, I often use the <code>patchwork</code> package (although there are also good alternatives, such as <code>cowplot</code> for the aforementioned Claus Wilke). In this package, we can combine plots using the <code>+</code> and <code>/</code> operators.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import patchwork library</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">patchwork</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot max and min temperatures</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">max_temp_c</span>, <span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"temp_type"</span>, values_to<span class="op">=</span><span class="st">"temp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># compare minimum and maximum temps in two cities</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">temp</span>, color<span class="op">=</span><span class="va">temp_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># facet on city</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add label</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Temperature (°C)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change color scale</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Type"</span>, labels<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"min"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot wind directions</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># count number of observation of each direction in each city</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span>, <span class="va">wind_direction_9am</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, .groups<span class="op">=</span><span class="st">"drop"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># make plot</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">city</span>, y <span class="op">=</span> <span class="va">count</span>, fill<span class="op">=</span><span class="va">wind_direction_9am</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position<span class="op">=</span><span class="st">"fill"</span>, stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># move legend to bottom</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># axis labels</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"City"</span>, y<span class="op">=</span><span class="st">"Proportion"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot temperatures</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">#  compare max temps between cities</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">city</span>, y<span class="op">=</span><span class="va">max_temp_c</span>, color<span class="op">=</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>height<span class="op">=</span><span class="fl">0</span>, width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># change colors to avoid confusion with p1</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>type<span class="op">=</span><span class="fu">wesanderson</span><span class="fu">::</span><span class="fu">wes_palette</span><span class="op">(</span><span class="st">"GrandBudapest1"</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># axis labels</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"City"</span>, y<span class="op">=</span><span class="st">"Max. temperature (°C)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_plot</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="op">(</span><span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span><span class="op">)</span></span>
<span><span class="va">combined_plot</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-23-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Patchwork also <a href="https://patchwork.data-imaginist.com/articles/guides/annotation.html" class="external-link">allows you to add annotation</a> to your combined plot, for example labels ‘A’, ‘B’, ‘C’.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_plot</span> <span class="op">+</span></span>
<span>  <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/visualizing-data-rendered-unnamed-chunk-24-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>There are many more features of <code>patchwork</code> which I will leave you to explore - the documentation is linked in the resources section. For example, <code>patchwork</code> will combine things other than <code>ggplot</code>s if you can convert them to a form that it understands using <code>ggplotify::as_ggplot()</code>.</p>
</section><section id="resources"><h2 class="section-heading">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<hr class="half-width">
<ul>
<li>
<a href="https://clauswilke.com/dataviz/" class="external-link">Fundamentals of data vizualization</a> by Claus Wilke</li>
<li><a href="https://ggplot2.tidyverse.org/index.html" class="external-link">ggplot documentation</a></li>
<li><a href="https://patchwork.data-imaginist.com/index.html" class="external-link">patchwork documentation</a></li>
<li><a href="https://github.com/karthik/wesanderson" class="external-link">wesanderson documentation</a></li>
<li><a href="https://cran.r-project.org/web/packages/ggplotify/vignettes/ggplotify.html" class="external-link">ggplotify documentation</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>ggplot()</code> to create a plot and specify the default dataset and aesthetic (<code>aes()</code>)</li>
<li>Use <code>geoms</code> to specify how the data should be displayed</li>
<li>Use <code>facet_wrap()</code> and <code>facet_grid()</code> to create facets</li>
<li>Use <code>scales</code> to change the scales in your plot</li>
<li>Use <code>theme()</code> and theme presets to modify plot appearance</li>
<li>Use <code>patchwork</code> or <code>cowplot</code> to combine plots into one figure</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-intro-bioconductor"><p>Content from <a href="intro-bioconductor.html">Bioconductor and other bioinformatics packages</a></p>
<hr>
<p> Last updated on 2022-11-26 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/intro-bioconductor.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is bioconductor?</li>
<li>What are some bioconductor packages?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Install bioconductor packages with <code>BiocManager</code>
</li>
<li>Be aware of some <code>Bioconductor packages</code>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<figure><img src="http://bioconductor.org/images/logo_bioconductor.gif" alt="" class="figure mx-auto d-block"><figcaption>Bioconductor logo</figcaption></figure><section id="introduction-to-bioconductor"><h2 class="section-heading">Introduction to Bioconductor<a class="anchor" aria-label="anchor" href="#introduction-to-bioconductor"></a>
</h2>
<hr class="half-width">
<p>We’ll quickly take a look at the<code>Bioconductor</code> ecosystem, a collection of <code>R</code> packages for bioinformatics. Usually these solve specific problems (like RNA-seq analysis or plotting genomic data), so they won’t be as applicable to everyone here.</p>
<p>The goal of this lesson is therefore to let you know about some packages from <code>bioconductor</code> that I’ve found useful, but we won’t actually go into any detail about how to use them. All of the <code>Bioconductor</code> packages have vignettes that will show you how to use the core functionality of the package.</p>
<div class="section level3">
<h3 id="installing-packages-with-biocmanager">Installing packages with <code>BiocManager</code>
<a class="anchor" aria-label="anchor" href="#installing-packages-with-biocmanager"></a>
</h3>
<p>While typically you’d use <code>install.packages()</code> to install <code>R</code> packages, <code>Bioconductor</code> has it’s own package manager. The package manager is called <a href="https://cran.r-project.org/web/packages/BiocManager/vignettes/BiocManager.html" class="external-link"><code>BiocManager</code></a>, and you can install it as you would any other package:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install BiocManager</span></span>
<span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span></code></pre>
</div>
<p>You can then use this package to install other <code>Bioconductor</code> packages, for example:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"DESeq2"</span><span class="op">)</span></span></code></pre>
</div>
<p><code>Bioconductor</code> also has it’s own release schedule, which are designed to work with particular versions of <code>R</code>.</p>
<p>At the time of writing, the <a href="https://bioconductor.org/install/" class="external-link">current version is 3.16</a>, which works with <code>R</code> version 4.2.0. If you have an older version of <code>R</code>, you will need to use an older version of <code>Bioconductor</code> as well - there’s <a href="https://bioconductor.org/about/release-announcements/" class="external-link">a list of the older releases on the Bioconductor website</a>. You can tell <code>BiocManager</code> which release to use:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span>version<span class="op">=</span><span class="st">"3.16"</span><span class="op">)</span></span></code></pre>
</div>
<p>This won’t actually install anything, but all future installs will use version 3.16.</p>
</div>
</section><section id="biostrings"><h2 class="section-heading">Biostrings<a class="anchor" aria-label="anchor" href="#biostrings"></a>
</h2>
<hr class="half-width">
<p>A common task (at least for me) is working with biological sequences (e.g. DNA, RNA, amino acid). A useful package for this is <a href="https://bioconductor.org/packages/release/bioc/html/Biostrings.html" class="external-link"><code>Biostrings</code></a>.</p>
<p>Install this package with the following code</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"Biostrings"</span><span class="op">)</span></span></code></pre>
</div>
<p>Biostrings contains useful variable and functions for working with sequences. For example, you can translate a nucleotide sequence:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load library</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">biostrings</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create DNAString object</span></span>
<span><span class="va">my_seq</span> <span class="op">&lt;-</span> <span class="fu">DNAString</span><span class="op">(</span><span class="st">"GTAAGTGTATGC"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># translate to amino acids</span></span>
<span><span class="fu">translate</span><span class="op">(</span><span class="va">my_seq</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>4-letter AAString object
seq: VSVC</code></pre>
</div>
<p>Or calculate the frequency of each nucleotide:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">alphabetFrequency</span><span class="op">(</span><span class="va">my_seq</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>A C G T M R W S Y K V H D B N - + . 
3 1 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 </code></pre>
</div>
<p>Or the codon frequencies</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trinucleotideFrequency</span><span class="op">(</span><span class="va">my_seq</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>AAA AAC AAG AAT ACA ACC ACG ACT AGA AGC AGG AGT ATA ATC ATG ATT CAA CAC CAG CAT 
  0   0   1   0   0   0   0   0   0   0   0   1   0   0   1   0   0   0   0   0 
CCA CCC CCG CCT CGA CGC CGG CGT CTA CTC CTG CTT GAA GAC GAG GAT GCA GCC GCG GCT 
  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 
GGA GGC GGG GGT GTA GTC GTG GTT TAA TAC TAG TAT TCA TCC TCG TCT TGA TGC TGG TGT 
  0   0   0   0   2   0   1   0   1   0   0   1   0   0   0   0   0   1   0   1 
TTA TTC TTG TTT 
  0   0   0   0 </code></pre>
</div>
<p>It also contains a codon table</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GENETIC_CODE</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>TTT TTC TTA TTG TCT TCC TCA TCG TAT TAC TAA TAG TGT TGC TGA TGG CTT CTC CTA CTG 
"F" "F" "L" "L" "S" "S" "S" "S" "Y" "Y" "*" "*" "C" "C" "*" "W" "L" "L" "L" "L" 
CCT CCC CCA CCG CAT CAC CAA CAG CGT CGC CGA CGG ATT ATC ATA ATG ACT ACC ACA ACG 
"P" "P" "P" "P" "H" "H" "Q" "Q" "R" "R" "R" "R" "I" "I" "I" "M" "T" "T" "T" "T" 
AAT AAC AAA AAG AGT AGC AGA AGG GTT GTC GTA GTG GCT GCC GCA GCG GAT GAC GAA GAG 
"N" "N" "K" "K" "S" "S" "R" "R" "V" "V" "V" "V" "A" "A" "A" "A" "D" "D" "E" "E" 
GGT GGC GGA GGG 
"G" "G" "G" "G" 
attr(,"alt_init_codons")
[1] "TTG" "CTG"</code></pre>
</div>
<p>It has many more features which you can explore if you need to use this package.</p>
</section><section id="plotting-genomic-information"><h2 class="section-heading">Plotting genomic information<a class="anchor" aria-label="anchor" href="#plotting-genomic-information"></a>
</h2>
<hr class="half-width">
<p>Another relatively common task for me is plotting genomic information. There are a number of ways to do this, but here I’ll just give one example - plotting the density of SNPs in the human albumin gene (ALB).</p>
<p>First, I grabbed the <a href="https://gnomad.broadinstitute.org/gene/ENSG00000163631?dataset=gnomad_r3" class="external-link">SNP information for this gene from <code>gnomAD</code></a> as a csv, and read in this information using <code>readr::read_csv()</code></p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load data</span></span>
<span><span class="va">alb</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"gnomAD_v3.1.2_ENSG00000163631_2022_11_25_11_56_32.csv"</span><span class="op">)</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>Next, we need to convert the SNP locations into a <code>GRanges</code> object - this is an object from the <code>GenomicRanges</code> package that is designed to store genomic coordinates and associated metadata. I won’t go into detail about this either, but you can find more information about this package <a href="https://bioconductor.org/packages/devel/bioc/vignettes/GenomicRanges/inst/doc/GenomicRangesIntroduction.html" class="external-link">in the documentation</a>.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for pipe</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">magrittr</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'magrittr'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:GenomicRanges':

    subtract</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alb_gr</span> <span class="op">&lt;-</span> <span class="va">alb</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># add "chr" to chromosome number</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>Chromosome <span class="op">=</span> <span class="fu">paste0</span><span class="op">(</span><span class="st">"chr"</span>, <span class="va">Chromosome</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># convert to GRanges object</span></span>
<span>  <span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu">makeGRangesFromDataFrame</span><span class="op">(</span></span>
<span>    seqnames.field<span class="op">=</span><span class="st">"Chromosome"</span>,</span>
<span>    start.field <span class="op">=</span> <span class="st">"Position"</span>,</span>
<span>    end.field<span class="op">=</span><span class="st">"Position"</span>,</span>
<span>    keep.extra.columns <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">alb_gr</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>GRanges object with 850 ranges and 0 metadata columns:
        seqnames    ranges strand
           &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;
    [1]     chr4  73397115      *
    [2]     chr4  73397120      *
    [3]     chr4  73397122      *
    [4]     chr4  73397122      *
    [5]     chr4  73397123      *
    ...      ...       ...    ...
  [846]     chr4  73421175      *
  [847]     chr4  73421187      *
  [848]     chr4  73421188      *
  [849]     chr4  73421189      *
  [850]     chr4  73421193      *
  -------
  seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
</div>
<p>Now we have the data loaded, we’re ready to start making the plot.</p>
<div class="section level3">
<h3 id="karyoploter">KaryoploteR<a class="anchor" aria-label="anchor" href="#karyoploter"></a>
</h3>
<p>Here I’m more or less following part of the <a href="https://bernatgel.github.io/karyoploter_tutorial//Examples/EncodeEpigenetics/EncodeEpigenetics.html" class="external-link">karyploteR tutorial</a>.</p>
<p>This is human data, so we plot the albumin locus in the human genome. I used the <a href="https://genome.ucsc.edu/cgi-bin/hgTracks?db=hg38&amp;lastVirtModeType=default&amp;lastVirtModeExtraState=&amp;virtModeType=default&amp;virtMode=0&amp;nonVirtPosition=&amp;position=chr4%3A73402360%2D73423322&amp;hgsid=1504808111_WcWVaHMGon8yjsLsfnwXMp51XDT0" class="external-link">UCSC genome brower</a> to identify the coordinates for ALB (roughly chr4:73,394,000-73,425,000), but you could equally use <a href="https://asia.ensembl.org/Homo_sapiens/Gene/Summary?g=ENSG00000163631;r=4:73397114-73421482" class="external-link">Ensembl</a>.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">karyoploteR</span><span class="op">)</span></span>
<span><span class="co"># this package contains transcript information for the human genome</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg38.knownGene</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># region to plot</span></span>
<span><span class="va">region</span> <span class="op">&lt;-</span> <span class="st">"chr4:73,394,000-73,425,000"</span></span>
<span></span>
<span><span class="co"># transcript information</span></span>
<span><span class="va">genes.data</span> <span class="op">&lt;-</span> <span class="fu">makeGenesDataFromTxDb</span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg38.knownGene</span>,</span>
<span>                                    karyoplot<span class="op">=</span><span class="va">kp</span>,</span>
<span>                                    plot.transcripts <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                    plot.transcripts.structure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  1662 genes were dropped because they have exons located on both strands
  of the same reference sequence or on more than one reference sequence,
  so cannot be represented by a single genomic range.
  Use 'single.strand.genes.only=FALSE' to get all the genes in a
  GRangesList object, or use suppressMessages() to suppress this message.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in makeGenesDataFromTxDb(TxDb.Hsapiens.UCSC.hg38.knownGene, karyoplot = kp, : object 'kp' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># merge overlapping transcripts</span></span>
<span><span class="va">genes.data</span> <span class="op">&lt;-</span> <span class="fu">mergeTranscripts</span><span class="op">(</span><span class="va">genes.data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in methods::is(genes.data, "GenesData"): object 'genes.data' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># draw axis</span></span>
<span><span class="va">kp</span> <span class="op">&lt;-</span> <span class="fu">plotKaryotype</span><span class="op">(</span>zoom <span class="op">=</span> <span class="va">region</span><span class="op">)</span></span>
<span><span class="co"># draw genes</span></span>
<span><span class="fu">kpPlotGenes</span><span class="op">(</span><span class="va">kp</span>, data<span class="op">=</span><span class="va">genes.data</span>, r0<span class="op">=</span><span class="fl">0</span>, r1<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in methods::is(data, "TxDb"): object 'genes.data' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># draw SNP density</span></span>
<span><span class="fu">kpPlotDensity</span><span class="op">(</span><span class="va">kp</span>, data<span class="op">=</span><span class="va">alb_gr</span>, window<span class="op">=</span><span class="fl">100</span>, r0<span class="op">=</span><span class="fl">0.3</span>, r1<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/intro-bioconductor-rendered-unnamed-chunk-8-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="circlize">circlize<a class="anchor" aria-label="anchor" href="#circlize"></a>
</h3>
<p>Another package for plotting genomic information is <code>circlize</code>, which plots chromosome in a circle rather than in a linear format. I won’t cover this in any detail, but you can check out the <a href="https://jokergoo.github.io/circlize_book/book/" class="external-link">documentation</a> for more information.</p>
</div>
</section><section id="rna-seq"><h2 class="section-heading">RNA-seq<a class="anchor" aria-label="anchor" href="#rna-seq"></a>
</h2>
<hr class="half-width">
<p>One common tasks people use <code>Bioconductor</code> packages for is RNA-seq analysis. The steps in RNA-seq analysis are roughly the following:</p>
<ol style="list-style-type: decimal">
<li>Alignment of reads using splice-aware mapper (I use <a href="https://github.com/alexdobin/STAR" class="external-link"><code>STAR</code></a>)</li>
<li>Counting reads aligned to each exon/transcript/gene (I use <a href="https://htseq.readthedocs.io/en/master/htseqcount.html" class="external-link"><code>htseq-count</code> from <code>HTSeq</code></a>)</li>
<li>Downstream analysis with counts - batch correction, differential expression, gene ontology, pathway analysis, etc</li>
</ol>
<p>While it’s possible to do the entire RNA-seq analysis pipeline, from reads to differential expressed genes, in <code>R</code>, you’ll notice that I usually do the first two steps using other software. This mostly comes down to momentum - this is how I was taught - but also has to do with the perception that <code>R</code> easier to use but slower and more memory-intensive than other languages (like <code>C++</code>, the language in which <code>STAR</code> is written).</p>
<p>We could spend a whole session (or workshop) on RNA-seq, so instead of trying to cover all of this material, I’ll instead link to several resources that might be helpful for experimental design and data processing.</p>
<ul>
<li>
<a href="https://www.melbournebioinformatics.org.au/tutorials/tutorials/rna_seq_exp_design/rna_seq_experimental_design/" class="external-link">Notes on RNA-seq experimental design</a> (Very important!! Without proper experimental design you are only wasting time and money.)</li>
<li>The <a href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html" class="external-link">DESeq2 vignette</a>
</li>
<li>The <a href="http://bioconductor.org/packages/release/bioc/vignettes/edgeR/inst/doc/edgeR.pdf" class="external-link">EdgeR vignette</a>
</li>
<li><a href="https://combine-australia.github.io/2018-09-26-RNAseq-Melbourne/" class="external-link">Materials from a two-day RNA-seq workshop</a></li>
<li><a href="https://hbctraining.github.io/DGE_workshop_salmon/lessons/07_DGE_summarizing_workflow.html" class="external-link">Sample differential gene expression workflow</a></li>
</ul>
<p>If you’re more interested in single cell analysis, the workflow is in principle the same, but there is the added complication of counting barcodes from each cell. If your data is from a 10X workflow, the easiest way to go from reads to counts is using their <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/using/tutorial_in" class="external-link"><code>cellranger</code> pipeline</a>. Once you have the count matrices, you can then use <code>R</code> packages for further analysis.</p>
<ul>
<li><a href="https://satijalab.org/seurat/" class="external-link">Seurat</a></li>
<li><a href="https://cole-trapnell-lab.github.io/monocle3/" class="external-link">Monocle3</a></li>
</ul></section><section id="resources"><h2 class="section-heading">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://cran.r-project.org/web/packages/BiocManager/vignettes/BiocManager.html" class="external-link">BiocManager vignette</a></li>
<li><a href="https://web.stanford.edu/class/bios221/labs/biostrings/lab_1_biostrings.html" class="external-link">Biostrings lab</a></li>
<li><a href="https://bioconductor.org/packages/release/bioc/html/Biostrings.html" class="external-link">Biostrings documentation</a></li>
<li><a href="https://bernatgel.github.io/karyoploter_tutorial/" class="external-link">karyoploteR documentation</a></li>
<li><a href="https://jokergoo.github.io/circlize_book/book/" class="external-link">circlize documentation</a></li>
<li>
<a href="https://www.melbournebioinformatics.org.au/tutorials/tutorials/rna_seq_exp_design/rna_seq_experimental_design/" class="external-link">Notes on RNA-seq experimental design</a> (Very important!! Without proper experimental design you are only wasting time and money.)</li>
<li>The <a href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html" class="external-link">DESeq2 vignette</a>
</li>
<li>The <a href="http://bioconductor.org/packages/release/bioc/vignettes/edgeR/inst/doc/edgeR.pdf" class="external-link">EdgeR vignette</a>
</li>
<li><a href="https://combine-australia.github.io/2018-09-26-RNAseq-Melbourne/" class="external-link">Materials from a two-day RNA-seq workshop</a></li>
<li><a href="https://hbctraining.github.io/DGE_workshop_salmon/lessons/07_DGE_summarizing_workflow.html" class="external-link">Sample differential gene expression workflow</a></li>
<li><a href="https://satijalab.org/seurat/" class="external-link">Seurat documentation</a></li>
<li><a href="https://cole-trapnell-lab.github.io/monocle3/" class="external-link">Monocle3 documentation</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>BiocManager</code> to install <code>Bioconductor</code> packages</li>
<li>Use <code>Biostrings</code> for working with biological sequences</li>
<li>Use <code>karyoploteR</code> or <code>circlize</code> for plotting genomic features</li>
<li>Use <code>EdgeR</code> and <code>DEseq2</code> for differential expression analysis</li>
<li>Use <code>Seurat</code> and <code>Monocle3</code> for single-cell RNA-seq data analysis</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-intro-rmarkdown"><p>Content from <a href="intro-rmarkdown.html">Using R markdown for notebooks and documents</a></p>
<hr>
<p> Last updated on 2022-11-26 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/intro-rmarkdown.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a notebook or document using R Markdown?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown documents and notebooks</li>
<li>Demonstrate how to include a header, markdown elements, pieces of code and code outputs</li>
<li>Discuss how to render documents and notebooks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="rmarkdown-for-reproducible-documented-analyis"><h2 class="section-heading">
<code>Rmarkdown</code> for reproducible, documented analyis<a class="anchor" aria-label="anchor" href="#rmarkdown-for-reproducible-documented-analyis"></a>
</h2>
<hr class="half-width">
<p>For a long time, most <code>R</code> code was written in <em>scripts</em>. These are just plain old text files, usually with the file extension <code>.R</code>, which contain <code>R</code> code. Any documentation in these scripts was in the form of comments, and any graphic generated had to be saved to file (or viewed in a window, then closed).</p>
<p>This paradigm worked, but it was lacking an integrated view of the results of the analysis. This is the problem that <code>knitr</code> and R markdown were developed to address.</p>
<p>R markdown allows the user to create notebooks and documents that contain text elements (formatted using markdown), and <code>R</code> code. If I’ve ever sent you a <code>.html</code> document containing some results, this is what I used to generate it. Other formats are possible for data export, including <code>.pdf</code>, but I tend to always use <code>.html</code> for it’s interactive elements.</p>
<p>Documents you create are <em>rendered</em> into the final output format that you’ve specified, by running all the code and combining the outputs it with your markdown text.</p>
<p>Although simple, this approach is powerful; I wrote all the content on this website using R markdown documents.</p>
<div class="section level3">
<h3 id="rmarkdown-header">Rmarkdown header<a class="anchor" aria-label="anchor" href="#rmarkdown-header"></a>
</h3>
<p>R markdown documents always start with a header, which is formatted in <a href="https://yaml.org/spec/1.2.2/" class="external-link"><code>YAML</code></a>, and at it’s most basic looks something like this:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"R Notebook"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> html_notebook</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre>
</div>
<p>That’s it: just a title and an output.</p>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="output-types" class="callout-inner">
<h3 class="callout-title">Output types<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>When you create a <code>.Rmd</code> file, you’ll have to choose if you want it to be a notebook (<code>output: html_notebook</code>), a document (<code>output: html_document</code>), or some other output type (for example, <code>output: pdf_document</code>).</p>
<p>Notebooks and documents are very similar, and the only difference between html documents and notebooks is that a <code>.html</code> file is created with your analysis every time you save a notebook, whereas an output file will only be created for a document when you tell RStudio to render it.</p>
</div>
</div>
</div>
<p>If you want, you can add an author and a date, for example:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Habits"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> Jane Doe</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> March 22, 2005</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre>
</div>
<p>Sometimes I want the date to be updated every time I render the document. You can do this by replacing the date with some <code>R</code> code.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Habits"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> Jane Doe</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> `r Sys.Date()`</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre>
</div>
<p>There are also lots of options for html documents and notebooks. I often use:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Habits"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> Jane Doe</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> `r Sys.Date()`</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html_document</span><span class="kw">:</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">keep_md</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">df_print</span><span class="kw">:</span><span class="at"> paged</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc_float</span><span class="kw">:</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">collapsed</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">smooth_scroll</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">code_folding</span><span class="kw">:</span><span class="at"> hide</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre>
</div>
<p>You can also add parameters in your header that you can use throughout your code:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Habits"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> Jane Doe</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> `r Sys.Date()`</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html_document</span><span class="kw">:</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">keep_md</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">df_print</span><span class="kw">:</span><span class="at"> paged</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc_float</span><span class="kw">:</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">collapsed</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">smooth_scroll</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">code_folding</span><span class="kw">:</span><span class="at"> hide</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">test</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">species</span><span class="kw">:</span><span class="at"> </span><span class="st">"human"</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre>
</div>
<p>You can then refer to these parameters using the syntax <code>params$test</code> and <code>params$species</code>.</p>
</div>
<div class="section level3">
<h3 id="markdown">Markdown<a class="anchor" aria-label="anchor" href="#markdown"></a>
</h3>
<p>Writing markdown documents are pretty simple. Use <code>#</code> for headings.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Largest heading</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">## Large heading</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">### Medium heading</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Small heading</span></span></code></pre>
</div>
<p>To create paragraphs, leave at least one blank line between text.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>This is a paragph.</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>This is a different paragraph.</span></code></pre>
</div>
<p>To add a line break (to prevent sentences from running on from one another), add two spaces at the end of the line.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>This is a line.  </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>This is another line.</span></code></pre>
</div>
<p>To add emphasis, use <code>*</code> or <code>_</code>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>This text is **bold**.</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>This text is __also bold__.</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>This text is in *italics*.</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>This text is also in _italics_.</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>This text is both ***bold and in italics***.</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>___Same here___.</span></code></pre>
</div>
<p>To create a block quote, add <code>&gt;</code> to the start of each line.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; This will be a quote</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; that's all in the same block</span></span></code></pre>
</div>
<p>To make a list, use numbers or dashes.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="an">This is an unordered list:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>element a</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>element b</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>element c</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>This is an ordered list:</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>element 1</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>element 2</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>element 3</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a> </span></code></pre>
</div>
<p>If you want to display code, use backticks:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>This is <span class="in">`inline`</span> code.</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"this is an R code block"</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre>
</div>
<p>To add images, use this syntax:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="al">![Caption for figure](/path/to/figure.png)</span></span></code></pre>
</div>
<p>You can add links using parentheses and brackets:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>You can read more in the <span class="co">[</span><span class="ot">documentation</span><span class="co">](https://www.markdownguide.org/basic-syntax/)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="adding-code">Adding code<a class="anchor" aria-label="anchor" href="#adding-code"></a>
</h3>
<p>Adding code blocks is also easy.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk-name}</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="in">y &lt;- 2</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="in">print(y)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre>
</div>
<p>There are lots of options to control how the code block and it’s output is displayed. For example:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk-name, echo=FALSE}</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="in">print("this code block won't appear in the output, but its output will")</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk-name, include=FALSE}</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="in">print("this code block won't appear in the output, and neither will it's output")</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre>
</div>
<p>If your code block produces a plot, the plot will appear in the report. You can change the size of the plot with options as well.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk-name, fig.width=8, fig.height=8}</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="in">tibble(</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="in">  group = c("A", "A", "B", "B"),</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="in">  y = runif(4)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;% </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=group, y = y)) +</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre>
</div>
<p>You can also apply options to all chunks using <code>knitr::set_opts()</code> at the top of your file.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">MD<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode md" tabindex="0"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo=</span><span class="cn">FALSE</span>, <span class="at">fig.width =</span> <span class="dv">6</span>, <span class="at">fig.height =</span> <span class="dv">6</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="running-code-blocks">Running code blocks<a class="anchor" aria-label="anchor" href="#running-code-blocks"></a>
</h3>
<p>Run individual lines of code in a chunk by pressing <kbd>Ctrl</kbd> + <kbd>Enter</kbd>, or run the whole chunk using <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> (or the ‘play’ symbol at the top right). You can also highlight particular pieces of a line that you want to run, and use <kbd>Ctrl</kbd> + <kbd>Enter</kbd> to run them.</p>
</div>
</section><section id="rendering-notebooks"><h2 class="section-heading">Rendering notebooks<a class="anchor" aria-label="anchor" href="#rendering-notebooks"></a>
</h2>
<hr class="half-width">
<p>There are a few different ways you can render your R markdown document. The easiest is to use the dedicated button in Rstudio. For documents, it’ at the top of your document looks like this:</p>
<figure><img src="fig/knit.png" alt="" class="figure mx-auto d-block"><figcaption>Button for knitting documents</figcaption></figure><p>For notebooks, you don’t need to manually render - every time you save the file, R will knit it for you. But if you want to see what the notebook will look like, you can press the preview button:</p>
<figure><img src="fig/preview.png" alt="" class="figure mx-auto d-block"><figcaption>Button for knitting documents</figcaption></figure><p>You can also render your notebook using code:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu">render</span><span class="op">(</span><span class="st">"/path/to/document.Rmd"</span><span class="op">)</span></span></code></pre>
</div>
<p>If you set parameters, you can change them when you render the notebook:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu">render</span><span class="op">(</span><span class="st">"/path/to/document.Rmd"</span>, params <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>test<span class="op">=</span><span class="cn">FALSE</span>, speces<span class="op">=</span><span class="st">"macaque"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="other-document-types"><h2 class="section-heading">Other document types<a class="anchor" aria-label="anchor" href="#other-document-types"></a>
</h2>
<hr class="half-width">
<p>There are also a number of other outputs you can produce from your R markdown other than html notebooks and documents. In particular, I’ve been playing around with slides using <code>Quatro</code> and <code>ioslides</code>. They can be a little tricky compared to power point, and a bit slow to render if your analysis is compute-heavy, but I think they’re worth considering!</p>
<p>This area is actively being developed, so it’s worth trying out new technologies when they are available.</p>
</section><section id="references"><h2 class="section-heading">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://bookdown.org/yihui/rmarkdown/pdf-document.html" class="external-link">Rmarkdown guide</a></li>
<li><a href="https://bookdown.org/yihui/rmarkdown-cookbook/" class="external-link">Rmarkdown cookbook</a></li>
<li><a href="https://www.markdownguide.org/basic-syntax/" class="external-link">Markdown guide</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Specify document-wide properties in the header</li>
<li>Use markdown element to format text</li>
<li>Use code chunks to run <code>R</code> code</li>
<li>Render your notebook using the buttons in Rstudio, or using <code>rmarkdown::render()</code>
</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-git"><p>Content from <a href="git.html">Version control with git</a></p>
<hr>
<p> Last updated on 2022-11-26 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/git.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is version control?</li>
<li>How to use git in Rstudio?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the basics of git</li>
<li>Demonstrate how stage and commit files</li>
<li>Demonstrate pulls and pushes from a remote repository</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="version-control-with-git"><h2 class="section-heading">Version control with <code>git</code><a class="anchor" aria-label="anchor" href="#version-control-with-git"></a>
</h2>
<hr class="half-width">
<p>Have you ever needed to refer back to the edit history of a document to restore a change you’d made? Or maybe you’ve sometimes worried about losing files that are only on your computer? Do you waste lots of time deploying software manually?</p>
<p>OK, so maybe most of you probably haven’t wasted time deploying software manually, but perhaps the other two are concerns you’ve had at some point.</p>
<p>All of these issues can be solved with the version control software <code>git</code>, when used together with a cloud-based repository such as github, bitbucket or gitlab.</p>
<p><code>git</code> keeps track of all the revisions to a repository that contains your code, allowing you to see when and where changes were made.</p>
<figure><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Dilp_rhi--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/yi9n7h1klm5m6e3odcsa.png" alt="" class="figure mx-auto d-block"><figcaption>Git commit timeline <a href="https://dev.to/milu_franz/git-explained-the-basics-igc" class="external-link">Image credit</a></figcaption></figure><p>It also allows you to collaborate easily with other people with branches and methods for merging changes.</p>
<figure><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--pfmhZlvH--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/8ito8dl7a62luwhp18xv.png" alt="" class="figure mx-auto d-block"><figcaption>Git branches <a href="https://dev.to/milu_franz/git-explained-the-basics-igc" class="external-link">Image credit</a></figcaption></figure><p>In my opinion, it’s an essential part of any project that involves code. So how does it work?</p>
</section><section id="creating-a-repository"><h2 class="section-heading">Creating a repository<a class="anchor" aria-label="anchor" href="#creating-a-repository"></a>
</h2>
<hr class="half-width">
<p>We’ll be working with git through Rstudio (there is a command line interface that I usually use, but it’s used differently for each OS and has a bit more of a learning curve).</p>
<p>After you’ve installed git, you’ll need to let Rstudio know how to find it.</p>
<figure><img src="https://support.posit.co/hc/en-us/article_attachments/203718287/Screen_Shot_2015-11-09_at_4.59.40_PM.png" alt="" class="figure mx-auto d-block"><figcaption>Global options</figcaption></figure><ol style="list-style-type: decimal">
<li>Open <em>Tools &gt; Global Options</em> and click on <em>Git/SVN</em>.</li>
<li>Check <em>Enable version control interface for Rstudio projects</em>.</li>
<li>Set the path for the git executable. If you don’t know where this is, click on the <code>Terminal</code> tab in the bottom left pane and type:</li>
</ol>
<ul>
<li>Windows: <code>where git</code> - it’ll be something like <code>C:/Program Files (x86)/Git/bin/git.exe</code>
</li>
<li>MacOSX: <code>which git</code> - it’ll be something like <code>/usr/bin/git</code>
</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Restart Rstudio</li>
</ol>
<p>The easiest way to start working with a project is to initialize an empty repository. I’ll walk you though the process with github, but you can also use bitbucket or gitlab if you prefer (although I’m not as familiar with these).</p>
<p>Head to <a href="https://github.com/" class="external-link">github</a> and if you aren’t already logged in, look for the <em>Sign in</em> and <em>Sign up</em> buttons in the top right corner. Make an account if necessary, and then sign in. On the left hand side next to <em>Top Repositories</em>, click <em>New</em>. Give your new repository a name and a description, and decide if you want it to be public or private. Check the <em>Add a README file</em> box, then create the repository.</p>
<p>Back in Rstudio,</p>
<ol style="list-style-type: decimal">
<li>Open <em>File &gt; New Project</em>
</li>
<li>Select <em>Version Control &gt; Git</em>
</li>
<li>Grab the HTTPS URL from github (see picture below) and fill in the <em>Repository URL</em> box</li>
<li>Set a name for your project directory - I usually make it the same as the name of the repository on github</li>
<li>Choose where you want the project directory to be located</li>
</ol>
<figure><img src="fig/github-setup.png" alt="" class="figure mx-auto d-block"><figcaption>A new repo on github</figcaption></figure></section><section id="making-changes"><h2 class="section-heading">Making changes<a class="anchor" aria-label="anchor" href="#making-changes"></a>
</h2>
<hr class="half-width">
<p>After you’ve set up your project, you’ll probably want to add the <code>.Rproj</code> file to version control. A new <em>Git</em> tab is available in the top right pane where you can do this. You’ll see in this panel that RStudio has created an <code>.Rproj</code> file for you when it created the project directory, and there’ll be some <strong>?</strong> next to the file name.</p>
<figure><img src="fig/git-pane.png" alt="" class="figure mx-auto d-block"><figcaption>Git pane</figcaption></figure><p>At this point, you need to know how Git thinks about your files. There are three statuses that your files can have:</p>
<ul>
<li>Before you have told git about any of your changes, they only exist in your working directory.</li>
<li>To tell get that you’ve made some changes to your file, you need to <strong>stage</strong> it (<code>git add</code>).</li>
<li>Tell git that you’re happy with the changed files by <strong>committing</strong> them.</li>
</ul>
<p>You can reset the files in your repository to an earlier version using the <strong>checkout</strong> process.</p>
<figure><img src="https://git-scm.com/book/en/v2/images/areas.png" alt="" class="figure mx-auto d-block"><figcaption>Three sections of a git project</figcaption></figure><div class="section level3">
<h3 id="staging">Staging<a class="anchor" aria-label="anchor" href="#staging"></a>
</h3>
<p>So how do we <strong>stage</strong> a file? Just check the box next to the file name in the <em>Git</em> panel.</p>
<figure><img src="fig/git-pane-staged.png" alt="A staged file" class="figure mx-auto d-block"> ### Diff</figure><p>At any time, you can check what you changed relative to the latest commit by clicking on <em>Diff</em>.</p>
<figure><img src="fig/git-pane-diff.png" alt="" class="figure mx-auto d-block"><figcaption>Git diff</figcaption></figure><p>In this case, all the lines are green because we’re adding a new file.</p>
</div>
<div class="section level3">
<h3 id="commit">Commit<a class="anchor" aria-label="anchor" href="#commit"></a>
</h3>
<p>If you’re happy with the changes you’ve made, you can <strong>commit</strong> them using the <em>Commit</em> button (next to <em>Diff</em>). You will see the same view with your changes as you did with <em>Diff</em>, and an additional box to add a commit message - this is required for all commits. Try to make it as informative as possible!</p>
<figure><img src="fig/git-pane-commit.png" alt="Git commit" class="figure mx-auto d-block"> You should get a pop-up telling you the commit was successful.</figure><figure><img src="fig/git-commit-success.png" alt="" class="figure mx-auto d-block"><figcaption>Git commit success</figcaption></figure>
</div>
<div class="section level3">
<h3 id="pushpull">Push/pull<a class="anchor" aria-label="anchor" href="#pushpull"></a>
</h3>
<p>So far all the changes we’ve made have been to the <em>local</em> repository (that exists only on your computer). After you’ve made some commits, you should <strong>push</strong> the changes to your remote repository so that your collaborators can see them, and they’re backed up in the cloud. If someone else has made changes to the same branch, you might need to <strong>pull</strong> and <strong>merge</strong> any changes that are in the repository but not on your local computer first.</p>
<figure><img src="https://www.janbasktraining.com/blog/uploads/images/image_750x_5d76346f0fbf8.jpg" alt="" class="figure mx-auto d-block"><figcaption>Working with remotes</figcaption></figure><p>You can push and pull from the same pop-up panel you get when you click <em>Commit</em>, or int the <em>Git</em> tab in the top-right pane.</p>
<figure><img src="fig/git-pane-push-pull.png" alt="" class="figure mx-auto d-block"><figcaption>Pulling and pushing</figcaption></figure><p>Your first push should be pretty straightforward.</p>
<p>If there are changes in the remote repository that you don’t have in your local repository, you’ll need to pull them before you can push any changes.</p>
<figure><img src="fig/git-failed-push.png" alt="" class="figure mx-auto d-block"><figcaption>A failed push</figcaption></figure><p>The first time you try a pull like this, you might get this message:</p>
<figure><img src="fig/git-failed-pull.png" alt="" class="figure mx-auto d-block"><figcaption>A failed push</figcaption></figure><p>This just means that you have to open a terminal and type in one of those options. I won’t go into details about what they all mean, but I usually use <code>git config pull.rebase false</code>. You’ll have to open a shell from the menu with <em>Tools &gt; Shell</em> (on Mac you can just use the terminal pane at the bottom left), type this command and press enter.</p>
<p>Try your pull again and it should then work. Your files should be updated!</p>
</div>
</section><section id="branches"><h2 class="section-heading">Branches<a class="anchor" aria-label="anchor" href="#branches"></a>
</h2>
<hr class="half-width">
<p>I mentioned earlier that you can create <strong>branches</strong>. Their purpose is to facilitate work on the same files as your collaborators without immediate conflicts. When you are ready to integrate your changes, you can open a <strong>pull request</strong> and <strong>merge</strong> the changes.</p>
<p>While using branches is a fundamental part of git, I won’t go into any more detail than that now. You can read more about how branches work in the <a href="https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell" class="external-link">git documentation</a>.</p>
</section><section id="command-line-git"><h2 class="section-heading">Command line git<a class="anchor" aria-label="anchor" href="#command-line-git"></a>
</h2>
<hr class="half-width">
<p>So far, we’ve used git through the Rstudio terminal. However, this will only get you so far, and eventually you’ll want to do something more complicated you’ll probably need to use a shell. You can open one from the menu with <em>Tools &gt; Shell</em>.</p>
<p>The <a href="https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell" class="external-link">git documentation</a> has all the information you’ll need for using the command line, but just to get you started, you can try:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print summary of changed, staged files</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># stage file</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add <span class="op">&lt;</span>file1<span class="op">&gt;</span> <span class="op">&lt;</span>file2<span class="op">&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># commit changes</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"My informative commit message"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># push to remote</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># pull changes from remote</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> pull</span></code></pre>
</div>
</section><section id="git-gotchas"><h2 class="section-heading">Git gotchas<a class="anchor" aria-label="anchor" href="#git-gotchas"></a>
</h2>
<hr class="half-width">
<p>There are a few things you should be aware of when working with git.</p>
<div class="section level3">
<h3 id="dont-add-large-files">Don’t add large files<a class="anchor" aria-label="anchor" href="#dont-add-large-files"></a>
</h3>
<p>Git was designed for working with source code (text files), not binaries or large datasets. Every time you check the status of your repository with <code>git status</code>, it looks at all the files that you’ve committed. If you have added large files, like NGS data, large images, or compiled binaries, git has to look through those files for changes, which can really slow things down.</p>
<p>I tend to avoid adding any of the data that I’m working with to version control, unless it’s a very small text file or image. Github also limits the size of individual files, and the total size of each repository, so avoid hitting those limits by keeping large files separate. You can still keep them in the same directory as your code, but avoid doing <code>git add</code> on them.</p>
</div>
</section><section id="keep-other-backups"><h2 class="section-heading">Keep other backups<a class="anchor" aria-label="anchor" href="#keep-other-backups"></a>
</h2>
<hr class="half-width">
<p>Although your code is pretty safe in the cloud, it’s good practice to keep other backups of your code elsewhere. Since your data shouldn’t be in your repository, you’ll need to think about other backups anyway. So keep your code and data backed up somewhere else, like other clouds (e.g. One Drive), CMRI shared folders and portable hard drives (but never <em>only</em> on a portable hard drive).</p>
</section><section id="resources"><h2 class="section-heading">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://git-scm.com/book/en/v2" class="external-link">Git documentation</a></li>
<li><a href="https://dev.to/milu_franz/git-explained-the-basics-igc" class="external-link">Git basics</a></li>
<li><a href="https://support.posit.co/hc/en-us/articles/200532077" class="external-link">Posit/Rstudio support article on git</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Keep your files safe and keep track of changes with version control</li>
<li>Use github as a remote repository for your code</li>
<li>Stage and commit changes to your files so that git keeps track of them</li>
<li>Push your changes to your remote repository, and pull changes made by others</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
        
        
        | <a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/carpentries/workbench-template-rmd/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:sscott@cmri.org.au">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.10.8" class="external-link">sandpaper (0.10.8)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/0.3.2" class="external-link">pegboard (0.3.2)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.2.9" class="external-link">varnish (0.2.9)</a>.</p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-rmd/aio.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-rmd/aio.html",
  "identifier": "https://carpentries.github.io/workbench-template-rmd/aio.html",
  "dateCreated": "2022-11-26",
  "dateModified": "2022-11-26",
  "datePublished": "2022-11-26"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

