<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to R: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><abbr class="icon" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="text-decoration: unset">
           
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #383838">Pre-Alpha
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="color: #FF4955; border-radius: 5px"></i>
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container ">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introduction to R and Rstudio</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="reading-in-data-readr-and-readxl.html">2. Reading in data: readr and readxl</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="tidying-data.html">3. Tidy data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="manipulating-data.html">4. Data wrangling</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="visualizing-data.html">5. Data visualization</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-introduction"><p>Content from <a href="introduction.html">Introduction to R and Rstudio</a></p>
<hr>
<p> Last updated on 2022-11-23 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/introduction.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I use the RStudio IDE?</li>
<li>What are the basics of R?</li>
<li>What are the best practices for writing R code?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to interact with the RStudio IDE</li>
<li>Demonstrate some R basics: operators, comments, functions, assignment, vectors and types</li>
<li>Be aware of some good habits for writing R code</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="why-r"><h2 class="section-heading">Why R?<a class="anchor" aria-label="anchor" href="#why-r"></a>
</h2>
<hr class="half-width">
<p>The <code>R</code> language is one of the most commonly used languages in bioinformatics, and data science more generally. It’s a great choice for you because:</p>
<ul>
<li>Reproducibility: Scripting your analysis makes it easier for someone else to repeat and for you to re-use and extend</li>
<li>Power: <code>R</code> can be used to work with datasets larger than you can in Prism or Excel</li>
<li>
<a href="https://en.wikipedia.org/wiki/Open_source" class="external-link">Open source</a>: So it’s free!</li>
<li>Community: <code>R</code> is a popular choice for data science, so there are many resources available for <a href="https://swcarpentry.github.io/r-novice-gapminder/" class="external-link">learning</a> and <a href="https://stackoverflow.com/questions/tagged/r" class="external-link">debugging</a>
</li>
<li>Packages: Since the community is large, many people have written helpful packages that can help you do tasks more easily than if you’d had to start from scratch</li>
</ul>
<p>The other language most commonly used for data science is <code>python</code>. Some people might even consider it a better choice than <code>R</code>, because it doesn’t have some of the strange quirks that <code>R</code> does, and also has a large community of users (and all of the benefits that come with it).</p>
<p>I use both <code>R</code> and <code>python</code>, and most (but not all) people who do a lot of data science know how to use both. But today we’re learning <code>R</code> because I think it usually what I turn to when someone in the lab asks me for help analysing their data, and I think everyone can learn to use it for those same tasks too.</p>
<p>I made all of the material for this course (including the website and slides) in <code>Rstudio</code> using <code>R</code>. A little bit can take you a long way!</p>
<div class="section level3">
<h3 id="theres-more-than-one-way-to-skin-a-cat">There’s more than one way to skin a cat<a class="anchor" aria-label="anchor" href="#theres-more-than-one-way-to-skin-a-cat"></a>
</h3>
<p>This course will teach a particular ‘dialect’ of <code>R</code> called the tidyverse. This is a collection of packages mostly written by Hadley Wickham, that focus on the concept of ‘tidy’ data.</p>
<p>You’ll soon discover that when coding, there are many ways of getting to the same output. Some of them are more efficient than others, and some of them are just easier to code than others. The tidyverse packages are hugely popular in the R community, and when I started I found them easy to work with.</p>
<p>However, if you stick with <code>R</code> long enough, you’ll probably end up needing to learn some additional base R (particularly if you use packages from outside the tidyverse). If you want to get a head start, I’ll include some links to resources at the end of this lesson.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-i-need-to-do-this-lesson" class="callout-inner">
<h3 class="callout-title">Do I need to do this lesson?<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>This lesson teaches the very basics. If you can predict what will happen after every section of the following script (and you known what a comment is), you can skip this lesson.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 1</span></span>
<span><span class="fl">100</span> <span class="op">**</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># section 2</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span></span>
<span></span>
<span><span class="co"># section 3</span></span>
<span><span class="fu">round</span><span class="op">(</span><span class="fl">3.1415</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># section 4</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># section 5</span></span>
<span><span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_length</span><span class="op">(</span><span class="st">"what is the output?"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># section 6</span></span>
<span><span class="fu">as.integer</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1.96</span>,<span class="fl">2.09</span>,<span class="fl">3.12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># section 7</span></span>
<span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 1</span></span>
<span><span class="fl">100</span> <span class="op">**</span> <span class="fl">1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 100</code></pre>
</div>
<p>100 to the power of 1 is 100</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 2</span></span>
<span></span>
<span><span class="co"># assign the value 4 to variable a</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="co"># assign the value 3 to variable b</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="co"># add the values of a and b</span></span>
<span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7</code></pre>
</div>
<p>4 + 3 is 7</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 3</span></span>
<span><span class="fu">round</span><span class="op">(</span><span class="va">pi</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>Using the <code>round()</code> function to round <span class="math inline">\(\pi\)</span> to two decimal places gives the result 3.14</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 4</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span></code></pre>
</div>
<p>No output, just loading the <code>stats</code> library.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 5</span></span>
<span><span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_length</span><span class="op">(</span><span class="st">"what is the output?"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 19</code></pre>
</div>
<p>You might need the help function for this one - there are 19 characters in the string.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 6</span></span>
<span><span class="fu">as.integer</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1.96</span>,<span class="fl">2.09</span>,<span class="fl">3.12</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3</code></pre>
</div>
<p>Coercing a vector of type double to integers truncates numbers to give integers.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># section 7</span></span>
<span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA NA NA</code></pre>
</div>
<p>This one is tricky! Trying to coerce a string that isn’t only digits just results in NA values.</p>
</div>
</div>
</div>
</div>
</div>
</section><section id="introduction-to-rstudio"><h2 class="section-heading">Introduction to RStudio<a class="anchor" aria-label="anchor" href="#introduction-to-rstudio"></a>
</h2>
<hr class="half-width">
<p><code>RStudio</code> is an <a href="https://en.wikipedia.org/wiki/Integrated_development_environment" class="external-link">integrated development environment</a> that makes it much easier to work with the <code>R</code> language. It’s free, cross-platform and provides many benefits such as project management and version control integration.</p>
<p>When you open it, you’ll see something like this:</p>
<figure><img src="fig/rstudio1.png" alt="Four panes of RStudio, showing the editor, console, environment and plots panel" class="figure mx-auto d-block"></figure><p>The four main panes are:</p>
<ul>
<li>Top left: editor. For editing scripts and other source code</li>
<li>Bottom left: console. For running code</li>
<li>Top right: environment. Information about objects you create will appear here</li>
<li>Bottom right: plots (amongst other things). Some output (like plots) from the console appears here. Also helpful for browsing files and getting help</li>
</ul>
<div class="section level3">
<h3 id="using-the-editor">Using the editor<a class="anchor" aria-label="anchor" href="#using-the-editor"></a>
</h3>
<p>Use the editor to write scripts and <code>Rmarkdown</code> documents. Although you can also type commands directly into the console, keeping your commands together in a script helps organise your analysis.</p>
<p>The editor also helps you identify issues with your code by placing a cross where it doesn’t understand something.</p>
<figure><img src="fig/rstudio2.png" alt="A cross in the margins where a line of code is syntatically incorrect" class="figure mx-auto d-block"></figure><p>Hover over the cross to get more information</p>
<figure><img src="fig/rstudio3.png" alt='Mousing over the cross reveals the message "expected , after expression" and "unmatched opening bracket (' class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="using-the-console">Using the console<a class="anchor" aria-label="anchor" href="#using-the-console"></a>
</h3>
<p>The console is where you can type in <code>R</code> commands and see their output. You can type R commands directly in here, or press <kbd>Ctrl</kbd>/<kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> to ‘send’ them from the editor to the console.</p>
<div class="section level4">
<h4 id="as-a-calculator">As a calculator<a class="anchor" aria-label="anchor" href="#as-a-calculator"></a>
</h4>
<p>The most basic way we can use R is as a calculator:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<p>If you type an incomplete command, you’ll see a <code>+</code>:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>+</code></pre>
</div>
<p>Finish typing the command to get back to the prompt (<code>&gt;</code>).</p>
<p>The order of operations is as you would expect:</p>
<ul>
<li>Parentheses <code>(</code>, <code>)</code>
</li>
<li>Exponents <code>^</code> or <code>**</code>
</li>
<li>Multiply <code>*</code>
</li>
<li>Divide <code>/</code>
</li>
<li>Add <code>+</code>
</li>
<li>Subtract <code>-</code>
</li>
</ul>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-operators" class="callout-inner">
<h3 class="callout-title">Challenge 1: Operators<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>How would you use R to compute <span class="math inline">\(\frac{9}{3 + 6}\)</span>?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span> <span class="op">/</span> <span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">6</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.3333333</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="writing-r-code"><h2 class="section-heading">Writing R code<a class="anchor" aria-label="anchor" href="#writing-r-code"></a>
</h2>
<hr class="half-width">
<p>Next, we’ll look at some of the building blocks of <code>R</code> code. You can use these to write scripts, or type them directly into the console.</p>
<p>When performing data analysis, it’s best to record the steps you took by writing a script, which can be re-run if you need to reproduce or update your work.</p>
<div class="section level3">
<h3 id="comments">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h3>
<p>The first building block is actually lines that are ignored by <code>R</code>: comments. Anything that comes after a <code>#</code> character won’t be executed. Use this to annotate your code.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this is a comment</span></span>
<span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="co"># this is also a comment</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the line below won't be executed</span></span>
<span><span class="co"># 1 + 1</span></span></code></pre>
</div>
<p>Comments is very important!!! A key part of reproducibility is knowing what code does. Make it easier for others and your future self by adding lots of comments to your code.</p>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="debugging-by-comment" class="callout-inner">
<h3 class="callout-title">Debugging by comment<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>You can also use comments when testing and debugging your code, by preventing <code>R</code> from running particular lines of your script. RStudio provides a shortcut for commenting/uncommenting lines: <kbd>Ctrl</kbd>/<kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>c</kbd>.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h3>
<p>If you want <code>R</code> to remember something, you can assign it to a variable:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_var</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">+</span><span class="fl">1</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">my_var</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<div id="callout2" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="hello-operator" class="callout-inner">
<h3 class="callout-title">Hello, operator?<a class="anchor" aria-label="anchor" href="#callout2"></a>
</h3>
<div class="callout-content">
<p>There are actually two assignment operators in <code>R</code>: <code>&lt;-</code> and <code>=</code>. They differ a little in their behaviour (you don’t need to know all of the details of how they differ); in general you should use <code>&lt;-</code> for assignment.</p>
</div>
</div>
</div>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-assignment" class="callout-inner">
<h3 class="callout-title">Challenge 2: Assignment<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>What would be the output of the following code? Try to think about what the answer would be without using <code>R</code>.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">b</span><span class="op">)</span> <span class="op">/</span> <span class="va">b</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">b</span><span class="op">)</span> <span class="op">/</span> <span class="va">b</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">c</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h3>
<p>A function is just something that takes zero or more inputs, does something with it, and gives you back zero or more outputs.</p>
<figure><img src="fig/functions.png" alt="A function takes as input (x,y), does some stuff, and outputs z" style="width:50.0%" class="figure mx-auto d-block"><figcaption>A black box function</figcaption></figure><p><code>R</code> comes with many useful functions that you can use in your code. A function is always called with parentheses <code>()</code>.</p>
<p>For example, the <code>getwd()</code> function takes no inputs, and returns the current working directory.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a function that takes no inputs</span></span>
<span><span class="fu">getwd</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Base <code>R</code> also has many mathematical and statistical functions:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># natural logarithm</span></span>
<span><span class="fu">log</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># rounding</span></span>
<span><span class="fu">round</span><span class="op">(</span><span class="fl">0.555555</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.556</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># statistical analysis</span></span>
<span><span class="fu">t.test</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.5</span>, <span class="fl">8</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1001</span>, <span class="fl">3000</span>, <span class="fl">5000</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Welch Two Sample t-test

data:  c(1, 2.5, 8, 1) and c(1000, 1001, 3000, 5000)
t = -2.6085, df = 3, p-value = 0.07979
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -5543.6641   549.4141
sample estimates:
mean of x mean of y 
    3.125  2500.250 </code></pre>
</div>
<p>You don’t need to memorize all these functions: Google is your friend.</p>
<p>RStudio can also help you with function usage. If you know what the name of a function is but can’t remember how to use it, you can type <code>?</code> before the function name in the console to get help on that function.</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">sin</span></span></code></pre>
</div>
<p>If you don’t know what the name of a function is, you can type <code>??</code> before a key word to search the documentation for that key word.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="op">?</span><span class="va">trig</span></span></code></pre>
</div>
<div id="callout3" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="named-arguments" class="callout-inner">
<h3 class="callout-title">Named arguments<a class="anchor" aria-label="anchor" href="#callout3"></a>
</h3>
<div class="callout-content">
<p>Function arguments can be named <em>implicitly</em> or <em>explicitly</em>. When calling a function, explicitly named arguments are matched first, then any other arguments are matched in order.</p>
<p>For example, the documentation for the <code>round</code> function gives its signature: <code>round(x, digits = 0)</code>.</p>
<p>The following function calls are all equivalent:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">round</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">round</span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">round</span><span class="op">(</span>digits<span class="op">=</span><span class="fl">3</span>, x<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p>However, the last is not best practice: reversing the order of the arguments will likely be confusing for someone else reading your code.</p>
<p>In general, try to match the documentation when you call a function.</p>
<p>Which of the calls above matches the documentation for <code>round()</code>?</p>

</div>
</div>
</div>
<p>You can also write your own functions:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># function to add two numbers</span></span>
<span><span class="va">my_add</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num1</span>, <span class="va">num2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">num1</span> <span class="op">+</span> <span class="va">num2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_add</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-functions" class="callout-inner">
<h3 class="callout-title">Challenge 3: Functions<a class="anchor" aria-label="anchor" href="#challenge4"></a>
</h3>
<div class="callout-content">
<p>Use the R console to get help on the <code>rnorm()</code> function</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">rnorm</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-functions" class="callout-inner">
<h3 class="callout-title">Challenge 3: Functions<em> (continued)</em><a class="anchor" aria-label="anchor" href="#challenge5"></a>
</h3>
<div class="callout-content">
<p>Use the <code>rnorm</code> function to generate 5 numbers from a normal distribution with a mean of 1 and a standard deviation of 2.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">5</span>, mean<span class="op">=</span><span class="fl">1</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  2.211795 -4.185208  2.019470 -1.058806  1.367545</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="using-libraries">Using libraries<a class="anchor" aria-label="anchor" href="#using-libraries"></a>
</h3>
<p>One of the great things about <code>R</code> is that a lot of other people use it, so often somebody has worked out an efficient way of doing things that you can use. This way, you don’t have to build your code from the ground up; instead you can use functions that other people have written.</p>
<p>When you use other peoples’ functions, they will be packaged in to <em>libraries</em> (also called <em>packages</em>) that you can import. In order to use library, it first must be installed. R provides the function <code>install.packages()</code> which you can use to install libraries from <code>CRAN</code> (an online repository of libraries).</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"library_name"</span><span class="op">)</span></span></code></pre>
</div>
<p>Note the use of quotation marks around the library name - this tells <code>R</code> that this is a string, rather than a variable (more on strings in the next section).</p>
<div id="challenge6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4-installing-a-library" class="callout-inner">
<h3 class="callout-title">Challenge 4: Installing a library<a class="anchor" aria-label="anchor" href="#challenge6"></a>
</h3>
<div class="callout-content">
<p>What code would you use to install the <code>tidyverse</code> library? Try it out!</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="callout4" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="package-ception" class="callout-inner">
<h3 class="callout-title">Package-ception<a class="anchor" aria-label="anchor" href="#callout4"></a>
</h3>
<div class="callout-content">
<p>Most of the packages that you’ll use will come from <code>CRAN</code>, but you might come across other sources of packages that are also useful. These are usually installed by packages that you can get from <code>CRAN</code>.</p>
<p>For example, the <a href="https://www.bioconductor.org/" class="external-link"><code>Bioconductor</code></a> suite consists of packages that are useful for bioinformatics. To install any <code>Bioconductor</code> libraries, you’ll first need to install the <code>BiocManager</code> package from <code>CRAN</code>, and then use functions from this library to install <code>Bioconductor</code> packages.</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install BiocManager package</span></span>
<span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the install function from BiocManager to install the GenomicFeatures and karyoploteR libraries</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"GenomicFeatures"</span>, <span class="st">"karyoploteR"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Another place you might install packages from is <a href="https://github.com/" class="external-link"><code>github</code></a>. Many developers host their code for their package on <code>github</code>, and then release it to <code>CRAN</code> when they think it’s ready.</p>
<p>If you want to use the development version of a package (for example if you want to use a feature that hasn’t been released yet), you can get it directly from <code>github</code> using the <code>devtools</code> package. Be careful when you do this - you’ll get all the shiny newest features, but you might also run into new bugs that haven’t been fixed yet!</p>
<p>For example, if you want to install the <a href="https://github.com/tidyverse/readr" class="external-link">development version of <code>readr</code> from <code>github</code></a>:</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install the devtools package</span></span>
<span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the install function from devtools to install readr</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tidyverse/readr"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>By default, the only functions that when you start up <code>R</code> are the <em>base R</em> functions. If you want to use any functions from libraries that you’ve installed, you’ll need to tell <code>R</code> which library they come from.</p>
<p>One way to do this is is to use the <code>::</code> syntax: <code>packagename::functionname()</code>. For example, we can use the <code>str_length()</code> function from the <code>stringr</code> package as follows</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_length</span><span class="op">(</span><span class="st">"testing"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7</code></pre>
</div>
<div id="challenge7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5-using-a-library" class="callout-inner">
<h3 class="callout-title">Challenge 5: Using a library<a class="anchor" aria-label="anchor" href="#challenge7"></a>
</h3>
<div class="callout-content">
<p>What do you think will happen if we omit the <code>packagename::</code> part?</p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str_length</span><span class="op">(</span><span class="st">"testing"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in str_length("testing"): could not find function "str_length"</code></pre>
</div>
<p>We get an error because <code>R</code> doesn’t know what the <code>str_length()</code> function is by default.</p>
</div>
</div>
</div>
</div>
<p>The other way to use functions from a library is to import all the functions in the library using the <code>library()</code> function. It’s best practice to put all the <code>library()</code> calls together at the top of your code, rather than sprinking them throughout.</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import whole library</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">stringr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the str_length function without ::</span></span>
<span><span class="fu">str_length</span><span class="op">(</span><span class="st">"testing"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7</code></pre>
</div>
<p>You can still use the <code>packagename::functionname()</code> syntax even if you’ve loaded the library. This makes it clear which library the function comes from, and some style guides recommend that you do this for every function you use.</p>
<div id="callout5" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="function-conflicts" class="callout-inner">
<h3 class="callout-title">Function conflicts<a class="anchor" aria-label="anchor" href="#callout5"></a>
</h3>
<div class="callout-content">
<p>The order you load your packages is important. If two functions from two different packages you’ve loaded have the same name, the one you loaded last will be used. Sometimes packages will warn you about this - for example, when you load the <code>tidyverse</code> package (which is actually a collection of packages), you’ll see something like this.</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ forcats 0.5.2 
✔ readr   2.1.3      
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<p>This tells us that the <code>filter()</code> function from <code>dplyr</code> has overwritten (or ‘masked’) the <code>filter()</code> function from the <code>stats</code> package, and there is a similar conflict for <code>lag()</code>.</p>
<p>You can still use <code>stats::filter()</code> in your code, but you must explicitly specify that you want to use the<code>stats</code> package by prefixing it with <code>stats::</code>. If you just use <code>filter()</code>, you’ll get the version from <code>dplyr</code>.</p>
<p>Not all packages warn you about conflicts, so be careful you’re using the function that you think you’re using! This can be a source of strange errors, so try adding <code>packagename::</code> in front of your function calls if you this this might be happening.</p>
</div>
</div>
</div>
<div id="challenge8" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6-best-practices" class="callout-inner">
<h3 class="callout-title">Challenge 6: Best practices<a class="anchor" aria-label="anchor" href="#challenge8"></a>
</h3>
<div class="callout-content">
<p>In which situations do you think it’s best to use the <code>packagename::functionname()</code> syntax, and when should you use <code>library()</code>?</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" data-bs-parent="#accordionSolution8" aria-labelledby="headingSolution8">
<div class="accordion-body">
<p>There’s no wrong or right answers here, but you might come across people that have (strong) opinions in this area.</p>
<p>Usually, if I’m only using one or two functions from a library, I won’t import the whole library, but just use the <code>packagename::functionname()</code> syntax. If I’m going to be using a lot of functions from a library, I’ll use <code>library()</code>.</p>
<p>Some people consider it best practice to always use <code>packagename::functionname()</code>, since then it’s clear which packages are being used and where. This also helps avoid conflicts between functions with the same name in different packages.</p>
<p>However, this style is quite verbose (and a little distracting), and some people might say that this makes code written this way less readable. In practice, I haven’t come across much code that always uses explicit package names.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="vectors">Vectors<a class="anchor" aria-label="anchor" href="#vectors"></a>
</h3>
<p>One of the most common data structures <code>R</code> is the <em>vector</em>. These are collections of elements (technically called ‘atomic vectors’) like numbers, which are arranged in a particular order.</p>
<p>Vectors are often created with the concatenation function <code>c()</code>:</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a vector of three numbers</span></span>
<span><span class="va">a_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># order matters!</span></span>
<span><span class="va">a_different_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p>In <code>R</code>, vectors contain data of only one type. Some of the types you might see are:</p>
<ul>
<li>Double: real numbers which can take on any value (like 1.13, 6, -1004.29)</li>
<li>Integer: whole real numbers (like 1, 2, -1)</li>
<li>Character: strings of characters, enclosed in either single or double quotes</li>
<li>Logical: booleans, either <code>TRUE</code> or <code>FALSE</code>
</li>
</ul>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we can use the seq function to create vectors with numbers in them</span></span>
<span><span class="va">double_vec</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add 'L' to the end of a number to tell R that it's an integer</span></span>
<span><span class="va">integer_vec</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">10L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># strings can be enclosed in single or double quotes</span></span>
<span><span class="va">character_vec</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"this"</span>, <span class="st">'is'</span>, <span class="st">"a"</span>, <span class="st">'vector'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># logicals are either TRUE or FALSE</span></span>
<span><span class="va">logical_vec</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>You can get at the individual elements of a vector using brackets (<code>[</code>):</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first element of double_vec</span></span>
<span><span class="va">double_vec</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># third to fifth elements of integer_vec</span></span>
<span><span class="va">integer_vec</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#first and fourth elements of character_vec</span></span>
<span><span class="va">character_vec</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div id="callout6" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="declaring-types" class="callout-inner">
<h3 class="callout-title">Declaring types<a class="anchor" aria-label="anchor" href="#callout6"></a>
</h3>
<div class="callout-content">
<p>In some programming languages, like <code>C</code> and <code>java</code>, the programmer must declare the type of a variable when it’s created. In these <a href="https://developer.mozilla.org/en-US/docs/Glossary/Static_typing#:~:text=A%20statically%2Dtyped%20language%20is,not%20indicate%20their%20variable%20types." class="external-link">statically typed</a> languages, a variable declared as an integer can’t store any other types of data. As a dynamically typed language, <code>R</code> takes a looser approach to variable types.</p>
</div>
</div>
</div>
<p>If you try to create a vector that contains more than one type of element, all the elements will be transformed into the ‘lowest common denominator’ type. For example, concatenating an integer and double will result in a double vector.</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># concatenting a double and an integer</span></span>
<span><span class="va">numeric_vec</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5.8</span>, <span class="fl">10L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the typeof function tells you the type of a variable</span></span>
<span><span class="fu">typeof</span><span class="op">(</span><span class="va">numeric_vec</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "double"</code></pre>
</div>
<p>One way to think about this is that elements are always coerced into the type that results in the least amount of information loss. The integers are a subset of all real numbers, so we can easily represent an integer <code>10L</code> as the numeric <code>10</code>. But if we tried to convert the real number <code>5.8</code> to an integer, how do we deal with the <code>.8</code> part?</p>
<div id="challenge9" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-7-types" class="callout-inner">
<h3 class="callout-title">Challenge 7: Types<a class="anchor" aria-label="anchor" href="#challenge9"></a>
</h3>
<div class="callout-content">
<p>What do you think will be the type of the following vector?</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unknown_type</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1</span>, <span class="st">"one"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" data-bs-parent="#accordionSolution9" aria-labelledby="headingSolution9">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unknown_type</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1</span>, <span class="st">"one"</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">unknown_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "1"   "1"   "one"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="fu">typeof</span><span class="op">(</span><span class="va">unknown_type</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<p>It’s a character vector.</p>
<p>Character vectors can be used to represent numbers, but numbers can’t easily be used to represent characters.</p>
</div>
</div>
</div>
</div>
<p><code>R</code> also has a way of representing missing data: there’s a special value in every type called <code>NA</code> (not available).</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre>
</div>
<p>Having <code>NA</code> values can change the way that functions interact with your data. For example, how would you take the mean of three values: 1, 2, and NA?</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<p><code>R</code> doesn’t know how to do this, so it just returns <code>NA</code>.</p>
<div id="challenge10" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-8-removing-na" class="callout-inner">
<h3 class="callout-title">Challenge 8: Removing NA<a class="anchor" aria-label="anchor" href="#challenge10"></a>
</h3>
<div class="callout-content">
<p>Check the documentation of the <code>mean</code> function to find out how to ignore <code>NA</code> values when computing the mean of a vector.</p>
</div>
</div>
</div>
<div id="accordionSolution10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution10" aria-expanded="false" aria-controls="collapseSolution10">
  <h4 class="accordion-header" id="headingSolution10">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution10" class="accordion-collapse collapse" data-bs-parent="#accordionSolution10" aria-labelledby="headingSolution10">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="fu">C</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>, <span class="cn">NA</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in C(1, 2, NA): object not interpretable as a factor</code></pre>
</div>
<p>Use the additional named argument <code>na.rm=TRUE</code></p>
</div>
</div>
</div>
</div>
</div>
</section><section id="best-practices"><h2 class="section-heading">Best practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<hr class="half-width">
<p>Now you know the basics of <code>R</code>, there are a few best practices that you should follow on your journey. These aren’t hard and fast rules, but principles that you should aim to follow to make your code better and more reproducible.</p>
<div class="section level3">
<h3 id="formatting-and-readability-matters">Formatting and readability matters<a class="anchor" aria-label="anchor" href="#formatting-and-readability-matters"></a>
</h3>
<p>You should always be able to come back to your code after a long break (months, years) and easily understand what it does.</p>
<p>One thing that helps with this is to follow a style guide like <a href="https://style.tidyverse.org/" class="external-link">this one for the tidyverse</a></p>
<p>This covers things like:</p>
<ul>
<li>Commenting: do this a lot! It’s better to have more comments than fewer</li>
<li>Each script should start with a description of what it does or what it’s for</li>
<li>When you have to name something, use a name that makes sense. You’re more likely to understand what is contained in variable <code>my_peptide</code> than you are if it was called <code>p</code> or <code>x</code> or <code>owobljldfibllkmb</code>
</li>
<li>Syntax and spacing: use spaces and newlines to make your code more readable, not less</li>
<li>Line length: try to make horizontal scrolling unnecssary, which usually means lines are less than 80 characters</li>
</ul>
</div>
<div class="section level3">
<h3 id="dont-copypaste-code">Don’t copy/paste code<a class="anchor" aria-label="anchor" href="#dont-copypaste-code"></a>
</h3>
<p>Try to avoid copy-pasting blocks of code. If you find you need to make a change to that code, you’ll need to edit all the copies. If you do this, it’s easy to miss somewhere that you copied it, or make a mistake when you change it. If you find yourself needing to do the same task many times, it’s usually better to write a function instead.</p>
</div>
<div class="section level3">
<h3 id="test-your-expectations">Test your expectations<a class="anchor" aria-label="anchor" href="#test-your-expectations"></a>
</h3>
<p>Try to frequently test your code to see that it does what you expect it to do. Getting into this habbit helps guard against bugs.</p>
<p>There are lots of different ways to do this, from just trying out the code with a few different inputs to automated <a href="https://en.wikipedia.org/wiki/Unit_testing" class="external-link">unit testing</a></p>
<p>Don’t forget also to test that your code doesn’t do things that you don’t expect it to do as well!</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define a function</span></span>
<span><span class="va">plus_three</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">return</span><span class="op">(</span> <span class="va">num</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># should return 11</span></span>
<span><span class="fu">plus_three</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># should return 2</span></span>
<span><span class="fu">plus_three</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># should raise an error</span></span>
<span><span class="fu">plus_three</span><span class="op">(</span><span class="st">"ten"</span><span class="op">)</span></span></code></pre>
</div>
<p>You can use the <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/stopifnot" class="external-link">function <code>stopifnot</code></a> to help you check things automatically.</p>
</div>
<div class="section level3">
<h3 id="project-management">Project management<a class="anchor" aria-label="anchor" href="#project-management"></a>
</h3>
<p>Aim to keep your data, scripts and output organized. <code>RStudio</code> helps you with this with Projects, which can be used to store all of the files related to a particular piece of analysis. People write <a href="https://github.com/swcarpentry/good-enough-practices-in-scientific-computing/blob/gh-pages/good-enough-practices-for-scientific-computing.pdf" class="external-link">whole papers</a> about this, but here are a few suggestions:</p>
<ul>
<li>Treat raw data and metadata as read-only. Put it in a folder called <code>data</code> and don’t write anything to that folder except for more raw data</li>
<li>Put source code in a folder called <code>src</code>
</li>
<li>Put files generated during analysis in a folder called <code>out</code> or <code>results</code>. It shouldn’t matter if this folder gets deleted, since you should be able to re-create its contents using your data and scripts</li>
<li>A <code>README</code> file can be useful for a broad overview of the project, and for explaning how to run the analysis</li>
<li>Keep track of the packages required for your analysis using <a href="https://rstudio.github.io/renv/articles/renv.html" class="external-link"><code>renv</code></a> (for <code>R</code> projects only), or <code>conda</code> (more general but has a few gotchas for <code>R</code> packages)</li>
</ul>
<p>That is, an organized project might look something like this:</p>
<pre><code>my_great_project
├── README.md
├── data
│   ├── dataset_1
│   │   ├── dataset_1.R1.fq.gz
│   │   └── dataset_1.R2.fq.gz
│   ├── dataset_2
│   │   ├── dataset_2_1.R1.fq.gz
│   │   ├── dataset_2_1.R2.fq.gz
│   │   ├── dataset_2_2.R1.fq.gz
│   │   └── dataset_2_2.R2.fq.gz
│   └── metadata
│       ├── metadata_1.tsv
│       └── metadata_2.tsv
├── renv
│   └── activate.R
├── results
│   ├── analyse
│   │   └── fold_change.tsv
│   ├── plot
│   │   ├── phylogeny.pdf
│   │   └── taxa.pdf
│   └── preprocess
│       ├── intermediate_result.tsv
│       ├── mapped.bam
│       └── mapped.bam.bai
└── scripts
    ├── 01_preprocess.R
    ├── 02_analyse.R
    └── 03_plot.R</code></pre>
</div>
</section><section id="links-and-acknowledgements"><h2 class="section-heading">Links and acknowledgements<a class="anchor" aria-label="anchor" href="#links-and-acknowledgements"></a>
</h2>
<hr class="half-width">
<p>As you begin your journey with <code>R</code>, you might find it helpful to refer to one-page summaries (or ‘cheat sheets’) that other people have compiled. For example, there are cheat sheets for:</p>
<ul>
<li><a href="https://drive.google.com/file/d/1bo8vMXeeiRy8l89eIjOALezO3V5oaewY/view" class="external-link">Commonly used functions</a></li>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/rstudio-ide.pdf" class="external-link">RStudio IDE</a></li>
</ul>
<p>Here are some other useful links</p>
<ul>
<li><a href="https://r4ds.had.co.nz/index.html" class="external-link">R for data science</a></li>
<li><a href="https://github.com/matloff/fasteR" class="external-link">fasteR, a course teaching (mainly) base R</a></li>
<li><a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003285" class="external-link">Ten Simple Rules for Reproducible Computational Research</a></li>
<li><a href="https://www.datacamp.com/tutorial/r-packages-guide" class="external-link">More information about installing R packages</a></li>
</ul>
<p>This lesson is inspired by and draws on some material from <a href="https://swcarpentry.github.io/r-novice-gapminder/01-rstudio-intro/index.html" class="external-link">Software Carpentries introduction to R</a>, <a href="https://datacarpentry.org/genomics-r-intro/00-introduction/index.html" class="external-link">Intro to R and Rstudio for Genomics</a>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use RStudio for writing and executing <code>R</code> code</li>
<li>Add comments to your code by starting a line wtih <code>#</code>
</li>
<li>Assign values to variables using the assignment operator <code>&lt;-</code>
</li>
<li>Functions covert inputs to outputs</li>
<li>Vectors are a collection of values of the same type</li>
<li>Following best practices will help the with the correctness and readabilty of your <code>R</code> code</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-reading-in-data-readr-and-readxl"><p>Content from <a href="reading-in-data-readr-and-readxl.html">Reading in data: readr and readxl</a></p>
<hr>
<p> Last updated on 2022-11-23 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/reading-in-data-readr-and-readxl.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we get data into <code>R</code>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the advantages of tidy data</li>
<li>Use <code>readxl</code> to import data from Microsoft Excel</li>
<li>Use <code>readr</code> to import data from text files</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="reading-in-data"><h2 class="section-heading">Reading in data<a class="anchor" aria-label="anchor" href="#reading-in-data"></a>
</h2>
<hr class="half-width">
<p>So you want to make some awesome plots using <code>R</code>. The first step you’ll need to take is to import your data.</p>
<p>When I first learnt <code>R</code> in a first-year statistics course, the way we did this was:</p>
<ol style="list-style-type: decimal">
<li>Open an Excel spreadsheet with the data</li>
<li>Select the data to be imported</li>
<li>Copy to the clipboard (<kbd>Cmd</kbd> + <kbd>c</kbd>)</li>
<li>Open an R terminal</li>
<li>Enter the command <code>read.table(pipe("pbpaste"), header = TRUE)</code>
</li>
</ol>
<p>This is a pretty convoluted way to do things! This weird process was part of the reason that, after I finished the course, I didn’t touch <code>R</code> again for almost ten years.</p>
<p>Luckily, in the meantime people worked out better ways of doing things. This lesson will cover two awesome packages which can help you import your data: <code>readxl</code> for Excel files, and <code>readr</code> for text files.</p>
</section><section id="reading-in-data-from-excel-readxl"><h2 class="section-heading">Reading in data from Excel: readxl<a class="anchor" aria-label="anchor" href="#reading-in-data-from-excel-readxl"></a>
</h2>
<hr class="half-width">
<p>If you’ve entered data into a digital format, chances are that you’ve used spreadsheet software like Microsoft Excel. Excel makes data entry easy because it takes care of all of the formatting for you. But at some point, you’ll probably want to get your data out of Excel and into <code>R</code>. That’s where the <code>readxl</code> package comes in!</p>
<p>The workhorse of this package is the <code>read_xlsx()</code> function (or <code>read_xls</code> for older excel files). It takes as input a path to the file you want to read.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define path to excel file to read</span></span>
<span><span class="va">my_excel_sheet</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">".."</span>, <span class="st">"episodes"</span>,  <span class="st">"data"</span>, <span class="st">"readxl_example_1.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read in data </span></span>
<span><span class="va">my_excel_data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_xlsx</span><span class="op">(</span><span class="va">my_excel_sheet</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: `path` does not exist: '/home/runner/work/cmri_R_workshop/cmri_R_workshop/site/built/../episodes/data/readxl_example_1.xlsx'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_excel_data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'my_excel_data' not found</code></pre>
</div>
<div class="section level3">
<h3 id="file-paths-with-herehere">File paths with <code>here::here()</code>
<a class="anchor" aria-label="anchor" href="#file-paths-with-herehere"></a>
</h3>
<p>Note that I use a function called <code>here</code> to create the file path to the excel file. You can read more about this function <a href="https://cran.r-project.org/web/packages/here/vignettes/here.html" class="external-link">here</a>.</p>
<p>Using this function helps with cross-platform compatbility (so it works on Windows as well as MacOX and Linux). This is because directories on Windows are usually separated with a backslash <code>\</code>, whereas on Unix-based distributions (like MacOS and Linux) directories are separated by a slash <code>/</code>.</p>
<p>You can check what the file path looks like on your platform by printing out the variable we defined with the file path:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_excel_sheet</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "/home/runner/work/cmri_R_workshop/cmri_R_workshop/site/built/../episodes/data/readxl_example_1.xlsx"</code></pre>
</div>
<p>Using <code>here::here()</code> always generates paths relative to the project root (the file created by RStudio when you make a new project, which has the file extension <code>.Rproj</code>). If you move the project around on your filesystem (or send it to someone else), the import will still work. This wouldn’t be the case if you manually specified the absolute path to the file.</p>
<p>Note that this example file path is a little convoluted, because of the way the lessons are created. Yours should be more straightforward and look more like this:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_excel_sheet</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"readxl_example_1.xlsx"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="tibbles">Tibbles<a class="anchor" aria-label="anchor" href="#tibbles"></a>
</h3>
<p>Coming back to the output of the call to <code>readxl::read_xlsx()</code> - calls to this function return a <code>tibble</code> object with the data contained in the excel spreadsheet.</p>
<p>The <code>tibble</code> object is a convenient way of storing rectangular data, where column has a type, (which is shown when you print the table). Ideally, in a tibble each column should contain data from one variable, and each row consists of observations of each varaiables - this is known as ‘tidy data’ (more on this in the next lesson).</p>
<p>If you don’t specify the types (like character, integer, double) of each column, <code>readxl</code> will try to <a href="https://readxl.tidyverse.org/articles/cell-and-column-types.html" class="external-link">guess them based on the types in the excel spreadhsheet</a>. This can lead to unexpected behaviour, especially if you mix numbers and strings in the same column.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-column-types" class="callout-inner">
<h3 class="callout-title">Challenge 1: Column types<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>Open the file <code>readxl_example_2.xlsx</code> in Excel. What do you think the types will be when you import this file?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in data </span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_xlsx</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">".."</span>, <span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"readxl_example_2.xlsx"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: `path` does not exist: '/home/runner/work/cmri_R_workshop/cmri_R_workshop/site/built/../episodes/data/readxl_example_2.xlsx'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                                                                            
1 function (..., list = character(), package = NULL, lib.loc = NULL,        
2     verbose = getOption("verbose"), envir = .GlobalEnv, overwrite = TRUE) 
3 {                                                                         
4     fileExt &lt;- function(x) {                                              
5         db &lt;- grepl("\\\\.[^.]+\\\\.(gz|bz2|xz)$", x)                     
6         ans &lt;- sub(".*\\\\.", "", x)                                      </code></pre>
</div>
<p>Note that:</p>
<ul>
<li>The ‘replicate’ column has a type of <code>dbl</code> even though it contains only integers.</li>
<li>The ‘drug concentration’ column is of type <code>chr</code> because R doesn’t know that ‘uM’ is a unit.</li>
<li>Mixing numbers and charaters in the ‘assay 2’ column results in a column of characters (why do you think this is?)</li>
</ul>
</div>
</div>
</div>
</div>
<p>The type of the columns is important to be aware of because some fucntions in R expect that you feed them columns of a particular type. For example, we can extract the ‘drug concentration’ column from the second file we imported using the <code>$</code> operator.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conc</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">`drug concentration`</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in data$`drug concentration`: object of type 'closure' is not subsettable</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conc</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'conc' not found</code></pre>
</div>
<p>We can then extract the first two characters of each string in this column using <code>stringr::str_sub()</code>:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nums</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_sub</span><span class="op">(</span><span class="va">conc</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in stri_sub(string, from = start, to = end): object 'conc' not found</code></pre>
</div>
<p>But we can’t add one to this column:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conc</span> <span class="op">+</span> <span class="fl">1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'conc' not found</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="specifying-column-types">Specifying column types<a class="anchor" aria-label="anchor" href="#specifying-column-types"></a>
</h3>
<p>Since the guessing of types can result in unexpected behaviour, it’s best to always specify the types of data when you import it. You can do this in a verbose way:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_xlsx</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">".."</span>, <span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"readxl_example_2.xlsx"</span><span class="op">)</span>,</span>
<span>                           col_types <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: `path` does not exist: '/home/runner/work/cmri_R_workshop/cmri_R_workshop/site/built/../episodes/data/readxl_example_2.xlsx'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>function (..., list = character(), package = NULL, lib.loc = NULL, 
    verbose = getOption("verbose"), envir = .GlobalEnv, overwrite = TRUE) 
{
    fileExt &lt;- function(x) {
        db &lt;- grepl("\\.[^.]+\\.(gz|bz2|xz)$", x)
        ans &lt;- sub(".*\\.", "", x)
        ans[db] &lt;- sub(".*\\.([^.]+\\.)(gz|bz2|xz)$", "\\1\\2", 
            x[db])
        ans
    }
    my_read_table &lt;- function(...) {
        lcc &lt;- Sys.getlocale("LC_COLLATE")
        on.exit(Sys.setlocale("LC_COLLATE", lcc))
        Sys.setlocale("LC_COLLATE", "C")
        read.table(...)
    }
    stopifnot(is.character(list))
    names &lt;- c(as.character(substitute(list(...))[-1L]), list)
    if (!is.null(package)) {
        if (!is.character(package)) 
            stop("'package' must be a character vector or NULL")
    }
    paths &lt;- find.package(package, lib.loc, verbose = verbose)
    if (is.null(lib.loc)) 
        paths &lt;- c(path.package(package, TRUE), if (!length(package)) getwd(), 
            paths)
    paths &lt;- unique(normalizePath(paths[file.exists(paths)]))
    paths &lt;- paths[dir.exists(file.path(paths, "data"))]
    dataExts &lt;- tools:::.make_file_exts("data")
    if (length(names) == 0L) {
        db &lt;- matrix(character(), nrow = 0L, ncol = 4L)
        for (path in paths) {
            entries &lt;- NULL
            packageName &lt;- if (file_test("-f", file.path(path, 
                "DESCRIPTION"))) 
                basename(path)
            else "."
            if (file_test("-f", INDEX &lt;- file.path(path, "Meta", 
                "data.rds"))) {
                entries &lt;- readRDS(INDEX)
            }
            else {
                dataDir &lt;- file.path(path, "data")
                entries &lt;- tools::list_files_with_type(dataDir, 
                  "data")
                if (length(entries)) {
                  entries &lt;- unique(tools::file_path_sans_ext(basename(entries)))
                  entries &lt;- cbind(entries, "")
                }
            }
            if (NROW(entries)) {
                if (is.matrix(entries) &amp;&amp; ncol(entries) == 2L) 
                  db &lt;- rbind(db, cbind(packageName, dirname(path), 
                    entries))
                else warning(gettextf("data index for package %s is invalid and will be ignored", 
                  sQuote(packageName)), domain = NA, call. = FALSE)
            }
        }
        colnames(db) &lt;- c("Package", "LibPath", "Item", "Title")
        footer &lt;- if (missing(package)) 
            paste0("Use ", sQuote(paste("data(package =", ".packages(all.available = TRUE))")), 
                "\n", "to list the data sets in all *available* packages.")
        else NULL
        y &lt;- list(title = "Data sets", header = NULL, results = db, 
            footer = footer)
        class(y) &lt;- "packageIQR"
        return(y)
    }
    paths &lt;- file.path(paths, "data")
    for (name in names) {
        found &lt;- FALSE
        for (p in paths) {
            tmp_env &lt;- if (overwrite) 
                envir
            else new.env()
            if (file_test("-f", file.path(p, "Rdata.rds"))) {
                rds &lt;- readRDS(file.path(p, "Rdata.rds"))
                if (name %in% names(rds)) {
                  found &lt;- TRUE
                  if (verbose) 
                    message(sprintf("name=%s:\t found in Rdata.rds", 
                      name), domain = NA)
                  thispkg &lt;- sub(".*/([^/]*)/data$", "\\1", p)
                  thispkg &lt;- sub("_.*$", "", thispkg)
                  thispkg &lt;- paste0("package:", thispkg)
                  objs &lt;- rds[[name]]
                  lazyLoad(file.path(p, "Rdata"), envir = tmp_env, 
                    filter = function(x) x %in% objs)
                  break
                }
                else if (verbose) 
                  message(sprintf("name=%s:\t NOT found in names() of Rdata.rds, i.e.,\n\t%s\n", 
                    name, paste(names(rds), collapse = ",")), 
                    domain = NA)
            }
            if (file_test("-f", file.path(p, "Rdata.zip"))) {
                warning("zipped data found for package ", sQuote(basename(dirname(p))), 
                  ".\nThat is defunct, so please re-install the package.", 
                  domain = NA)
                if (file_test("-f", fp &lt;- file.path(p, "filelist"))) 
                  files &lt;- file.path(p, scan(fp, what = "", quiet = TRUE))
                else {
                  warning(gettextf("file 'filelist' is missing for directory %s", 
                    sQuote(p)), domain = NA)
                  next
                }
            }
            else {
                files &lt;- list.files(p, full.names = TRUE)
            }
            files &lt;- files[grep(name, files, fixed = TRUE)]
            if (length(files) &gt; 1L) {
                o &lt;- match(fileExt(files), dataExts, nomatch = 100L)
                paths0 &lt;- dirname(files)
                paths0 &lt;- factor(paths0, levels = unique(paths0))
                files &lt;- files[order(paths0, o)]
            }
            if (length(files)) {
                for (file in files) {
                  if (verbose) 
                    message("name=", name, ":\t file= ...", .Platform$file.sep, 
                      basename(file), "::\t", appendLF = FALSE, 
                      domain = NA)
                  ext &lt;- fileExt(file)
                  if (basename(file) != paste0(name, ".", ext)) 
                    found &lt;- FALSE
                  else {
                    found &lt;- TRUE
                    zfile &lt;- file
                    zipname &lt;- file.path(dirname(file), "Rdata.zip")
                    if (file.exists(zipname)) {
                      Rdatadir &lt;- tempfile("Rdata")
                      dir.create(Rdatadir, showWarnings = FALSE)
                      topic &lt;- basename(file)
                      rc &lt;- .External(C_unzip, zipname, topic, 
                        Rdatadir, FALSE, TRUE, FALSE, FALSE)
                      if (rc == 0L) 
                        zfile &lt;- file.path(Rdatadir, topic)
                    }
                    if (zfile != file) 
                      on.exit(unlink(zfile))
                    switch(ext, R = , r = {
                      library("utils")
                      sys.source(zfile, chdir = TRUE, envir = tmp_env)
                    }, RData = , rdata = , rda = load(zfile, 
                      envir = tmp_env), TXT = , txt = , tab = , 
                      tab.gz = , tab.bz2 = , tab.xz = , txt.gz = , 
                      txt.bz2 = , txt.xz = assign(name, my_read_table(zfile, 
                        header = TRUE, as.is = FALSE), envir = tmp_env), 
                      CSV = , csv = , csv.gz = , csv.bz2 = , 
                      csv.xz = assign(name, my_read_table(zfile, 
                        header = TRUE, sep = ";", as.is = FALSE), 
                        envir = tmp_env), found &lt;- FALSE)
                  }
                  if (found) 
                    break
                }
                if (verbose) 
                  message(if (!found) 
                    "*NOT* ", "found", domain = NA)
            }
            if (found) 
                break
        }
        if (!found) {
            warning(gettextf("data set %s not found", sQuote(name)), 
                domain = NA)
        }
        else if (!overwrite) {
            for (o in ls(envir = tmp_env, all.names = TRUE)) {
                if (exists(o, envir = envir, inherits = FALSE)) 
                  warning(gettextf("an object named %s already exists and will not be overwritten", 
                    sQuote(o)))
                else assign(o, get(o, envir = tmp_env, inherits = FALSE), 
                  envir = envir)
            }
            rm(tmp_env)
        }
    }
    invisible(names)
}
&lt;bytecode: 0x564fd40f9858&gt;
&lt;environment: namespace:utils&gt;</code></pre>
</div>
<p>Note that the last column (‘assay 3’) contains boolean (TRUE/FALSE) values, but we coerced it to a numeric type when we imported it. <code>R</code> prints a warning to let us know.</p>
</div>
<div class="section level3">
<h3 id="other-options">Other options<a class="anchor" aria-label="anchor" href="#other-options"></a>
</h3>
<p><code>readxl::read_xlsx()</code> also has lots of other options to deal with other aspects of data imports - for example, you can:</p>
<ul>
<li>Use the <code>sheet</code> and <code>range</code> named arguments to specifiy which parts of the sheet to import</li>
<li>Skip a number of header rows using the <code>skip</code> option,</li>
<li>Provide a vector of your own column names using the <code>col_names</code> argument</li>
<li>Pass <code>col_names=FALSE</code> to avoid using the first line of the file as your column names if your data doesn’t have column names</li>
</ul>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-readxl" class="callout-inner">
<h3 class="callout-title">Challenge 2: readxl<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>Open the file <code>human_codon_table.xlsx</code> in Excel. The columns of this table contain codons, frequencies of observations of each codon, and counts of each codon.</p>
<p>How do you think it should be imported?</p>
<p>Import this data, including the <code>col_names</code>, <code>skip</code>, <code>col_types</code>, <code>sheet</code> and <code>range</code> named arguments.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_xlsx</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">".."</span>, <span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"human_codon_table.xlsx"</span><span class="op">)</span>,</span>
<span>                  col_names <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"codon"</span>, <span class="st">"frequency"</span>, <span class="st">"count"</span><span class="op">)</span>,</span>
<span>                  skip<span class="op">=</span><span class="fl">0</span>,</span>
<span>                  col_types <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'text'</span>, <span class="st">'numeric'</span>, <span class="st">'numeric'</span><span class="op">)</span>,</span>
<span>                  sheet <span class="op">=</span> <span class="st">'human_codon_table'</span>,</span>
<span>                  range <span class="op">=</span> <span class="st">'A2:C65'</span> <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: `path` does not exist: '/home/runner/work/cmri_R_workshop/cmri_R_workshop/site/built/../episodes/data/human_codon_table.xlsx'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="reading-in-data-from-text-files-readr"><h2 class="section-heading">Reading in data from text files: readr<a class="anchor" aria-label="anchor" href="#reading-in-data-from-text-files-readr"></a>
</h2>
<hr class="half-width">
<p>Alternatively, you might have tabular data in a text file. In these kinds of files, each row of the file is a row of the table, and usually either tabs or commas separate the values in each column.</p>
<p>If you have comma-separated data (like a <code>.csv</code> file) the <code>readr::read_csv()</code> function will be most convenient, and if your data is tab-separated (like a <code>.tsv</code> file), you’ll want <code>readr::read_tsv()</code>. If you have a different delimiter, you can use <code>readr::read_delim(file, delim=delimiter)</code>, where <code>delimiter</code> is a string containing your delimiter.</p>
<p>The syntax is very similar to <code>read_xlsx()</code>, and you should specify the column types here as well. Here I use the short form of the column specification - ‘<code>c</code>’ for character and ‘<code>i</code>’ for integer.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">".."</span>, <span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"readr_example_1.tsv"</span><span class="op">)</span>,</span>
<span>                           col_types <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"cci"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: '/home/runner/work/cmri_R_workshop/cmri_R_workshop/site/built/../episodes/data/readr_example_1.tsv' does not exist.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>function (..., list = character(), package = NULL, lib.loc = NULL, 
    verbose = getOption("verbose"), envir = .GlobalEnv, overwrite = TRUE) 
{
    fileExt &lt;- function(x) {
        db &lt;- grepl("\\.[^.]+\\.(gz|bz2|xz)$", x)
        ans &lt;- sub(".*\\.", "", x)
        ans[db] &lt;- sub(".*\\.([^.]+\\.)(gz|bz2|xz)$", "\\1\\2", 
            x[db])
        ans
    }
    my_read_table &lt;- function(...) {
        lcc &lt;- Sys.getlocale("LC_COLLATE")
        on.exit(Sys.setlocale("LC_COLLATE", lcc))
        Sys.setlocale("LC_COLLATE", "C")
        read.table(...)
    }
    stopifnot(is.character(list))
    names &lt;- c(as.character(substitute(list(...))[-1L]), list)
    if (!is.null(package)) {
        if (!is.character(package)) 
            stop("'package' must be a character vector or NULL")
    }
    paths &lt;- find.package(package, lib.loc, verbose = verbose)
    if (is.null(lib.loc)) 
        paths &lt;- c(path.package(package, TRUE), if (!length(package)) getwd(), 
            paths)
    paths &lt;- unique(normalizePath(paths[file.exists(paths)]))
    paths &lt;- paths[dir.exists(file.path(paths, "data"))]
    dataExts &lt;- tools:::.make_file_exts("data")
    if (length(names) == 0L) {
        db &lt;- matrix(character(), nrow = 0L, ncol = 4L)
        for (path in paths) {
            entries &lt;- NULL
            packageName &lt;- if (file_test("-f", file.path(path, 
                "DESCRIPTION"))) 
                basename(path)
            else "."
            if (file_test("-f", INDEX &lt;- file.path(path, "Meta", 
                "data.rds"))) {
                entries &lt;- readRDS(INDEX)
            }
            else {
                dataDir &lt;- file.path(path, "data")
                entries &lt;- tools::list_files_with_type(dataDir, 
                  "data")
                if (length(entries)) {
                  entries &lt;- unique(tools::file_path_sans_ext(basename(entries)))
                  entries &lt;- cbind(entries, "")
                }
            }
            if (NROW(entries)) {
                if (is.matrix(entries) &amp;&amp; ncol(entries) == 2L) 
                  db &lt;- rbind(db, cbind(packageName, dirname(path), 
                    entries))
                else warning(gettextf("data index for package %s is invalid and will be ignored", 
                  sQuote(packageName)), domain = NA, call. = FALSE)
            }
        }
        colnames(db) &lt;- c("Package", "LibPath", "Item", "Title")
        footer &lt;- if (missing(package)) 
            paste0("Use ", sQuote(paste("data(package =", ".packages(all.available = TRUE))")), 
                "\n", "to list the data sets in all *available* packages.")
        else NULL
        y &lt;- list(title = "Data sets", header = NULL, results = db, 
            footer = footer)
        class(y) &lt;- "packageIQR"
        return(y)
    }
    paths &lt;- file.path(paths, "data")
    for (name in names) {
        found &lt;- FALSE
        for (p in paths) {
            tmp_env &lt;- if (overwrite) 
                envir
            else new.env()
            if (file_test("-f", file.path(p, "Rdata.rds"))) {
                rds &lt;- readRDS(file.path(p, "Rdata.rds"))
                if (name %in% names(rds)) {
                  found &lt;- TRUE
                  if (verbose) 
                    message(sprintf("name=%s:\t found in Rdata.rds", 
                      name), domain = NA)
                  thispkg &lt;- sub(".*/([^/]*)/data$", "\\1", p)
                  thispkg &lt;- sub("_.*$", "", thispkg)
                  thispkg &lt;- paste0("package:", thispkg)
                  objs &lt;- rds[[name]]
                  lazyLoad(file.path(p, "Rdata"), envir = tmp_env, 
                    filter = function(x) x %in% objs)
                  break
                }
                else if (verbose) 
                  message(sprintf("name=%s:\t NOT found in names() of Rdata.rds, i.e.,\n\t%s\n", 
                    name, paste(names(rds), collapse = ",")), 
                    domain = NA)
            }
            if (file_test("-f", file.path(p, "Rdata.zip"))) {
                warning("zipped data found for package ", sQuote(basename(dirname(p))), 
                  ".\nThat is defunct, so please re-install the package.", 
                  domain = NA)
                if (file_test("-f", fp &lt;- file.path(p, "filelist"))) 
                  files &lt;- file.path(p, scan(fp, what = "", quiet = TRUE))
                else {
                  warning(gettextf("file 'filelist' is missing for directory %s", 
                    sQuote(p)), domain = NA)
                  next
                }
            }
            else {
                files &lt;- list.files(p, full.names = TRUE)
            }
            files &lt;- files[grep(name, files, fixed = TRUE)]
            if (length(files) &gt; 1L) {
                o &lt;- match(fileExt(files), dataExts, nomatch = 100L)
                paths0 &lt;- dirname(files)
                paths0 &lt;- factor(paths0, levels = unique(paths0))
                files &lt;- files[order(paths0, o)]
            }
            if (length(files)) {
                for (file in files) {
                  if (verbose) 
                    message("name=", name, ":\t file= ...", .Platform$file.sep, 
                      basename(file), "::\t", appendLF = FALSE, 
                      domain = NA)
                  ext &lt;- fileExt(file)
                  if (basename(file) != paste0(name, ".", ext)) 
                    found &lt;- FALSE
                  else {
                    found &lt;- TRUE
                    zfile &lt;- file
                    zipname &lt;- file.path(dirname(file), "Rdata.zip")
                    if (file.exists(zipname)) {
                      Rdatadir &lt;- tempfile("Rdata")
                      dir.create(Rdatadir, showWarnings = FALSE)
                      topic &lt;- basename(file)
                      rc &lt;- .External(C_unzip, zipname, topic, 
                        Rdatadir, FALSE, TRUE, FALSE, FALSE)
                      if (rc == 0L) 
                        zfile &lt;- file.path(Rdatadir, topic)
                    }
                    if (zfile != file) 
                      on.exit(unlink(zfile))
                    switch(ext, R = , r = {
                      library("utils")
                      sys.source(zfile, chdir = TRUE, envir = tmp_env)
                    }, RData = , rdata = , rda = load(zfile, 
                      envir = tmp_env), TXT = , txt = , tab = , 
                      tab.gz = , tab.bz2 = , tab.xz = , txt.gz = , 
                      txt.bz2 = , txt.xz = assign(name, my_read_table(zfile, 
                        header = TRUE, as.is = FALSE), envir = tmp_env), 
                      CSV = , csv = , csv.gz = , csv.bz2 = , 
                      csv.xz = assign(name, my_read_table(zfile, 
                        header = TRUE, sep = ";", as.is = FALSE), 
                        envir = tmp_env), found &lt;- FALSE)
                  }
                  if (found) 
                    break
                }
                if (verbose) 
                  message(if (!found) 
                    "*NOT* ", "found", domain = NA)
            }
            if (found) 
                break
        }
        if (!found) {
            warning(gettextf("data set %s not found", sQuote(name)), 
                domain = NA)
        }
        else if (!overwrite) {
            for (o in ls(envir = tmp_env, all.names = TRUE)) {
                if (exists(o, envir = envir, inherits = FALSE)) 
                  warning(gettextf("an object named %s already exists and will not be overwritten", 
                    sQuote(o)))
                else assign(o, get(o, envir = tmp_env, inherits = FALSE), 
                  envir = envir)
            }
            rm(tmp_env)
        }
    }
    invisible(names)
}
&lt;bytecode: 0x564fd40f9858&gt;
&lt;environment: namespace:utils&gt;</code></pre>
</div>
<p>You can read more about the column specification for <code>readr</code> functions <a href="https://r4ds.had.co.nz/data-import.html" class="external-link">here</a>.</p>
<p>The other options for <code>read_csv()</code> are also similar to those for <code>read_xslx</code>, including <code>col_names</code> and <code>skip</code>.</p>
<div class="section level3">
<h3 id="reading-multiple-files">Reading multiple files<a class="anchor" aria-label="anchor" href="#reading-multiple-files"></a>
</h3>
<p>If you have multiple files with the same columns and column types, you can pass a vector of file paths rather than an atomic vector. To add an extra column with the file name (so you know which rows came from which files), use the <code>id</code> parameter.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"sim_0_counts.txt"</span><span class="op">)</span>,</span>
<span>           <span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"episodes"</span>, <span class="st">"data"</span>, <span class="st">"sim_1_counts.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_tsv</span><span class="op">(</span><span class="va">files</span>, col_types <span class="op">=</span> <span class="st">'cci'</span>, id<span class="op">=</span><span class="st">"file"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: '/home/runner/work/cmri_R_workshop/cmri_R_workshop/site/built/episodes/data/sim_0_counts.txt' does not exist.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                                                                            
1 function (..., list = character(), package = NULL, lib.loc = NULL,        
2     verbose = getOption("verbose"), envir = .GlobalEnv, overwrite = TRUE) 
3 {                                                                         
4     fileExt &lt;- function(x) {                                              
5         db &lt;- grepl("\\\\.[^.]+\\\\.(gz|bz2|xz)$", x)                     
6         ans &lt;- sub(".*\\\\.", "", x)                                      </code></pre>
</div>
</div>
</section><section id="resources"><h2 class="section-heading">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf" class="external-link">Data import cheat sheet</a></li>
<li><a href="https://r4ds.had.co.nz/data-import.html" class="external-link">Data import section from R for data science</a></li>
<li><a href="https://readxl.tidyverse.org/" class="external-link">readxl documentation</a></li>
<li><a href="https://readr.tidyverse.org/" class="external-link">readr documentation</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>readxl::read_xlsx()</code> to import data from excel</li>
<li>Use <code>readr::read_tsv()</code>, <code>readr::read_csv()</code>, <code>readr::read_delim()</code> to import data from delimited text files</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-tidying-data"><p>Content from <a href="tidying-data.html">Tidy data</a></p>
<hr>
<p> Last updated on 2022-11-23 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/tidying-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is tidy data?</li>
<li>How can we pivot data frames to make them tidy?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the principles of tidy data</li>
<li>Use <code>pivot_longer()</code> and <code>pivot_wider()</code> to create longer or wider data frames</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="tidy-data"><h2 class="section-heading">Tidy data<a class="anchor" aria-label="anchor" href="#tidy-data"></a>
</h2>
<hr class="half-width">
<p>When recording observations, we don’t often give that much thought to how we record the data. Usually we enter data into an excel spreadsheet and care most about entering the data in the easiest way. However, this often results in ‘messy’ data that requires a little bit of massaging before analysis.</p>
<p>There are many possible ways to structure a dataset. For example, if we conducted an experiment where we made two sequencing libraries, in which we have counted the instances of six different barcodes, we could structure the data like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 7
  library    b1    b2    b3    b4    b5    b6
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1 lib1      384   103   787    99   811   773
2 lib2      108   114   797   391   386   396</code></pre>
</div>
<p>In this table, the counts for each barcode are stored in a separate column. The ‘library’ column tells us which library the counts on each row are from.</p>
<p>Conversely, we could keep the counts for each library in a separate column, and the rows can tell us which barcode is being counted:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 3
  barcode  lib1  lib2
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
1 b1        384   108
2 b2        103   114
3 b3        787   797
4 b4         99   391
5 b5        811   386
6 b6        773   396</code></pre>
</div>
<p>We could even structure the table like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 13
  library `384` `103` `787` `99`  `811` `773` `108` `114` `797` `391` `386`
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 lib1    b1    b2    b3    b4    b5    b6    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
2 lib2    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  b1    b2    b3    b4    b5   
# … with 1 more variable: `396` &lt;chr&gt;</code></pre>
</div>
<p>This is one of the least intuitive ways to structure the data - the columns are the counts (except for the library column), and the rows tell us which barcode had which count.</p>
<p>These are all examples of messy ways to structure the data. There are usually very many ways to make the data messy, but only one <a href="https://vita.had.co.nz/papers/tidy-data.pdf" class="external-link">‘Tidy’ format</a>. Being tidy means a dataset has:</p>
<ol style="list-style-type: decimal">
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table.</li>
</ol>
<p>Here, variables record all the values that measure the same attribute (for example library, sample, count), and an observation contains all the measurements on a single unit (like a sequencing run, or a single experiment). Each observational unit (like independent experiments with different variables) should get its own table. This just means that if we ran another experiment with different variables, it should go in a different table.</p>
<p>In our this case, the tidy version looks like this:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 12 × 3
   library barcode count
   &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;
 1 lib1    b1        384
 2 lib1    b2        103
 3 lib1    b3        787
 4 lib1    b4         99
 5 lib1    b5        811
 6 lib1    b6        773
 7 lib2    b1        108
 8 lib2    b2        114
 9 lib2    b3        797
10 lib2    b4        391
11 lib2    b5        386
12 lib2    b6        396</code></pre>
</div>
<p>This is tidy because each column represents a variable (library, barcode and count), each row is an observation (count for a given library and barcode), and we have all the data from this experiment in the one table.</p>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion1"></a>
</h3>
<div class="callout-content">
<p>Open the excel file <code>readr/untidy_data.xlsx</code>. Do you think this dataset is in a tidy format? Why/why not?</p>
<p>List ways that it could be improved.</p>

</div>
</div>
</div>
</section><section id="tidyr-for-tidying-data"><h2 class="section-heading">
<code>tidyr</code> for tidying data<a class="anchor" aria-label="anchor" href="#tidyr-for-tidying-data"></a>
</h2>
<hr class="half-width">
<p>So if tidy data is the goal, how do we get there? One way is to go back and edit the original file manually. But this is problematic for several reasons:</p>
<ul>
<li>You should treat your original data as read-only, and never change it</li>
<li>Manual edits are not reproducible</li>
<li>Manual edits can be time-consuming</li>
</ul>
<p>Instead, we can use tools from the <code>tidyr</code> and <code>dplyr</code> packages for tidying and manipulating tables of data.</p>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="data-pipelines-with-pipes" class="callout-inner">
<h3 class="callout-title">Data pipelines with pipes (<code>%&gt;%</code>)<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>Before we get to <code>tidyr</code> functions, I will first do a brief detour into what is now common practice in the R community: using pipes to build data pipelines.</p>
<p>Let’s consider an example. Say that we have a vector called <code>counts</code> that represents the counts for several vectors in a selection experiment, and we wanted to identify the unique counts, take their log, and then take the mean.</p>
<p>One way to do this is to call each function sequentially, assigning each to an intermediate variable:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate binomial data to play with</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">50</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unique_counts</span> <span class="op">&lt;-</span> <span class="fu">unique</span><span class="op">(</span><span class="va">counts</span><span class="op">)</span></span>
<span><span class="va">log_counts</span> <span class="op">&lt;-</span> <span class="fu">log</span><span class="op">(</span><span class="va">unique_counts</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">mean_log_counts</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">log_counts</span><span class="op">)</span></span></code></pre>
</div>
<p>This is a bit inefficient because we’ve had to type out the same variable name twice. I often find that when I do things this way, when I change one of the steps but forget to change both the variable names, and end up with weird bugs.</p>
<p>An alternative is to nest all the function calls inside each other:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_log_counts</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">log</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">counts</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Hopefully you can see why this isn’t a good idea - nested function calls can get very messy, very quickly, especially if the functions have multiple arguments (like <code>log()</code>).</p>
<p>A third way is using the pipe <code>%&gt;%</code> operator, which feeds the output of each function into the next:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_log_counts</span> <span class="op">&lt;-</span> <span class="va">counts</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">log</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mean</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>This version of the code is cleaner, and the top-to-bottom flow makes the order the functions are applied in more obvious. This way of doing things is very popular, and you’ll see it a lot (for example, in code sample on stack overflow).</p>
<p>There are a few complications to using the pipe which you can read more about <a href="https://r4ds.had.co.nz/pipes.html" class="external-link">here</a>. One that’s worth being aware of is that using lots of pipes can result in long pipelines, and if something goes wrong somewhere in the middle it can be hard to track down exactly where the issue is. In this case, you can use a few intermediate variables to try to figure out which step is going wrong.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="pivoting">Pivoting<a class="anchor" aria-label="anchor" href="#pivoting"></a>
</h3>
<p>The variants on the tables that we saw above are all generated by pivoting the tidy (or ‘long’) version to untidy (in this case, ‘wide’) versions. For example, looking at <code>table1b</code>:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table1b</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 3
  barcode  lib1  lib2
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
1 b1        384   108
2 b2        103   114
3 b3        787   797
4 b4         99   391
5 b5        811   386
6 b6        773   396</code></pre>
</div>
<p>Another way to think about tidyness is if the names of the column can reflect the data contained in them. It’s a bit misleading to call the columns <code>lib1</code> and <code>lib2</code>, they actually store counts (and not some other property of the library, such as the barcodes it contains).</p>
<p>We can see that if we were to restructure the lib1 and lib2 columns into two different columns, one that tell us from which library the count came, and one that contains the count value, the dataset would be tidy.</p>
<div class="section level4">
<h4 id="consolidating-columns-with-pivot_longer">Consolidating columns with <code>pivot_longer()</code>
<a class="anchor" aria-label="anchor" href="#consolidating-columns-with-pivot_longer"></a>
</h4>
<p>Knowing this, we can tidy the dataset up using <code>pivot_longer()</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table1b</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">lib1</span><span class="op">:</span><span class="va">lib2</span>, names_to<span class="op">=</span><span class="st">"library"</span>, values_to<span class="op">=</span><span class="st">"count"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 12 × 3
   barcode library count
   &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;
 1 b1      lib1      384
 2 b1      lib2      108
 3 b2      lib1      103
 4 b2      lib2      114
 5 b3      lib1      787
 6 b3      lib2      797
 7 b4      lib1       99
 8 b4      lib2      391
 9 b5      lib1      811
10 b5      lib2      386
11 b6      lib1      773
12 b6      lib2      396</code></pre>
</div>
<p>We can tell that this data is tidy because the column names accurately reflect the data they contain: the count column stores counts, the library column tells us which library the counts came from, and the barcode column tells us which barcode we’re measuring.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/pivot_longer_R.png" alt="" class="figure mx-auto d-block"><figcaption>Pivoting longer</figcaption></figure>
</div>
<div class="section level4">
<h4 id="creating-more-columns-with-pivot_wider">Creating more columns with <code>pivot_wider()</code>
<a class="anchor" aria-label="anchor" href="#creating-more-columns-with-pivot_wider"></a>
</h4>
<p>We can also do the reverse operation using <code>pivot_wider()</code> (this was how I generated the untidy versions of the tables). But haven’t we just been saying that we should always aspire to keep our data tidy? So why would we ever want to do this?</p>
<p>When working with data in <code>R</code>, the long format does tend to be the most useful, because this is the format that most functions expect data to be in. However, if you want to display the data for a person (rather than for a function in code), the wide format can sometimes be useful for making comparisions. For example, we can easily compare the counts for each barcode in the two libraries in <code>table1b</code>, but the comparison is easy for a person to make when the table is in a long form.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 12 × 3
   library barcode count
   &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;
 1 lib1    b1        384
 2 lib1    b2        103
 3 lib1    b3        787
 4 lib1    b4         99
 5 lib1    b5        811
 6 lib1    b6        773
 7 lib2    b1        108
 8 lib2    b2        114
 9 lib2    b3        797
10 lib2    b4        391
11 lib2    b5        386
12 lib2    b6        396</code></pre>
</div>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/pivot_wider_R.png" alt="" class="figure mx-auto d-block"><figcaption>Pivoting wider</figcaption></figure><p>We can pivot our long table to a wide one using <code>pivot_longer()</code>.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table1</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"library"</span>, values_from <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 3
  barcode  lib1  lib2
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
1 b1        384   108
2 b2        103   114
3 b3        787   797
4 b4         99   391
5 b5        811   386
6 b6        773   396</code></pre>
</div>
</div>
</div>
</section><section id="other-tidyr-functions"><h2 class="section-heading">Other <code>tidyr</code> functions<a class="anchor" aria-label="anchor" href="#other-tidyr-functions"></a>
</h2>
<hr class="half-width">
<p>Tidyr also has a number of other useful functions for tidying up datasets, which include: - Combining columns where multiples pieces of information are spread out (<code>unite()</code>), or spreading out columns which contain data that should be in seperate column (<code>separate()</code>) - Adding extra rows to create all possible combinations of the values in multiple columns (<code>expand()</code> and <code>complete</code>) - Handling missing values, for example replacing <code>NA</code> values with something else (<code>replace_na()</code>) or dropping rows that contain <code>NA</code> (<code>drop_na()</code>) - Nesting data within list-columns (<code>nest()</code>), and unnesting such colunns (<code>unnest()</code>)</p>
<p>While useful, I tend to use these less frequently compared to the pivioting functions, so I leave these to you to explore on your own. You can get an overview of these functions on the <a href="https://github.com/rstudio/cheatsheets/blob/main/tidyr.pdf" class="external-link">tidyr cheatsheet</a>, and in the <a href="https://tidyr.tidyverse.org/" class="external-link">tidyr documentation</a>.</p>
</section><section id="resources-and-acknowledgments"><h2 class="section-heading">Resources and acknowledgments<a class="anchor" aria-label="anchor" href="#resources-and-acknowledgments"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://cloud.r-project.org/web/packages/tidyr/vignettes/tidy-data.html" class="external-link">Tidy data vignette</a></li>
<li><a href="https://vita.had.co.nz/papers/tidy-data.pdf" class="external-link">Tidy data paper</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/blob/main/tidyr.pdf" class="external-link">tidyr cheatsheet</a></li>
<li>I’ve borrowed figures (and inspiration) from the excellent <a href="https://ab604.github.io/docs/coding-together-2019/data-wrangle-1.html" class="external-link">coding togetheR course material</a>
</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Tidy data is often easier to work with</li>
<li>Pivot long to wide with <code>pivot_wider()</code>
</li>
<li>Pivot wide to long with <code>pivot_longer()</code>
</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-manipulating-data"><p>Content from <a href="manipulating-data.html">Data wrangling</a></p>
<hr>
<p> Last updated on 2022-11-23 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/manipulating-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the main <code>dplyr</code> verbs?</li>
<li>How can I analyse data within groups?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Know how to use the main <code>dplyr</code> verbs</li>
<li>Use <code>group_by()</code> to aggregate and manipulate within groups</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="manipulating-data-with-dplyr"><h2 class="section-heading">Manipulating data with <code>dplyr</code><a class="anchor" aria-label="anchor" href="#manipulating-data-with-dplyr"></a>
</h2>
<hr class="half-width">
<p>So once we have our data in a tidy format, what do we do with it? For analysis, I often turn to the <code>dplyr</code> package, which contains several useful functions for manipulating tables of data.</p>
<p>To illustrate the functions of this package, we’ll use a dataset of weather observations in Brisbane and Sydney from <a href="http://www.bom.gov.au/climate/data/" class="external-link">the Bureau of Meterology</a>.</p>
<p>These files are called <code>weather_brisbane.csv</code> and <code>weather_sydney.csv</code>.</p>
<p>First, we load both files using <code>readr</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load tidyverse</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.4.1 
✔ readr   2.1.3      ✔ forcats 0.5.2 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data files</span></span>
<span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">".."</span>, <span class="st">"episodes"</span>, <span class="st">"data"</span><span class="op">)</span> <span class="co"># change this for your computer</span></span>
<span><span class="va">data_files</span> <span class="op">&lt;-</span> <span class="fu">file.path</span><span class="op">(</span><span class="va">data_dir</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"weather_sydney.csv"</span>, <span class="st">"weather_brisbane.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># column types</span></span>
<span><span class="va">col_types</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="fu">col_date</span><span class="op">(</span>format<span class="op">=</span><span class="st">"%Y-%m-%d"</span><span class="op">)</span>,</span>
<span>  min_temp_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_temp_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rainfall_mm <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  evaporation_mm <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  sunshine_hours <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dir_max_wind_gust <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  speed_max_wind_gust_kph <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  time_max_wind_gust <span class="op">=</span> <span class="fu">col_time</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  temp_9am_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rel_humid_9am_pc <span class="op">=</span> <span class="fu">col_integer</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cloud_amount_9am_oktas <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_direction_9am <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_speed_9am_kph <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  MSL_pressure_9am_hPa <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  temp_3pm_c <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rel_humid_3pm_pc <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cloud_amount_3pm_oktas <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_direction_3pm <span class="op">=</span> <span class="fu">col_character</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  wind_speed_3pm_kph <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  MSL_pressure_3pm_hPa <span class="op">=</span> <span class="fu">col_double</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read in data</span></span>
<span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_csv</span><span class="op">(</span><span class="va">data_files</span>, skip<span class="op">=</span><span class="fl">10</span>, </span>
<span>                           col_types<span class="op">=</span><span class="va">col_types</span>, col_names <span class="op">=</span> <span class="fu">names</span><span class="op">(</span><span class="va">col_types</span><span class="op">)</span>,</span>
<span>                           id<span class="op">=</span><span class="st">"file"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: '/home/runner/work/cmri_R_workshop/cmri_R_workshop/site/built/../episodes/data/weather_sydney.csv' does not exist.</code></pre>
</div>
<div class="section level3">
<h3 id="creating-summaries-with-summarise">Creating summaries with <code>summarise()</code>
<a class="anchor" aria-label="anchor" href="#creating-summaries-with-summarise"></a>
</h3>
<p>First, we would like to know what the mean minimum and maximum temperatures were overall. For this, we can use <code>summarise()</code>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_min_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span>,</span>
<span>            mean_max_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">max_temp_c</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in summarise(., mean_min_temp = mean(min_temp_c), mean_max_temp = mean(max_temp_c)): object 'weather' not found</code></pre>
</div>
<p>Notice that the mean_max_temp is <code>NA</code>, because we had some <code>NA</code> values in this column. In <code>R</code> we use <code>NA</code> for missing values. So how does one take the mean of some numbers, some of which are missing? We can’t so the answer is also a missing value. We can, however, tell the <code>mean()</code> function to ignore the missing values using <code>na.rm=TRUE</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_min_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span>,</span>
<span>            mean_max_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">max_temp_c</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in summarise(., mean_min_temp = mean(min_temp_c), mean_max_temp = mean(max_temp_c, : object 'weather' not found</code></pre>
</div>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-medians" class="callout-inner">
<h3 class="callout-title">Challenge 1: medians<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>What is the median minimum and maximum temperature in the weather observations?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median_min_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span>,</span>
<span>            median_max_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">max_temp_c</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in summarise(., median_min_temp = median(min_temp_c), median_max_temp = median(max_temp_c, : object 'weather' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><code>dplyr</code> also has some special functions that are designed to be used inside of other functions. For example, if we want to know how many observations there were of the minimum and maximum temperatures, we could use <code>n()</code>. Or if we wanted to know how many different directions the maximum wind gust had, we can use <code>n_distinct()</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n_days_observed <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>            n_wind_dir <span class="op">=</span> <span class="fu">n_distinct</span><span class="op">(</span><span class="va">dir_max_wind_gust</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in summarise(., n_days_observed = n(), n_wind_dir = n_distinct(dir_max_wind_gust)): object 'weather' not found</code></pre>
</div>
<div class="section level4">
<h4 id="grouped-summaries-with-group_by">Grouped summaries with <code>group_by()</code>
<a class="anchor" aria-label="anchor" href="#grouped-summaries-with-group_by"></a>
</h4>
<p>However, all of these summaries have combined the observations for Sydney and Brisbane. It probably makes sense to group the observations by city, and then compute the summary statistics. For this, we can use <code>group_by()</code>.</p>
<p>If you use <code>group_by()</code> on a tibble, it doesn’t actually look like it changes that much.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in group_by(., file): object 'weather' not found</code></pre>
</div>
<p>The only difference is that when you print it out, it tells you that it’s grouped by file. However, a grouped data frame interacts differently with other <code>dplyr</code> verbs, such as <code>summary</code>.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">file</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median_min_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span>,</span>
<span>            median_max_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">max_temp_c</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in group_by(., file): object 'weather' not found</code></pre>
</div>
<p>Now we get the median temperature for both Sydney and Brisbane.</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-medians" class="callout-inner">
<h3 class="callout-title">Challenge 2: medians<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>What is the maximum wind speed (<code>speed_max_wind_gust_kph</code>) in each direction (<code>dir_max_wind_gust</code>) for each city?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">file</span>, <span class="va">dir_max_wind_gust</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>max_max_wind_gust <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">speed_max_wind_gust_kph</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in group_by(., file, dir_max_wind_gust): object 'weather' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-medians" class="callout-inner">
<h3 class="callout-title">Challenge 2: medians<em> (continued)</em><a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>Can you pivot the table wider to make it easier to compare between directions and cities?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">file</span>, <span class="va">dir_max_wind_gust</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>max_max_wind_gust <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">speed_max_wind_gust_kph</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>id_cols<span class="op">=</span><span class="va">file</span>, names_from <span class="op">=</span> <span class="st">"dir_max_wind_gust"</span>, values_from <span class="op">=</span> <span class="st">"max_max_wind_gust"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in group_by(., file, dir_max_wind_gust): object 'weather' not found</code></pre>
</div>
<p>Do you prefer the long or wide form of the table?</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="creating-new-columns-with-mutate">Creating new columns with <code>mutate()</code>
<a class="anchor" aria-label="anchor" href="#creating-new-columns-with-mutate"></a>
</h3>
<p>It’s kind of annoying that we have the whole file names, rather than just the names of the cities. To fix this, we can create (or overwrite) columns with <code>mutate()</code>.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/dplyr-mutate-16-10-2019.png" alt="" class="figure mx-auto d-block"><figcaption><code>dplyr::mutate()</code> <a href="https://ab604.github.io/docs/coding-together-2019" class="external-link">image credit</a></figcaption></figure><p>For example, the <code>stringr::str_extract()</code> function extracts a matching pattern from a string:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_extract</span><span class="op">(</span><span class="va">data_files</span>, <span class="st">"sydney|brisbane"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "sydney"   "brisbane"</code></pre>
</div>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>The second argument to <code>str_extract()</code> is a regular expression, or <em>regex</em>. Using regular expressions is a hugely flexible way to specify a pattern to match in a string, but it’s a somewhat complicated topic that I won’t go into here. If you’re interested in learning more, you can look at the <a href="https://stringr.tidyverse.org/articles/regular-expressions.html" class="external-link">stringr documentation on regular expressions</a>.</p>
</div>
</div>
</div>
<p>We can use <code>mutate()</code> to apply the <code>str_extract()</code> function to the <code>file</code> column</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>city <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_extract</span><span class="op">(</span><span class="va">file</span>, <span class="st">"sydney|brisbane"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in mutate(., city = stringr::str_extract(file, "sydney|brisbane")): object 'weather' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'weather' not found</code></pre>
</div>
<p>Now if we repeat the same summary as before, we get an output that’s a bit easier to read.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median_min_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span>,</span>
<span>            median_max_temp <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">max_temp_c</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in group_by(., city): object 'weather' not found</code></pre>
</div>
<div class="section level4">
<h4 id="mutating-multiple-columns-with-across">Mutating multiple columns with <code>across()</code>
<a class="anchor" aria-label="anchor" href="#mutating-multiple-columns-with-across"></a>
</h4>
<p>Let’s imagine that the calibration was wrong for both temperature sensors, and all the temperature measurements are out by 1°C. We’d like to add 1 to each of the temperature measurements. There are multiple columns that contain temperatures, so we could do this:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>min_temp_c <span class="op">=</span> <span class="va">min_temp_c</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>         max_temp_c <span class="op">=</span> <span class="va">max_temp_c</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>         temp_9am_c <span class="op">=</span> <span class="va">temp_9am_c</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>         temp_3pm_c <span class="op">=</span> <span class="va">temp_3pm_c</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in mutate(., min_temp_c = min_temp_c + 1, max_temp_c = max_temp_c + : object 'weather' not found</code></pre>
</div>
<p>But it’s a bit annoying to type out each column. Instead, we can use <code>across()</code> inside <code>mutate()</code> to apply the same transformation to all columns whose name contains the string “temp”. The syntax is a little complicated, so don’t worry if you don’t get it straight away. We use the <code>contains()</code> function to get the columns we want (by matching the regex “temp”), and then to each of these columns we add one - the <code>.</code> will be replaced by the name of each column when the expression is evaluated.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, <span class="op">~</span><span class="va">.</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in mutate(., across(contains("temp"), ~. + 1)): object 'weather' not found</code></pre>
</div>
<p>Equivalently, we could also use a function to make the transformation.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"temp"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">return</span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in mutate(., across(contains("temp"), function(x) {: object 'weather' not found</code></pre>
</div>
</div>
</div>
<div class="section level3">
<h3 id="filtering-rows-with-filter">Filtering rows with <code>filter()</code>
<a class="anchor" aria-label="anchor" href="#filtering-rows-with-filter"></a>
</h3>
<p>Let’s say that now we want information about days that were cloudy - for example, those where there were fewer than 10 sunshine hours. We can use <code>filter()</code> to get only those rows.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/dplyr_filter.png" alt="" class="figure mx-auto d-block"><figcaption><code>dplyr::filter()</code> <a href="https://ab604.github.io/docs/coding-together-2019" class="external-link">image credit</a></figcaption></figure><div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sunshine_hours</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in filter(., sunshine_hours &lt; 10): object 'weather' not found</code></pre>
</div>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-is-it-better-to-live-in-sydney-or-brisbane" class="callout-inner">
<h3 class="callout-title">Challenge 3: Is it better to live in Sydney or Brisbane?<a class="anchor" aria-label="anchor" href="#challenge4"></a>
</h3>
<div class="callout-content">
<p>Combine <code>filter()</code> with <code>group_by()</code>,<code>summarise()</code> and <code>n()</code> to count the number of days when there were more than 10 hours of sunshine in each city.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sunshine_hours</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n_days <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in filter(., sunshine_hours &gt; 10): object 'weather' not found</code></pre>
</div>
<p>There were more days with more than 10 hours of sunlight in Brisbane than in Sydney. I’ll let you draw your own conclusions.</p>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="complex-filters-with-case_when">Complex filters with <code>case_when()</code>
<a class="anchor" aria-label="anchor" href="#complex-filters-with-case_when"></a>
</h4>
<p>Let’s say we wanted to keep only the rows from sunny, warm days and cloudy, cold days. We could do this just with one logical expression.</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">(</span><span class="va">sunshine_hours</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&gt;</span> <span class="fl">25</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">sunshine_hours</span> <span class="op">&lt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&lt;</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in filter(., (sunshine_hours &gt; 10 &amp; max_temp_c &gt; 25) | (sunshine_hours &lt; : object 'weather' not found</code></pre>
</div>
<p>But you can imagine that with more conditions, this can get a bit messy. I prefer to use <code>case_when()</code> in such situations:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&gt;</span> <span class="fl">25</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&lt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&lt;</span> <span class="fl">15</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in filter(., case_when(sunshine_hours &gt; 10 &amp; max_temp_c &gt; 25 ~ TRUE, : object 'weather' not found</code></pre>
</div>
<p>Essentially, <code>case_when()</code> looks at each condition in turn, and if the left part of the expression (before the <code>~</code>) evaulates to <code>TRUE</code>, then it returns whatever is on the right of the <code>~</code>.</p>
<ul>
<li>We first ask if this row has more than ten sunshine hours and a maximum temperature of more than 25 - if this is the case, we return <code>TRUE</code> (and <code>filter()</code> retains this row).<br>
</li>
<li>Next, we ask if the row has less than ten sunshine hours and a maximum temperature of less than 15, in which case we also return <code>TRUE</code>.<br>
</li>
<li>If both these statements are <code>FALSE</code>, then the <code>TRUE</code> on the next line ensures that we don’t keep those rows by always returning <code>FALSE</code>.</li>
</ul>
<div id="challenge5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4-using-case_when-with-mutate" class="callout-inner">
<h3 class="callout-title">Challenge 4: Using <code>case_when()</code> with <code>mutate()</code><a class="anchor" aria-label="anchor" href="#challenge5"></a>
</h3>
<div class="callout-content">
<p><code>case_when()</code> is also quite useful in combination with <code>mutate()</code>.</p>
<p>For example, let’s suppose you want to compare the mean relative humidity on about cloudy cold days and sunny hot days.</p>
<p>You can first use <code>mutate()</code> and <code>case_when()</code> to create a column that tells which of these categories the day belongs to (<code>hot_sunny</code>, <code>cold_cloudy</code>, or <code>neither</code>), and then use <code>group_by()</code> and <code>summarise()</code> to get the mean relative humidity at 9am and 3pm.</p>
<p>Write the code to compute this.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>day_type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&gt;</span> <span class="fl">25</span> <span class="op">~</span> <span class="st">"hot_sunny"</span>,</span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&lt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">max_temp_c</span> <span class="op">&lt;</span> <span class="fl">15</span> <span class="op">~</span> <span class="st">"cold_cloudy"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"neither"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">day_type</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_rel_humid_9am <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">rel_humid_9am_pc</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            mean_rel_humid_3pm <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">rel_humid_3pm_pc</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in mutate(., day_type = case_when(sunshine_hours &gt; 10 &amp; max_temp_c &gt; : object 'weather' not found</code></pre>
</div>
<p>Notice that we didn’t actually have any cold cloudy days, but hot sunny days seem to be less humid.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="filter-within-groups-with-slice_xxx">Filter within groups with <code>slice_xxx()</code>
<a class="anchor" aria-label="anchor" href="#filter-within-groups-with-slice_xxx"></a>
</h4>
<p>If you want to filter within groups, you could use <code>filter()</code> and <code>group_by()</code> together - for example if we wanted to know what the hottest day in each city was, you might try this:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">max_temp_c</span> <span class="op">==</span> <span class="fu">max</span><span class="op">(</span><span class="va">max_temp_c</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in group_by(., city): object 'weather' not found</code></pre>
</div>
<p>But it doesn’t work! The reasons why are somewhat technical, so here I’ll sidestep them and just give you the solution instead: use <code>slice_max()</code></p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice_max</span><span class="op">(</span>order_by<span class="op">=</span><span class="va">max_temp_c</span>, n<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in group_by(., city): object 'weather' not found</code></pre>
</div>
<p>If you want the minimum values instead, use <code>slice_min()</code> and if you want a random sample, use <code>slice_sample()</code>.</p>
<div id="challenge6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5-hottest-days" class="callout-inner">
<h3 class="callout-title">Challenge 5: Hottest days<a class="anchor" aria-label="anchor" href="#challenge6"></a>
</h3>
<div class="callout-content">
<p>What is the mean maximum temperature on the 5 hottest days in each city?</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># use with_ties to ensure we only get five rows</span></span>
<span>  <span class="fu">slice_max</span><span class="op">(</span>order_by<span class="op">=</span><span class="va">max_temp_c</span>, n<span class="op">=</span><span class="fl">5</span>, with_ties <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_temp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">max_temp_c</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in group_by(., city): object 'weather' not found</code></pre>
</div>
<p>Ooof, Brisbane was hot! Maybe this changes your conclusion about which city is better.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="selecting-columns-with-select">Selecting columns with <code>select()</code>
<a class="anchor" aria-label="anchor" href="#selecting-columns-with-select"></a>
</h3>
<p>If you want to drop or only retain columns from your table, use <code>select()</code>.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/dplyr_select.png" alt="" class="figure mx-auto d-block"><figcaption><code>dplyr::select()</code> <a href="https://ab604.github.io/docs/coding-together-2019" class="external-link">image credit</a></figcaption></figure><p>For example, we added a <code>city</code> column to our table, so we can drop the <code>file</code> column that also contains this information.</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">file</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in select(., -file): object 'weather' not found</code></pre>
</div>
<p>Alternatively, if we only wanted to keep the date, city and the 3pm observations, we can do this as well.</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">date</span>, <span class="va">city</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"3pm"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in select(., date, city, contains("3pm")): object 'weather' not found</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="sorting-rows-with-arrange">Sorting rows with <code>arrange()</code>
<a class="anchor" aria-label="anchor" href="#sorting-rows-with-arrange"></a>
</h3>
<p>You can re-order the rows in a table by the values in one or more columns using <code>arrange()</code>.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/dplyr_arrange.png" alt="dplyr::arrange() image credit" class="figure mx-auto d-block"> Here I sort for the hottest days, using <code>desc()</code> to get the maximum temperatures in descending order.</figure><div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">max_temp_c</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in arrange(., desc(max_temp_c)): object 'weather' not found</code></pre>
</div>
<div id="challenge7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6-using-arrange-with-mutate" class="callout-inner">
<h3 class="callout-title">Challenge 6: Using <code>arrange()</code> with <code>mutate()</code><a class="anchor" aria-label="anchor" href="#challenge7"></a>
</h3>
<div class="callout-content">
<p>Sometimes I use <code>arrange()</code> with <code>mutate()</code> and <code>row_number()</code> to add ranks to a table.</p>
<p>Add a column ranking the days by minimum temperature for each city, where the coldest day for each is rank 1, the next coldest is rank 2, etc.</p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">min_temp_c</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>rank <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># select only the relevant columns to verify that it worked</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">min_temp_c</span>, <span class="va">rank</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in group_by(., city): object 'weather' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="joining-data-frames">Joining data frames<a class="anchor" aria-label="anchor" href="#joining-data-frames"></a>
</h3>
<p>So far, we’ve only dealt with methods that work on one data frame. Sometimes it’s useful to combine information from two tables together to get a more complete picture of the data.</p>
<p>There are several joining functions, which fall into two categories:</p>
<ul>
<li>
<a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">mutating joins</a>, which add extra columns to tables based on matching values</li>
<li>
<a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">filtering joins</a>, which don’t add extra columns but change the number of rows</li>
</ul>
<p>Here, I’ll only cover the join I use the most, <code>left_join()</code>, but there are several joins of each type, which I will leave to you to explore more using the links above.</p>
<figure><img src="https://ab604.github.io/docs/coding-together-2019/img/left_join.png" alt="" class="figure mx-auto d-block"><figcaption>left join</figcaption></figure><p>Let’s say we have a second table which contains the forecast for each day. Here I generate this randomly, but you could equally use <code>readr</code> or <code>readxl</code> to load this data in if you have it in a file.</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecast</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">date</span>, <span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>forecast <span class="op">=</span> <span class="fu">sample</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"cloudy"</span>, <span class="st">"sunny"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in select(., date, city): object 'weather' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecast</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'forecast' not found</code></pre>
</div>
<p>Now we would like to join this to our data frame of observations, so we can compare the forecast to what actually happened.</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">forecast</span>, by<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"city"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">city</span>, <span class="va">date</span>, <span class="va">sunshine_hours</span>, <span class="va">forecast</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in left_join(., forecast, by = c("date", "city")): object 'weather' not found</code></pre>
</div>
<div id="challenge8" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-7-blame-it-on-the-weatherman" class="callout-inner">
<h3 class="callout-title">Challenge 7: <a href="https://www.youtube.com/watch?v=t2UFV2R3EZM" class="external-link">Blame it on the weatherman</a><a class="anchor" aria-label="anchor" href="#challenge8"></a>
</h3>
<div class="callout-content">
<p>If a cloudy day is one where there are 10 or fewer hours of sunshine, on how many days was the forecast accurate?</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" data-bs-parent="#accordionSolution8" aria-labelledby="headingSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># join forecast information</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">forecast</span>, by<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"city"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># was forecast accurate</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>forecast_accurate <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">forecast</span> <span class="op">==</span> <span class="st">"sunny"</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">sunshine_hours</span> <span class="op">&lt;=</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">forecast</span> <span class="op">==</span> <span class="st">"cloudy"</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># count accurate and inaccurate forecasts</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">forecast_accurate</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in left_join(., forecast, by = c("date", "city")): object 'weather' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="resources-and-acknowlegements"><h2 class="section-heading">Resources and acknowlegements<a class="anchor" aria-label="anchor" href="#resources-and-acknowlegements"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-transformation.pdf" class="external-link">dplyr cheatsheet</a></li>
<li><a href="https://dplyr.tidyverse.org/" class="external-link">dplyr documentation</a></li>
<li><a href="https://r4ds.had.co.nz/transform.html" class="external-link">Data transformation in R for data science</a></li>
<li>I’ve borrowed figures (and inspiration) from the excellent <a href="https://ab604.github.io/docs/coding-together-2019/data-wrangle-1.html" class="external-link">coding togetheR course material</a>
</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>summarise()</code> to summarise your data</li>
<li>Use <code>mutate()</code> to add new columns</li>
<li>Use <code>filter()</code> to filter rows by a condition</li>
<li>Use <code>select()</code> to remove or only retain certain rows</li>
<li>Use <code>arrange()</code> to re-order rows</li>
<li>Use <code>group_by()</code> to group data by the values in particular columns</li>
<li>Use joins to combine two data frames</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-visualizing-data"><p>Content from <a href="visualizing-data.html">Data visualization</a></p>
<hr>
<p> Last updated on 2022-11-23 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/visualizing-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you visualize data using <code>ggplot2</code>?</li>
<li>How can you combine individual plots?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to use aesthetics to create plots</li>
<li>Use geoms to create visualizations</li>
<li>Know how to facet to split by grouping variables</li>
<li>Modify visual elements using themes</li>
<li>Combine plots using <code>patchwork</code>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>After all of that data manipulation perhaps you, like me, are a bit sick of looking at tables. Using visualizations is essential for communicating your results, especially in large datasets.</p>
<p>There is lots of thinking about the best way to represent a given dataset, but one popular framework is the <a href="http://vita.had.co.nz/papers/layered-grammar.pdf" class="external-link">‘grammar of graphics’ approach</a>. The idea here is to build up a graphic from multiple layers of components, including:</p>
<ul>
<li>data and aesthetic mappings</li>
<li>geometric objects</li>
<li>scales</li>
<li>facets</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson locally</li>
</ul>
</div>
</div>
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
        
        
        | <a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/carpentries/workbench-template-rmd/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:sscott@cmri.org.au">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper" class="external-link">sandpaper (0.10.8)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/0.3.2" class="external-link">pegboard (0.3.2)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.2.9" class="external-link">varnish (0.2.9)</a>.</p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-rmd/aio.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-rmd/aio.html",
  "identifier": "https://carpentries.github.io/workbench-template-rmd/aio.html",
  "dateCreated": "2022-11-23",
  "dateModified": "2022-11-23",
  "datePublished": "2022-11-23"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

